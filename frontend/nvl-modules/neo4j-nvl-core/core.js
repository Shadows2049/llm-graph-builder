/*! For license information please see core.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@neo4j-nvl/layout-workers")):"function"==typeof define&&define.amd?define(["@neo4j-nvl/layout-workers"],e):"object"==typeof exports?exports.NVLCore=e(require("@neo4j-nvl/layout-workers")):t.NVLCore=e(t["@neo4j-nvl/layout-workers"])}(self,(t=>(()=>{var e={103:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},804:(t,e,n)=>{var r=n(103),i=n(47),o=Object.hasOwnProperty,a=Object.create(null);for(var s in r)o.call(r,s)&&(a[r[s]]=s);var u=t.exports={to:{},get:{}};function l(t,e,n){return Math.min(Math.max(e,t),n)}function c(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}u.get=function(t){var e,n;switch(t.substring(0,3).toLowerCase()){case"hsl":e=u.get.hsl(t),n="hsl";break;case"hwb":e=u.get.hwb(t),n="hwb";break;default:e=u.get.rgb(t),n="rgb"}return e?{model:n,value:e}:null},u.get.rgb=function(t){if(!t)return null;var e,n,i,a=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=e[2],e=e[1],n=0;n<3;n++){var s=2*n;a[n]=parseInt(e.slice(s,s+2),16)}i&&(a[3]=parseInt(i,16)/255)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(i=(e=e[1])[3],n=0;n<3;n++)a[n]=parseInt(e[n]+e[n],16);i&&(a[3]=parseInt(i+i,16)/255)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)a[n]=parseInt(e[n+1],0);e[4]&&(e[5]?a[3]=.01*parseFloat(e[4]):a[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(e=t.match(/^(\w+)$/))?"transparent"===e[1]?[0,0,0,0]:o.call(r,e[1])?((a=r[e[1]])[3]=1,a):null:null;for(n=0;n<3;n++)a[n]=Math.round(2.55*parseFloat(e[n+1]));e[4]&&(e[5]?a[3]=.01*parseFloat(e[4]):a[3]=parseFloat(e[4]))}for(n=0;n<3;n++)a[n]=l(a[n],0,255);return a[3]=l(a[3],0,1),a},u.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,l(parseFloat(e[2]),0,100),l(parseFloat(e[3]),0,100),l(isNaN(n)?1:n,0,1)]}return null},u.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,l(parseFloat(e[2]),0,100),l(parseFloat(e[3]),0,100),l(isNaN(n)?1:n,0,1)]}return null},u.to.hex=function(){var t=i(arguments);return"#"+c(t[0])+c(t[1])+c(t[2])+(t[3]<1?c(Math.round(255*t[3])):"")},u.to.rgb=function(){var t=i(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},u.to.rgb.percent=function(){var t=i(arguments),e=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),r=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+n+"%, "+r+"%)":"rgba("+e+"%, "+n+"%, "+r+"%, "+t[3]+")"},u.to.hsl=function(){var t=i(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},u.to.hwb=function(){var t=i(arguments),e="";return t.length>=4&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},u.to.keyword=function(t){return a[t.slice(0,3)]}},346:(t,e,n)=>{var r=n(663);t.exports=function(t){var e=r(t);return Math.round((299*parseInt(e[0])+587*parseInt(e[1])+114*parseInt(e[2]))/1e3)<=180?"dark":"light"}},637:(t,e,n)=>{var r=n(261),i=n(405),o=n(530);t.exports=function(t,e){if(!e)return t;var n=Object.keys(e);if(0===n.length)return t;for(var a=r(t),s=n.length-1;s>=0;s--){var u=n[s],l=String(e[u]);l&&(l=" "+l),o(a,{type:"preprocessor",data:"#define "+u+l})}return i(a)}},530:t=>{t.exports=function(t,i){Array.isArray(i)||(i=[i]);var o=function(t){for(var e=-1,n=0;n<t.length;n++){var i=t[n];if("preprocessor"===i.type)/^#(extension|version)/.test(i.data)&&(e=Math.max(e,n));else if("keyword"===i.type&&"precision"===i.data){var o=r(t,n);if(-1===o)throw new Error("precision statement not followed by any semicolons!");e=Math.max(e,o)}}return e+1}(t),a=o>0?t[o-1]:null;a&&n.test(a.data)&&t.splice(o++,0,e),t.splice.apply(t,[o,0].concat(i));var s=o+i.length;return t[s]&&/[^\r\n]$/.test(t[s].data)&&t.splice(s,0,e),t};var e={data:"\n",type:"whitespace"},n=/[^\r\n]$/;function r(t,e){for(var n=e;n<t.length;n++)if("operator"===t[n].type&&";"===t[n].data)return n;return-1}},405:t=>{t.exports=function(t){for(var e=[],n=0;n<t.length;n++)"eof"!==t[n].type&&e.push(t[n].data);return e.join("")}},569:(t,e,n)=>{t.exports=function(t){var e,n,h,f=0,d=0,p=u,v=[],g=[],y=1,m=0,_=0,b=!1,x=!1,w="",T=o,S=r;"300 es"===(t=t||{}).version&&(T=s,S=a);var A={},E={};for(f=0;f<T.length;f++)A[T[f]]=!0;for(f=0;f<S.length;f++)E[S[f]]=!0;return function(t){return g=[],null!==t?function(t){var n;for(f=0,t.toString&&(t=t.toString()),w+=t.replace(/\r\n/g,"\n"),h=w.length;e=w[f],f<h;){switch(n=f,p){case 0:f=O();break;case 1:case 2:f=D();break;case 3:f=k();break;case 4:f=M();break;case 11:f=L();break;case 5:f=N();break;case l:f=j();break;case 9:f=P();break;case u:f=R()}n!==f&&("\n"===w[n]?(m=0,++y):++m)}return d+=f,w=w.slice(f),g}(t):(v.length&&C(v.join("")),p=10,C("(eof)"),g)};function C(t){t.length&&g.push({type:c[p],data:t,position:_,line:y,column:m})}function R(){return v=v.length?[]:v,"/"===n&&"*"===e?(_=d+f-1,p=0,n=e,f+1):"/"===n&&"/"===e?(_=d+f-1,p=1,n=e,f+1):"#"===e?(p=2,_=d+f,f):/\s/.test(e)?(p=9,_=d+f,f):(b=/\d/.test(e),x=/[^\w_]/.test(e),_=d+f,p=b?4:x?3:l,f)}function P(){return/[^\s]/g.test(e)?(C(v.join("")),p=u,f):(v.push(e),n=e,f+1)}function D(){return"\r"!==e&&"\n"!==e||"\\"===n?(v.push(e),n=e,f+1):(C(v.join("")),p=u,f)}function O(){return"/"===e&&"*"===n?(v.push(e),C(v.join("")),p=u,f+1):(v.push(e),n=e,f+1)}function k(){if("."===n&&/\d/.test(e))return p=5,f;if("/"===n&&"*"===e)return p=0,f;if("/"===n&&"/"===e)return p=1,f;if("."===e&&v.length){for(;I(v););return p=5,f}if(";"===e||")"===e||"("===e){if(v.length)for(;I(v););return C(e),p=u,f+1}var t=2===v.length&&"="!==e;if(/[\w_\d\s]/.test(e)||t){for(;I(v););return p=u,f}return v.push(e),n=e,f+1}function I(t){for(var e,n,r=0;;){if(e=i.indexOf(t.slice(0,t.length+r).join("")),n=i[e],-1===e){if(r--+t.length>0)continue;n=t.slice(0,1).join("")}return C(n),_+=n.length,(v=v.slice(n.length)).length}}function L(){return/[^a-fA-F0-9]/.test(e)?(C(v.join("")),p=u,f):(v.push(e),n=e,f+1)}function M(){return"."===e||/[eE]/.test(e)?(v.push(e),p=5,n=e,f+1):"x"===e&&1===v.length&&"0"===v[0]?(p=11,v.push(e),n=e,f+1):/[^\d]/.test(e)?(C(v.join("")),p=u,f):(v.push(e),n=e,f+1)}function N(){return"f"===e&&(v.push(e),n=e,f+=1),/[eE]/.test(e)?(v.push(e),n=e,f+1):("-"!==e&&"+"!==e||!/[eE]/.test(n))&&/[^\d]/.test(e)?(C(v.join("")),p=u,f):(v.push(e),n=e,f+1)}function j(){if(/[^\d\w_]/.test(e)){var t=v.join("");return p=E[t]?8:A[t]?7:6,C(v.join("")),p=u,f}return v.push(e),n=e,f+1}};var r=n(360),i=n(859),o=n(807),a=n(613),s=n(936),u=999,l=9999,c=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},936:(t,e,n)=>{var r=n(807);r=r.slice().filter((function(t){return!/^(gl\_|texture)/.test(t)})),t.exports=r.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},807:t=>{t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},613:(t,e,n)=>{var r=n(360);t.exports=r.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},360:t=>{t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},859:t=>{t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},261:(t,e,n)=>{var r=n(569);t.exports=function(t,e){var n=r(e),i=[];return(i=i.concat(n(t))).concat(n(null))}},663:t=>{t.exports=function(t){t.charAt&&"#"===t.charAt(0)&&(t=function(t){var e=t.split("");return e.shift(),e.join("")}(t)),3===t.length&&(t=function(t){return t.split("").reduce((function(t,e){return t.concat([e,e])}),[]).join("")}(t));var e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e]}},429:t=>{t.exports=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))}},635:function(t,e,n){var r;t=n.nmd(t),function(){var i,o="Expected a function",a="__lodash_hash_undefined__",s="__lodash_placeholder__",u=32,l=128,c=1/0,h=9007199254740991,f=NaN,d=4294967295,p=[["ary",l],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",u],["partialRight",64],["rearg",256]],v="[object Arguments]",g="[object Array]",y="[object Boolean]",m="[object Date]",_="[object Error]",b="[object Function]",x="[object GeneratorFunction]",w="[object Map]",T="[object Number]",S="[object Object]",A="[object Promise]",E="[object RegExp]",C="[object Set]",R="[object String]",P="[object Symbol]",D="[object WeakMap]",O="[object ArrayBuffer]",k="[object DataView]",I="[object Float32Array]",L="[object Float64Array]",M="[object Int8Array]",N="[object Int16Array]",j="[object Int32Array]",U="[object Uint8Array]",F="[object Uint8ClampedArray]",z="[object Uint16Array]",B="[object Uint32Array]",V=/\b__p \+= '';/g,G=/\b(__p \+=) '' \+/g,W=/(__e\(.*?\)|\b__t\)) \+\n'';/g,X=/&(?:amp|lt|gt|quot|#39);/g,$=/[&<>"']/g,H=RegExp(X.source),Y=RegExp($.source),q=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,K=/<%=([\s\S]+?)%>/g,J=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(et.source),rt=/^\s+/,it=/\s/,ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,at=/\{\n\/\* \[wrapped with (.+)\] \*/,st=/,? & /,ut=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,lt=/[()=,{}\[\]\/\s]/,ct=/\\(\\)?/g,ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ft=/\w*$/,dt=/^[-+]0x[0-9a-f]+$/i,pt=/^0b[01]+$/i,vt=/^\[object .+?Constructor\]$/,gt=/^0o[0-7]+$/i,yt=/^(?:0|[1-9]\d*)$/,mt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,bt=/['\n\r\u2028\u2029\\]/g,xt="\\ud800-\\udfff",wt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Tt="\\u2700-\\u27bf",St="a-z\\xdf-\\xf6\\xf8-\\xff",At="A-Z\\xc0-\\xd6\\xd8-\\xde",Et="\\ufe0e\\ufe0f",Ct="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Rt="["+xt+"]",Pt="["+Ct+"]",Dt="["+wt+"]",Ot="\\d+",kt="["+Tt+"]",It="["+St+"]",Lt="[^"+xt+Ct+Ot+Tt+St+At+"]",Mt="\\ud83c[\\udffb-\\udfff]",Nt="[^"+xt+"]",jt="(?:\\ud83c[\\udde6-\\uddff]){2}",Ut="[\\ud800-\\udbff][\\udc00-\\udfff]",Ft="["+At+"]",zt="\\u200d",Bt="(?:"+It+"|"+Lt+")",Vt="(?:"+Ft+"|"+Lt+")",Gt="(?:['’](?:d|ll|m|re|s|t|ve))?",Wt="(?:['’](?:D|LL|M|RE|S|T|VE))?",Xt="(?:"+Dt+"|"+Mt+")?",$t="["+Et+"]?",Ht=$t+Xt+"(?:"+zt+"(?:"+[Nt,jt,Ut].join("|")+")"+$t+Xt+")*",Yt="(?:"+[kt,jt,Ut].join("|")+")"+Ht,qt="(?:"+[Nt+Dt+"?",Dt,jt,Ut,Rt].join("|")+")",Zt=RegExp("['’]","g"),Kt=RegExp(Dt,"g"),Jt=RegExp(Mt+"(?="+Mt+")|"+qt+Ht,"g"),Qt=RegExp([Ft+"?"+It+"+"+Gt+"(?="+[Pt,Ft,"$"].join("|")+")",Vt+"+"+Wt+"(?="+[Pt,Ft+Bt,"$"].join("|")+")",Ft+"?"+Bt+"+"+Gt,Ft+"+"+Wt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ot,Yt].join("|"),"g"),te=RegExp("["+zt+xt+wt+Et+"]"),ee=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ne=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],re=-1,ie={};ie[I]=ie[L]=ie[M]=ie[N]=ie[j]=ie[U]=ie[F]=ie[z]=ie[B]=!0,ie[v]=ie[g]=ie[O]=ie[y]=ie[k]=ie[m]=ie[_]=ie[b]=ie[w]=ie[T]=ie[S]=ie[E]=ie[C]=ie[R]=ie[D]=!1;var oe={};oe[v]=oe[g]=oe[O]=oe[k]=oe[y]=oe[m]=oe[I]=oe[L]=oe[M]=oe[N]=oe[j]=oe[w]=oe[T]=oe[S]=oe[E]=oe[C]=oe[R]=oe[P]=oe[U]=oe[F]=oe[z]=oe[B]=!0,oe[_]=oe[b]=oe[D]=!1;var ae={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},se=parseFloat,ue=parseInt,le="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,ce="object"==typeof self&&self&&self.Object===Object&&self,he=le||ce||Function("return this")(),fe=e&&!e.nodeType&&e,de=fe&&t&&!t.nodeType&&t,pe=de&&de.exports===fe,ve=pe&&le.process,ge=function(){try{return de&&de.require&&de.require("util").types||ve&&ve.binding&&ve.binding("util")}catch(t){}}(),ye=ge&&ge.isArrayBuffer,me=ge&&ge.isDate,_e=ge&&ge.isMap,be=ge&&ge.isRegExp,xe=ge&&ge.isSet,we=ge&&ge.isTypedArray;function Te(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Se(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function Ae(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Ee(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Ce(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Re(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function Pe(t,e){return!(null==t||!t.length)&&Fe(t,e,0)>-1}function De(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Oe(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function ke(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Ie(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function Le(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function Me(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Ne=Ge("length");function je(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function Ue(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function Fe(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):Ue(t,Be,n)}function ze(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function Be(t){return t!=t}function Ve(t,e){var n=null==t?0:t.length;return n?$e(t,e)/n:f}function Ge(t){return function(e){return null==e?i:e[t]}}function We(t){return function(e){return null==t?i:t[e]}}function Xe(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}function $e(t,e){for(var n,r=-1,o=t.length;++r<o;){var a=e(t[r]);a!==i&&(n=n===i?a:n+a)}return n}function He(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ye(t){return t?t.slice(0,dn(t)+1).replace(rt,""):t}function qe(t){return function(e){return t(e)}}function Ze(t,e){return Oe(e,(function(e){return t[e]}))}function Ke(t,e){return t.has(e)}function Je(t,e){for(var n=-1,r=t.length;++n<r&&Fe(e,t[n],0)>-1;);return n}function Qe(t,e){for(var n=t.length;n--&&Fe(e,t[n],0)>-1;);return n}function tn(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var en=We({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),nn=We({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function rn(t){return"\\"+ae[t]}function on(t){return te.test(t)}function an(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function sn(t,e){return function(n){return t(e(n))}}function un(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n];a!==e&&a!==s||(t[n]=s,o[i++]=n)}return o}function ln(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function cn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function hn(t){return on(t)?function(t){for(var e=Jt.lastIndex=0;Jt.test(t);)++e;return e}(t):Ne(t)}function fn(t){return on(t)?function(t){return t.match(Jt)||[]}(t):function(t){return t.split("")}(t)}function dn(t){for(var e=t.length;e--&&it.test(t.charAt(e)););return e}var pn=We({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),vn=function t(e){var n,r=(e=null==e?he:vn.defaults(he.Object(),e,vn.pick(he,ne))).Array,it=e.Date,xt=e.Error,wt=e.Function,Tt=e.Math,St=e.Object,At=e.RegExp,Et=e.String,Ct=e.TypeError,Rt=r.prototype,Pt=wt.prototype,Dt=St.prototype,Ot=e["__core-js_shared__"],kt=Pt.toString,It=Dt.hasOwnProperty,Lt=0,Mt=(n=/[^.]+$/.exec(Ot&&Ot.keys&&Ot.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Nt=Dt.toString,jt=kt.call(St),Ut=he._,Ft=At("^"+kt.call(It).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zt=pe?e.Buffer:i,Bt=e.Symbol,Vt=e.Uint8Array,Gt=zt?zt.allocUnsafe:i,Wt=sn(St.getPrototypeOf,St),Xt=St.create,$t=Dt.propertyIsEnumerable,Ht=Rt.splice,Yt=Bt?Bt.isConcatSpreadable:i,qt=Bt?Bt.iterator:i,Jt=Bt?Bt.toStringTag:i,te=function(){try{var t=lo(St,"defineProperty");return t({},"",{}),t}catch(t){}}(),ae=e.clearTimeout!==he.clearTimeout&&e.clearTimeout,le=it&&it.now!==he.Date.now&&it.now,ce=e.setTimeout!==he.setTimeout&&e.setTimeout,fe=Tt.ceil,de=Tt.floor,ve=St.getOwnPropertySymbols,ge=zt?zt.isBuffer:i,Ne=e.isFinite,We=Rt.join,gn=sn(St.keys,St),yn=Tt.max,mn=Tt.min,_n=it.now,bn=e.parseInt,xn=Tt.random,wn=Rt.reverse,Tn=lo(e,"DataView"),Sn=lo(e,"Map"),An=lo(e,"Promise"),En=lo(e,"Set"),Cn=lo(e,"WeakMap"),Rn=lo(St,"create"),Pn=Cn&&new Cn,Dn={},On=Fo(Tn),kn=Fo(Sn),In=Fo(An),Ln=Fo(En),Mn=Fo(Cn),Nn=Bt?Bt.prototype:i,jn=Nn?Nn.valueOf:i,Un=Nn?Nn.toString:i;function Fn(t){if(ns(t)&&!Xa(t)&&!(t instanceof Gn)){if(t instanceof Vn)return t;if(It.call(t,"__wrapped__"))return zo(t)}return new Vn(t)}var zn=function(){function t(){}return function(e){if(!es(e))return{};if(Xt)return Xt(e);t.prototype=e;var n=new t;return t.prototype=i,n}}();function Bn(){}function Vn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}function Gn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=d,this.__views__=[]}function Wn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Xn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function $n(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Hn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new $n;++e<n;)this.add(t[e])}function Yn(t){var e=this.__data__=new Xn(t);this.size=e.size}function qn(t,e){var n=Xa(t),r=!n&&Wa(t),i=!n&&!r&&qa(t),o=!n&&!r&&!i&&cs(t),a=n||r||i||o,s=a?He(t.length,Et):[],u=s.length;for(var l in t)!e&&!It.call(t,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||yo(l,u))||s.push(l);return s}function Zn(t){var e=t.length;return e?t[$r(0,e-1)]:i}function Kn(t,e){return Lo(Ci(t),ar(e,0,t.length))}function Jn(t){return Lo(Ci(t))}function Qn(t,e,n){(n!==i&&!Ba(t[e],n)||n===i&&!(e in t))&&ir(t,e,n)}function tr(t,e,n){var r=t[e];It.call(t,e)&&Ba(r,n)&&(n!==i||e in t)||ir(t,e,n)}function er(t,e){for(var n=t.length;n--;)if(Ba(t[n][0],e))return n;return-1}function nr(t,e,n,r){return hr(t,(function(t,i,o){e(r,t,n(t),o)})),r}function rr(t,e){return t&&Ri(e,ks(e),t)}function ir(t,e,n){"__proto__"==e&&te?te(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function or(t,e){for(var n=-1,o=e.length,a=r(o),s=null==t;++n<o;)a[n]=s?i:Cs(t,e[n]);return a}function ar(t,e,n){return t==t&&(n!==i&&(t=t<=n?t:n),e!==i&&(t=t>=e?t:e)),t}function sr(t,e,n,r,o,a){var s,u=1&e,l=2&e,c=4&e;if(n&&(s=o?n(t,r,o,a):n(t)),s!==i)return s;if(!es(t))return t;var h=Xa(t);if(h){if(s=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&It.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!u)return Ci(t,s)}else{var f=fo(t),d=f==b||f==x;if(qa(t))return xi(t,u);if(f==S||f==v||d&&!o){if(s=l||d?{}:vo(t),!u)return l?function(t,e){return Ri(t,ho(t),e)}(t,function(t,e){return t&&Ri(e,Is(e),t)}(s,t)):function(t,e){return Ri(t,co(t),e)}(t,rr(s,t))}else{if(!oe[f])return o?t:{};s=function(t,e,n){var r,i=t.constructor;switch(e){case O:return wi(t);case y:case m:return new i(+t);case k:return function(t,e){var n=e?wi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case I:case L:case M:case N:case j:case U:case F:case z:case B:return Ti(t,n);case w:return new i;case T:case R:return new i(t);case E:return function(t){var e=new t.constructor(t.source,ft.exec(t));return e.lastIndex=t.lastIndex,e}(t);case C:return new i;case P:return r=t,jn?St(jn.call(r)):{}}}(t,f,u)}}a||(a=new Yn);var p=a.get(t);if(p)return p;a.set(t,s),ss(t)?t.forEach((function(r){s.add(sr(r,e,n,r,t,a))})):rs(t)&&t.forEach((function(r,i){s.set(i,sr(r,e,n,i,t,a))}));var g=h?i:(c?l?no:eo:l?Is:ks)(t);return Ae(g||t,(function(r,i){g&&(r=t[i=r]),tr(s,i,sr(r,e,n,i,t,a))})),s}function ur(t,e,n){var r=n.length;if(null==t)return!r;for(t=St(t);r--;){var o=n[r],a=e[o],s=t[o];if(s===i&&!(o in t)||!a(s))return!1}return!0}function lr(t,e,n){if("function"!=typeof t)throw new Ct(o);return Do((function(){t.apply(i,n)}),e)}function cr(t,e,n,r){var i=-1,o=Pe,a=!0,s=t.length,u=[],l=e.length;if(!s)return u;n&&(e=Oe(e,qe(n))),r?(o=De,a=!1):e.length>=200&&(o=Ke,a=!1,e=new Hn(e));t:for(;++i<s;){var c=t[i],h=null==n?c:n(c);if(c=r||0!==c?c:0,a&&h==h){for(var f=l;f--;)if(e[f]===h)continue t;u.push(c)}else o(e,h,r)||u.push(c)}return u}Fn.templateSettings={escape:q,evaluate:Z,interpolate:K,variable:"",imports:{_:Fn}},Fn.prototype=Bn.prototype,Fn.prototype.constructor=Fn,Vn.prototype=zn(Bn.prototype),Vn.prototype.constructor=Vn,Gn.prototype=zn(Bn.prototype),Gn.prototype.constructor=Gn,Wn.prototype.clear=function(){this.__data__=Rn?Rn(null):{},this.size=0},Wn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Wn.prototype.get=function(t){var e=this.__data__;if(Rn){var n=e[t];return n===a?i:n}return It.call(e,t)?e[t]:i},Wn.prototype.has=function(t){var e=this.__data__;return Rn?e[t]!==i:It.call(e,t)},Wn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Rn&&e===i?a:e,this},Xn.prototype.clear=function(){this.__data__=[],this.size=0},Xn.prototype.delete=function(t){var e=this.__data__,n=er(e,t);return!(n<0||(n==e.length-1?e.pop():Ht.call(e,n,1),--this.size,0))},Xn.prototype.get=function(t){var e=this.__data__,n=er(e,t);return n<0?i:e[n][1]},Xn.prototype.has=function(t){return er(this.__data__,t)>-1},Xn.prototype.set=function(t,e){var n=this.__data__,r=er(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},$n.prototype.clear=function(){this.size=0,this.__data__={hash:new Wn,map:new(Sn||Xn),string:new Wn}},$n.prototype.delete=function(t){var e=so(this,t).delete(t);return this.size-=e?1:0,e},$n.prototype.get=function(t){return so(this,t).get(t)},$n.prototype.has=function(t){return so(this,t).has(t)},$n.prototype.set=function(t,e){var n=so(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Hn.prototype.add=Hn.prototype.push=function(t){return this.__data__.set(t,a),this},Hn.prototype.has=function(t){return this.__data__.has(t)},Yn.prototype.clear=function(){this.__data__=new Xn,this.size=0},Yn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Yn.prototype.get=function(t){return this.__data__.get(t)},Yn.prototype.has=function(t){return this.__data__.has(t)},Yn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Xn){var r=n.__data__;if(!Sn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new $n(r)}return n.set(t,e),this.size=n.size,this};var hr=Oi(_r),fr=Oi(br,!0);function dr(t,e){var n=!0;return hr(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function pr(t,e,n){for(var r=-1,o=t.length;++r<o;){var a=t[r],s=e(a);if(null!=s&&(u===i?s==s&&!ls(s):n(s,u)))var u=s,l=a}return l}function vr(t,e){var n=[];return hr(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function gr(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=go),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?gr(s,e-1,n,r,i):ke(i,s):r||(i[i.length]=s)}return i}var yr=ki(),mr=ki(!0);function _r(t,e){return t&&yr(t,e,ks)}function br(t,e){return t&&mr(t,e,ks)}function xr(t,e){return Re(e,(function(e){return Ja(t[e])}))}function wr(t,e){for(var n=0,r=(e=yi(e,t)).length;null!=t&&n<r;)t=t[Uo(e[n++])];return n&&n==r?t:i}function Tr(t,e,n){var r=e(t);return Xa(t)?r:ke(r,n(t))}function Sr(t){return null==t?t===i?"[object Undefined]":"[object Null]":Jt&&Jt in St(t)?function(t){var e=It.call(t,Jt),n=t[Jt];try{t[Jt]=i;var r=!0}catch(t){}var o=Nt.call(t);return r&&(e?t[Jt]=n:delete t[Jt]),o}(t):function(t){return Nt.call(t)}(t)}function Ar(t,e){return t>e}function Er(t,e){return null!=t&&It.call(t,e)}function Cr(t,e){return null!=t&&e in St(t)}function Rr(t,e,n){for(var o=n?De:Pe,a=t[0].length,s=t.length,u=s,l=r(s),c=1/0,h=[];u--;){var f=t[u];u&&e&&(f=Oe(f,qe(e))),c=mn(f.length,c),l[u]=!n&&(e||a>=120&&f.length>=120)?new Hn(u&&f):i}f=t[0];var d=-1,p=l[0];t:for(;++d<a&&h.length<c;){var v=f[d],g=e?e(v):v;if(v=n||0!==v?v:0,!(p?Ke(p,g):o(h,g,n))){for(u=s;--u;){var y=l[u];if(!(y?Ke(y,g):o(t[u],g,n)))continue t}p&&p.push(g),h.push(v)}}return h}function Pr(t,e,n){var r=null==(t=Eo(t,e=yi(e,t)))?t:t[Uo(Ko(e))];return null==r?i:Te(r,t,n)}function Dr(t){return ns(t)&&Sr(t)==v}function Or(t,e,n,r,o){return t===e||(null==t||null==e||!ns(t)&&!ns(e)?t!=t&&e!=e:function(t,e,n,r,o,a){var s=Xa(t),u=Xa(e),l=s?g:fo(t),c=u?g:fo(e),h=(l=l==v?S:l)==S,f=(c=c==v?S:c)==S,d=l==c;if(d&&qa(t)){if(!qa(e))return!1;s=!0,h=!1}if(d&&!h)return a||(a=new Yn),s||cs(t)?Qi(t,e,n,r,o,a):function(t,e,n,r,i,o,a){switch(n){case k:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!o(new Vt(t),new Vt(e)));case y:case m:case T:return Ba(+t,+e);case _:return t.name==e.name&&t.message==e.message;case E:case R:return t==e+"";case w:var s=an;case C:var u=1&r;if(s||(s=ln),t.size!=e.size&&!u)return!1;var l=a.get(t);if(l)return l==e;r|=2,a.set(t,e);var c=Qi(s(t),s(e),r,i,o,a);return a.delete(t),c;case P:if(jn)return jn.call(t)==jn.call(e)}return!1}(t,e,l,n,r,o,a);if(!(1&n)){var p=h&&It.call(t,"__wrapped__"),b=f&&It.call(e,"__wrapped__");if(p||b){var x=p?t.value():t,A=b?e.value():e;return a||(a=new Yn),o(x,A,n,r,a)}}return!!d&&(a||(a=new Yn),function(t,e,n,r,o,a){var s=1&n,u=eo(t),l=u.length;if(l!=eo(e).length&&!s)return!1;for(var c=l;c--;){var h=u[c];if(!(s?h in e:It.call(e,h)))return!1}var f=a.get(t),d=a.get(e);if(f&&d)return f==e&&d==t;var p=!0;a.set(t,e),a.set(e,t);for(var v=s;++c<l;){var g=t[h=u[c]],y=e[h];if(r)var m=s?r(y,g,h,e,t,a):r(g,y,h,t,e,a);if(!(m===i?g===y||o(g,y,n,r,a):m)){p=!1;break}v||(v="constructor"==h)}if(p&&!v){var _=t.constructor,b=e.constructor;_==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b||(p=!1)}return a.delete(t),a.delete(e),p}(t,e,n,r,o,a))}(t,e,n,r,Or,o))}function kr(t,e,n,r){var o=n.length,a=o,s=!r;if(null==t)return!a;for(t=St(t);o--;){var u=n[o];if(s&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<a;){var l=(u=n[o])[0],c=t[l],h=u[1];if(s&&u[2]){if(c===i&&!(l in t))return!1}else{var f=new Yn;if(r)var d=r(c,h,l,t,e,f);if(!(d===i?Or(h,c,3,r,f):d))return!1}}return!0}function Ir(t){return!(!es(t)||(e=t,Mt&&Mt in e))&&(Ja(t)?Ft:vt).test(Fo(t));var e}function Lr(t){return"function"==typeof t?t:null==t?iu:"object"==typeof t?Xa(t)?Fr(t[0],t[1]):Ur(t):du(t)}function Mr(t){if(!wo(t))return gn(t);var e=[];for(var n in St(t))It.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Nr(t,e){return t<e}function jr(t,e){var n=-1,i=Ha(t)?r(t.length):[];return hr(t,(function(t,r,o){i[++n]=e(t,r,o)})),i}function Ur(t){var e=uo(t);return 1==e.length&&e[0][2]?So(e[0][0],e[0][1]):function(n){return n===t||kr(n,t,e)}}function Fr(t,e){return _o(t)&&To(e)?So(Uo(t),e):function(n){var r=Cs(n,t);return r===i&&r===e?Rs(n,t):Or(e,r,3)}}function zr(t,e,n,r,o){t!==e&&yr(e,(function(a,s){if(o||(o=new Yn),es(a))!function(t,e,n,r,o,a,s){var u=Ro(t,n),l=Ro(e,n),c=s.get(l);if(c)Qn(t,n,c);else{var h=a?a(u,l,n+"",t,e,s):i,f=h===i;if(f){var d=Xa(l),p=!d&&qa(l),v=!d&&!p&&cs(l);h=l,d||p||v?Xa(u)?h=u:Ya(u)?h=Ci(u):p?(f=!1,h=xi(l,!0)):v?(f=!1,h=Ti(l,!0)):h=[]:os(l)||Wa(l)?(h=u,Wa(u)?h=ms(u):es(u)&&!Ja(u)||(h=vo(l))):f=!1}f&&(s.set(l,h),o(h,l,r,a,s),s.delete(l)),Qn(t,n,h)}}(t,e,s,n,zr,r,o);else{var u=r?r(Ro(t,s),a,s+"",t,e,o):i;u===i&&(u=a),Qn(t,s,u)}}),Is)}function Br(t,e){var n=t.length;if(n)return yo(e+=e<0?n:0,n)?t[e]:i}function Vr(t,e,n){e=e.length?Oe(e,(function(t){return Xa(t)?function(e){return wr(e,1===t.length?t[0]:t)}:t})):[iu];var r=-1;e=Oe(e,qe(ao()));var i=jr(t,(function(t,n,i){var o=Oe(e,(function(e){return e(t)}));return{criteria:o,index:++r,value:t}}));return function(t,e){var r=t.length;for(t.sort((function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,a=i.length,s=n.length;++r<a;){var u=Si(i[r],o[r]);if(u)return r>=s?u:u*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}));r--;)t[r]=t[r].value;return t}(i)}function Gr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],s=wr(t,a);n(s,a)&&Kr(o,yi(a,t),s)}return o}function Wr(t,e,n,r){var i=r?ze:Fe,o=-1,a=e.length,s=t;for(t===e&&(e=Ci(e)),n&&(s=Oe(t,qe(n)));++o<a;)for(var u=0,l=e[o],c=n?n(l):l;(u=i(s,c,u,r))>-1;)s!==t&&Ht.call(s,u,1),Ht.call(t,u,1);return t}function Xr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;yo(i)?Ht.call(t,i,1):li(t,i)}}return t}function $r(t,e){return t+de(xn()*(e-t+1))}function Hr(t,e){var n="";if(!t||e<1||e>h)return n;do{e%2&&(n+=t),(e=de(e/2))&&(t+=t)}while(e);return n}function Yr(t,e){return Oo(Ao(t,e,iu),t+"")}function qr(t){return Zn(Bs(t))}function Zr(t,e){var n=Bs(t);return Lo(n,ar(e,0,n.length))}function Kr(t,e,n,r){if(!es(t))return t;for(var o=-1,a=(e=yi(e,t)).length,s=a-1,u=t;null!=u&&++o<a;){var l=Uo(e[o]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(o!=s){var h=u[l];(c=r?r(h,l,u):i)===i&&(c=es(h)?h:yo(e[o+1])?[]:{})}tr(u,l,c),u=u[l]}return t}var Jr=Pn?function(t,e){return Pn.set(t,e),t}:iu,Qr=te?function(t,e){return te(t,"toString",{configurable:!0,enumerable:!1,value:eu(e),writable:!0})}:iu;function ti(t){return Lo(Bs(t))}function ei(t,e,n){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var a=r(o);++i<o;)a[i]=t[i+e];return a}function ni(t,e){var n;return hr(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function ri(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!ls(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return ii(t,e,iu,n)}function ii(t,e,n,r){var o=0,a=null==t?0:t.length;if(0===a)return 0;for(var s=(e=n(e))!=e,u=null===e,l=ls(e),c=e===i;o<a;){var h=de((o+a)/2),f=n(t[h]),d=f!==i,p=null===f,v=f==f,g=ls(f);if(s)var y=r||v;else y=c?v&&(r||d):u?v&&d&&(r||!p):l?v&&d&&!p&&(r||!g):!p&&!g&&(r?f<=e:f<e);y?o=h+1:a=h}return mn(a,4294967294)}function oi(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!Ba(s,u)){var u=s;o[i++]=0===a?0:a}}return o}function ai(t){return"number"==typeof t?t:ls(t)?f:+t}function si(t){if("string"==typeof t)return t;if(Xa(t))return Oe(t,si)+"";if(ls(t))return Un?Un.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function ui(t,e,n){var r=-1,i=Pe,o=t.length,a=!0,s=[],u=s;if(n)a=!1,i=De;else if(o>=200){var l=e?null:Hi(t);if(l)return ln(l);a=!1,i=Ke,u=new Hn}else u=e?[]:s;t:for(;++r<o;){var c=t[r],h=e?e(c):c;if(c=n||0!==c?c:0,a&&h==h){for(var f=u.length;f--;)if(u[f]===h)continue t;e&&u.push(h),s.push(c)}else i(u,h,n)||(u!==s&&u.push(h),s.push(c))}return s}function li(t,e){return null==(t=Eo(t,e=yi(e,t)))||delete t[Uo(Ko(e))]}function ci(t,e,n,r){return Kr(t,e,n(wr(t,e)),r)}function hi(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?ei(t,r?0:o,r?o+1:i):ei(t,r?o+1:0,r?i:o)}function fi(t,e){var n=t;return n instanceof Gn&&(n=n.value()),Ie(e,(function(t,e){return e.func.apply(e.thisArg,ke([t],e.args))}),n)}function di(t,e,n){var i=t.length;if(i<2)return i?ui(t[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=t[o],u=-1;++u<i;)u!=o&&(a[o]=cr(a[o]||s,t[u],e,n));return ui(gr(a,1),e,n)}function pi(t,e,n){for(var r=-1,o=t.length,a=e.length,s={};++r<o;){var u=r<a?e[r]:i;n(s,t[r],u)}return s}function vi(t){return Ya(t)?t:[]}function gi(t){return"function"==typeof t?t:iu}function yi(t,e){return Xa(t)?t:_o(t,e)?[t]:jo(_s(t))}var mi=Yr;function _i(t,e,n){var r=t.length;return n=n===i?r:n,!e&&n>=r?t:ei(t,e,n)}var bi=ae||function(t){return he.clearTimeout(t)};function xi(t,e){if(e)return t.slice();var n=t.length,r=Gt?Gt(n):new t.constructor(n);return t.copy(r),r}function wi(t){var e=new t.constructor(t.byteLength);return new Vt(e).set(new Vt(t)),e}function Ti(t,e){var n=e?wi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Si(t,e){if(t!==e){var n=t!==i,r=null===t,o=t==t,a=ls(t),s=e!==i,u=null===e,l=e==e,c=ls(e);if(!u&&!c&&!a&&t>e||a&&s&&l&&!u&&!c||r&&s&&l||!n&&l||!o)return 1;if(!r&&!a&&!c&&t<e||c&&n&&o&&!r&&!a||u&&n&&o||!s&&o||!l)return-1}return 0}function Ai(t,e,n,i){for(var o=-1,a=t.length,s=n.length,u=-1,l=e.length,c=yn(a-s,0),h=r(l+c),f=!i;++u<l;)h[u]=e[u];for(;++o<s;)(f||o<a)&&(h[n[o]]=t[o]);for(;c--;)h[u++]=t[o++];return h}function Ei(t,e,n,i){for(var o=-1,a=t.length,s=-1,u=n.length,l=-1,c=e.length,h=yn(a-u,0),f=r(h+c),d=!i;++o<h;)f[o]=t[o];for(var p=o;++l<c;)f[p+l]=e[l];for(;++s<u;)(d||o<a)&&(f[p+n[s]]=t[o++]);return f}function Ci(t,e){var n=-1,i=t.length;for(e||(e=r(i));++n<i;)e[n]=t[n];return e}function Ri(t,e,n,r){var o=!n;n||(n={});for(var a=-1,s=e.length;++a<s;){var u=e[a],l=r?r(n[u],t[u],u,n,t):i;l===i&&(l=t[u]),o?ir(n,u,l):tr(n,u,l)}return n}function Pi(t,e){return function(n,r){var i=Xa(n)?Se:nr,o=e?e():{};return i(n,t,ao(r,2),o)}}function Di(t){return Yr((function(e,n){var r=-1,o=n.length,a=o>1?n[o-1]:i,s=o>2?n[2]:i;for(a=t.length>3&&"function"==typeof a?(o--,a):i,s&&mo(n[0],n[1],s)&&(a=o<3?i:a,o=1),e=St(e);++r<o;){var u=n[r];u&&t(e,u,r,a)}return e}))}function Oi(t,e){return function(n,r){if(null==n)return n;if(!Ha(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=St(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function ki(t){return function(e,n,r){for(var i=-1,o=St(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}function Ii(t){return function(e){var n=on(e=_s(e))?fn(e):i,r=n?n[0]:e.charAt(0),o=n?_i(n,1).join(""):e.slice(1);return r[t]()+o}}function Li(t){return function(e){return Ie(Js(Ws(e).replace(Zt,"")),t,"")}}function Mi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=zn(t.prototype),r=t.apply(n,e);return es(r)?r:n}}function Ni(t){return function(e,n,r){var o=St(e);if(!Ha(e)){var a=ao(n,3);e=ks(e),n=function(t){return a(o[t],t,o)}}var s=t(e,n,r);return s>-1?o[a?e[s]:s]:i}}function ji(t){return to((function(e){var n=e.length,r=n,a=Vn.prototype.thru;for(t&&e.reverse();r--;){var s=e[r];if("function"!=typeof s)throw new Ct(o);if(a&&!u&&"wrapper"==io(s))var u=new Vn([],!0)}for(r=u?r:n;++r<n;){var l=io(s=e[r]),c="wrapper"==l?ro(s):i;u=c&&bo(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?u[io(c[0])].apply(u,c[3]):1==s.length&&bo(s)?u[l]():u.thru(s)}return function(){var t=arguments,r=t[0];if(u&&1==t.length&&Xa(r))return u.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}}))}function Ui(t,e,n,o,a,s,u,c,h,f){var d=e&l,p=1&e,v=2&e,g=24&e,y=512&e,m=v?i:Mi(t);return function i(){for(var l=arguments.length,_=r(l),b=l;b--;)_[b]=arguments[b];if(g)var x=oo(i),w=tn(_,x);if(o&&(_=Ai(_,o,a,g)),s&&(_=Ei(_,s,u,g)),l-=w,g&&l<f){var T=un(_,x);return Xi(t,e,Ui,i.placeholder,n,_,T,c,h,f-l)}var S=p?n:this,A=v?S[t]:t;return l=_.length,c?_=Co(_,c):y&&l>1&&_.reverse(),d&&h<l&&(_.length=h),this&&this!==he&&this instanceof i&&(A=m||Mi(A)),A.apply(S,_)}}function Fi(t,e){return function(n,r){return function(t,e,n,r){return _r(t,(function(t,i,o){e(r,n(t),i,o)})),r}(n,t,e(r),{})}}function zi(t,e){return function(n,r){var o;if(n===i&&r===i)return e;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=si(n),r=si(r)):(n=ai(n),r=ai(r)),o=t(n,r)}return o}}function Bi(t){return to((function(e){return e=Oe(e,qe(ao())),Yr((function(n){var r=this;return t(e,(function(t){return Te(t,r,n)}))}))}))}function Vi(t,e){var n=(e=e===i?" ":si(e)).length;if(n<2)return n?Hr(e,t):e;var r=Hr(e,fe(t/hn(e)));return on(e)?_i(fn(r),0,t).join(""):r.slice(0,t)}function Gi(t){return function(e,n,o){return o&&"number"!=typeof o&&mo(e,n,o)&&(n=o=i),e=ps(e),n===i?(n=e,e=0):n=ps(n),function(t,e,n,i){for(var o=-1,a=yn(fe((e-t)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=t,t+=n;return s}(e,n,o=o===i?e<n?1:-1:ps(o),t)}}function Wi(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ys(e),n=ys(n)),t(e,n)}}function Xi(t,e,n,r,o,a,s,l,c,h){var f=8&e;e|=f?u:64,4&(e&=~(f?64:u))||(e&=-4);var d=[t,e,o,f?a:i,f?s:i,f?i:a,f?i:s,l,c,h],p=n.apply(i,d);return bo(t)&&Po(p,d),p.placeholder=r,ko(p,t,e)}function $i(t){var e=Tt[t];return function(t,n){if(t=ys(t),(n=null==n?0:mn(vs(n),292))&&Ne(t)){var r=(_s(t)+"e").split("e");return+((r=(_s(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Hi=En&&1/ln(new En([,-0]))[1]==c?function(t){return new En(t)}:lu;function Yi(t){return function(e){var n=fo(e);return n==w?an(e):n==C?cn(e):function(t,e){return Oe(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function qi(t,e,n,a,c,h,f,d){var p=2&e;if(!p&&"function"!=typeof t)throw new Ct(o);var v=a?a.length:0;if(v||(e&=-97,a=c=i),f=f===i?f:yn(vs(f),0),d=d===i?d:vs(d),v-=c?c.length:0,64&e){var g=a,y=c;a=c=i}var m=p?i:ro(t),_=[t,e,n,a,c,g,y,h,f,d];if(m&&function(t,e){var n=t[1],r=e[1],i=n|r,o=i<131,a=r==l&&8==n||r==l&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!o&&!a)return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var u=e[3];if(u){var c=t[3];t[3]=c?Ai(c,u,e[4]):u,t[4]=c?un(t[3],s):e[4]}(u=e[5])&&(c=t[5],t[5]=c?Ei(c,u,e[6]):u,t[6]=c?un(t[5],s):e[6]),(u=e[7])&&(t[7]=u),r&l&&(t[8]=null==t[8]?e[8]:mn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(_,m),t=_[0],e=_[1],n=_[2],a=_[3],c=_[4],!(d=_[9]=_[9]===i?p?0:t.length:yn(_[9]-v,0))&&24&e&&(e&=-25),e&&1!=e)b=8==e||16==e?function(t,e,n){var o=Mi(t);return function a(){for(var s=arguments.length,u=r(s),l=s,c=oo(a);l--;)u[l]=arguments[l];var h=s<3&&u[0]!==c&&u[s-1]!==c?[]:un(u,c);return(s-=h.length)<n?Xi(t,e,Ui,a.placeholder,i,u,h,i,i,n-s):Te(this&&this!==he&&this instanceof a?o:t,this,u)}}(t,e,d):e!=u&&33!=e||c.length?Ui.apply(i,_):function(t,e,n,i){var o=1&e,a=Mi(t);return function e(){for(var s=-1,u=arguments.length,l=-1,c=i.length,h=r(c+u),f=this&&this!==he&&this instanceof e?a:t;++l<c;)h[l]=i[l];for(;u--;)h[l++]=arguments[++s];return Te(f,o?n:this,h)}}(t,e,n,a);else var b=function(t,e,n){var r=1&e,i=Mi(t);return function e(){return(this&&this!==he&&this instanceof e?i:t).apply(r?n:this,arguments)}}(t,e,n);return ko((m?Jr:Po)(b,_),t,e)}function Zi(t,e,n,r){return t===i||Ba(t,Dt[n])&&!It.call(r,n)?e:t}function Ki(t,e,n,r,o,a){return es(t)&&es(e)&&(a.set(e,t),zr(t,e,i,Ki,a),a.delete(e)),t}function Ji(t){return os(t)?i:t}function Qi(t,e,n,r,o,a){var s=1&n,u=t.length,l=e.length;if(u!=l&&!(s&&l>u))return!1;var c=a.get(t),h=a.get(e);if(c&&h)return c==e&&h==t;var f=-1,d=!0,p=2&n?new Hn:i;for(a.set(t,e),a.set(e,t);++f<u;){var v=t[f],g=e[f];if(r)var y=s?r(g,v,f,e,t,a):r(v,g,f,t,e,a);if(y!==i){if(y)continue;d=!1;break}if(p){if(!Me(e,(function(t,e){if(!Ke(p,e)&&(v===t||o(v,t,n,r,a)))return p.push(e)}))){d=!1;break}}else if(v!==g&&!o(v,g,n,r,a)){d=!1;break}}return a.delete(t),a.delete(e),d}function to(t){return Oo(Ao(t,i,$o),t+"")}function eo(t){return Tr(t,ks,co)}function no(t){return Tr(t,Is,ho)}var ro=Pn?function(t){return Pn.get(t)}:lu;function io(t){for(var e=t.name+"",n=Dn[e],r=It.call(Dn,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function oo(t){return(It.call(Fn,"placeholder")?Fn:t).placeholder}function ao(){var t=Fn.iteratee||ou;return t=t===ou?Lr:t,arguments.length?t(arguments[0],arguments[1]):t}function so(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function uo(t){for(var e=ks(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,To(i)]}return e}function lo(t,e){var n=function(t,e){return null==t?i:t[e]}(t,e);return Ir(n)?n:i}var co=ve?function(t){return null==t?[]:(t=St(t),Re(ve(t),(function(e){return $t.call(t,e)})))}:gu,ho=ve?function(t){for(var e=[];t;)ke(e,co(t)),t=Wt(t);return e}:gu,fo=Sr;function po(t,e,n){for(var r=-1,i=(e=yi(e,t)).length,o=!1;++r<i;){var a=Uo(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&ts(i)&&yo(a,i)&&(Xa(t)||Wa(t))}function vo(t){return"function"!=typeof t.constructor||wo(t)?{}:zn(Wt(t))}function go(t){return Xa(t)||Wa(t)||!!(Yt&&t&&t[Yt])}function yo(t,e){var n=typeof t;return!!(e=null==e?h:e)&&("number"==n||"symbol"!=n&&yt.test(t))&&t>-1&&t%1==0&&t<e}function mo(t,e,n){if(!es(n))return!1;var r=typeof e;return!!("number"==r?Ha(n)&&yo(e,n.length):"string"==r&&e in n)&&Ba(n[e],t)}function _o(t,e){if(Xa(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ls(t))||Q.test(t)||!J.test(t)||null!=e&&t in St(e)}function bo(t){var e=io(t),n=Fn[e];if("function"!=typeof n||!(e in Gn.prototype))return!1;if(t===n)return!0;var r=ro(n);return!!r&&t===r[0]}(Tn&&fo(new Tn(new ArrayBuffer(1)))!=k||Sn&&fo(new Sn)!=w||An&&fo(An.resolve())!=A||En&&fo(new En)!=C||Cn&&fo(new Cn)!=D)&&(fo=function(t){var e=Sr(t),n=e==S?t.constructor:i,r=n?Fo(n):"";if(r)switch(r){case On:return k;case kn:return w;case In:return A;case Ln:return C;case Mn:return D}return e});var xo=Ot?Ja:yu;function wo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Dt)}function To(t){return t==t&&!es(t)}function So(t,e){return function(n){return null!=n&&n[t]===e&&(e!==i||t in St(n))}}function Ao(t,e,n){return e=yn(e===i?t.length-1:e,0),function(){for(var i=arguments,o=-1,a=yn(i.length-e,0),s=r(a);++o<a;)s[o]=i[e+o];o=-1;for(var u=r(e+1);++o<e;)u[o]=i[o];return u[e]=n(s),Te(t,this,u)}}function Eo(t,e){return e.length<2?t:wr(t,ei(e,0,-1))}function Co(t,e){for(var n=t.length,r=mn(e.length,n),o=Ci(t);r--;){var a=e[r];t[r]=yo(a,n)?o[a]:i}return t}function Ro(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Po=Io(Jr),Do=ce||function(t,e){return he.setTimeout(t,e)},Oo=Io(Qr);function ko(t,e,n){var r=e+"";return Oo(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(ot,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return Ae(p,(function(n){var r="_."+n[0];e&n[1]&&!Pe(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(at);return e?e[1].split(st):[]}(r),n)))}function Io(t){var e=0,n=0;return function(){var r=_n(),o=16-(r-n);if(n=r,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(i,arguments)}}function Lo(t,e){var n=-1,r=t.length,o=r-1;for(e=e===i?r:e;++n<e;){var a=$r(n,o),s=t[a];t[a]=t[n],t[n]=s}return t.length=e,t}var Mo,No,jo=(Mo=Ma((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,n,r,i){e.push(r?i.replace(ct,"$1"):n||t)})),e}),(function(t){return 500===No.size&&No.clear(),t})),No=Mo.cache,Mo);function Uo(t){if("string"==typeof t||ls(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Fo(t){if(null!=t){try{return kt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function zo(t){if(t instanceof Gn)return t.clone();var e=new Vn(t.__wrapped__,t.__chain__);return e.__actions__=Ci(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Bo=Yr((function(t,e){return Ya(t)?cr(t,gr(e,1,Ya,!0)):[]})),Vo=Yr((function(t,e){var n=Ko(e);return Ya(n)&&(n=i),Ya(t)?cr(t,gr(e,1,Ya,!0),ao(n,2)):[]})),Go=Yr((function(t,e){var n=Ko(e);return Ya(n)&&(n=i),Ya(t)?cr(t,gr(e,1,Ya,!0),i,n):[]}));function Wo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:vs(n);return i<0&&(i=yn(r+i,0)),Ue(t,ao(e,3),i)}function Xo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r-1;return n!==i&&(o=vs(n),o=n<0?yn(r+o,0):mn(o,r-1)),Ue(t,ao(e,3),o,!0)}function $o(t){return null!=t&&t.length?gr(t,1):[]}function Ho(t){return t&&t.length?t[0]:i}var Yo=Yr((function(t){var e=Oe(t,vi);return e.length&&e[0]===t[0]?Rr(e):[]})),qo=Yr((function(t){var e=Ko(t),n=Oe(t,vi);return e===Ko(n)?e=i:n.pop(),n.length&&n[0]===t[0]?Rr(n,ao(e,2)):[]})),Zo=Yr((function(t){var e=Ko(t),n=Oe(t,vi);return(e="function"==typeof e?e:i)&&n.pop(),n.length&&n[0]===t[0]?Rr(n,i,e):[]}));function Ko(t){var e=null==t?0:t.length;return e?t[e-1]:i}var Jo=Yr(Qo);function Qo(t,e){return t&&t.length&&e&&e.length?Wr(t,e):t}var ta=to((function(t,e){var n=null==t?0:t.length,r=or(t,e);return Xr(t,Oe(e,(function(t){return yo(t,n)?+t:t})).sort(Si)),r}));function ea(t){return null==t?t:wn.call(t)}var na=Yr((function(t){return ui(gr(t,1,Ya,!0))})),ra=Yr((function(t){var e=Ko(t);return Ya(e)&&(e=i),ui(gr(t,1,Ya,!0),ao(e,2))})),ia=Yr((function(t){var e=Ko(t);return e="function"==typeof e?e:i,ui(gr(t,1,Ya,!0),i,e)}));function oa(t){if(!t||!t.length)return[];var e=0;return t=Re(t,(function(t){if(Ya(t))return e=yn(t.length,e),!0})),He(e,(function(e){return Oe(t,Ge(e))}))}function aa(t,e){if(!t||!t.length)return[];var n=oa(t);return null==e?n:Oe(n,(function(t){return Te(e,i,t)}))}var sa=Yr((function(t,e){return Ya(t)?cr(t,e):[]})),ua=Yr((function(t){return di(Re(t,Ya))})),la=Yr((function(t){var e=Ko(t);return Ya(e)&&(e=i),di(Re(t,Ya),ao(e,2))})),ca=Yr((function(t){var e=Ko(t);return e="function"==typeof e?e:i,di(Re(t,Ya),i,e)})),ha=Yr(oa),fa=Yr((function(t){var e=t.length,n=e>1?t[e-1]:i;return n="function"==typeof n?(t.pop(),n):i,aa(t,n)}));function da(t){var e=Fn(t);return e.__chain__=!0,e}function pa(t,e){return e(t)}var va=to((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,o=function(e){return or(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Gn&&yo(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:pa,args:[o],thisArg:i}),new Vn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(i),t}))):this.thru(o)})),ga=Pi((function(t,e,n){It.call(t,n)?++t[n]:ir(t,n,1)})),ya=Ni(Wo),ma=Ni(Xo);function _a(t,e){return(Xa(t)?Ae:hr)(t,ao(e,3))}function ba(t,e){return(Xa(t)?Ee:fr)(t,ao(e,3))}var xa=Pi((function(t,e,n){It.call(t,n)?t[n].push(e):ir(t,n,[e])})),wa=Yr((function(t,e,n){var i=-1,o="function"==typeof e,a=Ha(t)?r(t.length):[];return hr(t,(function(t){a[++i]=o?Te(e,t,n):Pr(t,e,n)})),a})),Ta=Pi((function(t,e,n){ir(t,n,e)}));function Sa(t,e){return(Xa(t)?Oe:jr)(t,ao(e,3))}var Aa=Pi((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),Ea=Yr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&mo(t,e[0],e[1])?e=[]:n>2&&mo(e[0],e[1],e[2])&&(e=[e[0]]),Vr(t,gr(e,1),[])})),Ca=le||function(){return he.Date.now()};function Ra(t,e,n){return e=n?i:e,e=t&&null==e?t.length:e,qi(t,l,i,i,i,i,e)}function Pa(t,e){var n;if("function"!=typeof e)throw new Ct(o);return t=vs(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=i),n}}var Da=Yr((function(t,e,n){var r=1;if(n.length){var i=un(n,oo(Da));r|=u}return qi(t,r,e,n,i)})),Oa=Yr((function(t,e,n){var r=3;if(n.length){var i=un(n,oo(Oa));r|=u}return qi(e,r,t,n,i)}));function ka(t,e,n){var r,a,s,u,l,c,h=0,f=!1,d=!1,p=!0;if("function"!=typeof t)throw new Ct(o);function v(e){var n=r,o=a;return r=a=i,h=e,u=t.apply(o,n)}function g(t){return h=t,l=Do(m,e),f?v(t):u}function y(t){var n=t-c;return c===i||n>=e||n<0||d&&t-h>=s}function m(){var t=Ca();if(y(t))return _(t);l=Do(m,function(t){var n=e-(t-c);return d?mn(n,s-(t-h)):n}(t))}function _(t){return l=i,p&&r?v(t):(r=a=i,u)}function b(){var t=Ca(),n=y(t);if(r=arguments,a=this,c=t,n){if(l===i)return g(c);if(d)return bi(l),l=Do(m,e),v(c)}return l===i&&(l=Do(m,e)),u}return e=ys(e)||0,es(n)&&(f=!!n.leading,s=(d="maxWait"in n)?yn(ys(n.maxWait)||0,e):s,p="trailing"in n?!!n.trailing:p),b.cancel=function(){l!==i&&bi(l),h=0,r=c=a=l=i},b.flush=function(){return l===i?u:_(Ca())},b}var Ia=Yr((function(t,e){return lr(t,1,e)})),La=Yr((function(t,e,n){return lr(t,ys(e)||0,n)}));function Ma(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Ct(o);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Ma.Cache||$n),n}function Na(t){if("function"!=typeof t)throw new Ct(o);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Ma.Cache=$n;var ja=mi((function(t,e){var n=(e=1==e.length&&Xa(e[0])?Oe(e[0],qe(ao())):Oe(gr(e,1),qe(ao()))).length;return Yr((function(r){for(var i=-1,o=mn(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return Te(t,this,r)}))})),Ua=Yr((function(t,e){var n=un(e,oo(Ua));return qi(t,u,i,e,n)})),Fa=Yr((function(t,e){var n=un(e,oo(Fa));return qi(t,64,i,e,n)})),za=to((function(t,e){return qi(t,256,i,i,i,e)}));function Ba(t,e){return t===e||t!=t&&e!=e}var Va=Wi(Ar),Ga=Wi((function(t,e){return t>=e})),Wa=Dr(function(){return arguments}())?Dr:function(t){return ns(t)&&It.call(t,"callee")&&!$t.call(t,"callee")},Xa=r.isArray,$a=ye?qe(ye):function(t){return ns(t)&&Sr(t)==O};function Ha(t){return null!=t&&ts(t.length)&&!Ja(t)}function Ya(t){return ns(t)&&Ha(t)}var qa=ge||yu,Za=me?qe(me):function(t){return ns(t)&&Sr(t)==m};function Ka(t){if(!ns(t))return!1;var e=Sr(t);return e==_||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!os(t)}function Ja(t){if(!es(t))return!1;var e=Sr(t);return e==b||e==x||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Qa(t){return"number"==typeof t&&t==vs(t)}function ts(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=h}function es(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ns(t){return null!=t&&"object"==typeof t}var rs=_e?qe(_e):function(t){return ns(t)&&fo(t)==w};function is(t){return"number"==typeof t||ns(t)&&Sr(t)==T}function os(t){if(!ns(t)||Sr(t)!=S)return!1;var e=Wt(t);if(null===e)return!0;var n=It.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&kt.call(n)==jt}var as=be?qe(be):function(t){return ns(t)&&Sr(t)==E},ss=xe?qe(xe):function(t){return ns(t)&&fo(t)==C};function us(t){return"string"==typeof t||!Xa(t)&&ns(t)&&Sr(t)==R}function ls(t){return"symbol"==typeof t||ns(t)&&Sr(t)==P}var cs=we?qe(we):function(t){return ns(t)&&ts(t.length)&&!!ie[Sr(t)]},hs=Wi(Nr),fs=Wi((function(t,e){return t<=e}));function ds(t){if(!t)return[];if(Ha(t))return us(t)?fn(t):Ci(t);if(qt&&t[qt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[qt]());var e=fo(t);return(e==w?an:e==C?ln:Bs)(t)}function ps(t){return t?(t=ys(t))===c||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function vs(t){var e=ps(t),n=e%1;return e==e?n?e-n:e:0}function gs(t){return t?ar(vs(t),0,d):0}function ys(t){if("number"==typeof t)return t;if(ls(t))return f;if(es(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=es(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ye(t);var n=pt.test(t);return n||gt.test(t)?ue(t.slice(2),n?2:8):dt.test(t)?f:+t}function ms(t){return Ri(t,Is(t))}function _s(t){return null==t?"":si(t)}var bs=Di((function(t,e){if(wo(e)||Ha(e))Ri(e,ks(e),t);else for(var n in e)It.call(e,n)&&tr(t,n,e[n])})),xs=Di((function(t,e){Ri(e,Is(e),t)})),ws=Di((function(t,e,n,r){Ri(e,Is(e),t,r)})),Ts=Di((function(t,e,n,r){Ri(e,ks(e),t,r)})),Ss=to(or),As=Yr((function(t,e){t=St(t);var n=-1,r=e.length,o=r>2?e[2]:i;for(o&&mo(e[0],e[1],o)&&(r=1);++n<r;)for(var a=e[n],s=Is(a),u=-1,l=s.length;++u<l;){var c=s[u],h=t[c];(h===i||Ba(h,Dt[c])&&!It.call(t,c))&&(t[c]=a[c])}return t})),Es=Yr((function(t){return t.push(i,Ki),Te(Ms,i,t)}));function Cs(t,e,n){var r=null==t?i:wr(t,e);return r===i?n:r}function Rs(t,e){return null!=t&&po(t,e,Cr)}var Ps=Fi((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Nt.call(e)),t[e]=n}),eu(iu)),Ds=Fi((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Nt.call(e)),It.call(t,e)?t[e].push(n):t[e]=[n]}),ao),Os=Yr(Pr);function ks(t){return Ha(t)?qn(t):Mr(t)}function Is(t){return Ha(t)?qn(t,!0):function(t){if(!es(t))return function(t){var e=[];if(null!=t)for(var n in St(t))e.push(n);return e}(t);var e=wo(t),n=[];for(var r in t)("constructor"!=r||!e&&It.call(t,r))&&n.push(r);return n}(t)}var Ls=Di((function(t,e,n){zr(t,e,n)})),Ms=Di((function(t,e,n,r){zr(t,e,n,r)})),Ns=to((function(t,e){var n={};if(null==t)return n;var r=!1;e=Oe(e,(function(e){return e=yi(e,t),r||(r=e.length>1),e})),Ri(t,no(t),n),r&&(n=sr(n,7,Ji));for(var i=e.length;i--;)li(n,e[i]);return n})),js=to((function(t,e){return null==t?{}:function(t,e){return Gr(t,e,(function(e,n){return Rs(t,n)}))}(t,e)}));function Us(t,e){if(null==t)return{};var n=Oe(no(t),(function(t){return[t]}));return e=ao(e),Gr(t,n,(function(t,n){return e(t,n[0])}))}var Fs=Yi(ks),zs=Yi(Is);function Bs(t){return null==t?[]:Ze(t,ks(t))}var Vs=Li((function(t,e,n){return e=e.toLowerCase(),t+(n?Gs(e):e)}));function Gs(t){return Ks(_s(t).toLowerCase())}function Ws(t){return(t=_s(t))&&t.replace(mt,en).replace(Kt,"")}var Xs=Li((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),$s=Li((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Hs=Ii("toLowerCase"),Ys=Li((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),qs=Li((function(t,e,n){return t+(n?" ":"")+Ks(e)})),Zs=Li((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Ks=Ii("toUpperCase");function Js(t,e,n){return t=_s(t),(e=n?i:e)===i?function(t){return ee.test(t)}(t)?function(t){return t.match(Qt)||[]}(t):function(t){return t.match(ut)||[]}(t):t.match(e)||[]}var Qs=Yr((function(t,e){try{return Te(t,i,e)}catch(t){return Ka(t)?t:new xt(t)}})),tu=to((function(t,e){return Ae(e,(function(e){e=Uo(e),ir(t,e,Da(t[e],t))})),t}));function eu(t){return function(){return t}}var nu=ji(),ru=ji(!0);function iu(t){return t}function ou(t){return Lr("function"==typeof t?t:sr(t,1))}var au=Yr((function(t,e){return function(n){return Pr(n,t,e)}})),su=Yr((function(t,e){return function(n){return Pr(t,n,e)}}));function uu(t,e,n){var r=ks(e),i=xr(e,r);null!=n||es(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=xr(e,ks(e)));var o=!(es(n)&&"chain"in n&&!n.chain),a=Ja(t);return Ae(i,(function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=Ci(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,ke([this.value()],arguments))})})),t}function lu(){}var cu=Bi(Oe),hu=Bi(Ce),fu=Bi(Me);function du(t){return _o(t)?Ge(Uo(t)):function(t){return function(e){return wr(e,t)}}(t)}var pu=Gi(),vu=Gi(!0);function gu(){return[]}function yu(){return!1}var mu,_u=zi((function(t,e){return t+e}),0),bu=$i("ceil"),xu=zi((function(t,e){return t/e}),1),wu=$i("floor"),Tu=zi((function(t,e){return t*e}),1),Su=$i("round"),Au=zi((function(t,e){return t-e}),0);return Fn.after=function(t,e){if("function"!=typeof e)throw new Ct(o);return t=vs(t),function(){if(--t<1)return e.apply(this,arguments)}},Fn.ary=Ra,Fn.assign=bs,Fn.assignIn=xs,Fn.assignInWith=ws,Fn.assignWith=Ts,Fn.at=Ss,Fn.before=Pa,Fn.bind=Da,Fn.bindAll=tu,Fn.bindKey=Oa,Fn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Xa(t)?t:[t]},Fn.chain=da,Fn.chunk=function(t,e,n){e=(n?mo(t,e,n):e===i)?1:yn(vs(e),0);var o=null==t?0:t.length;if(!o||e<1)return[];for(var a=0,s=0,u=r(fe(o/e));a<o;)u[s++]=ei(t,a,a+=e);return u},Fn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},Fn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return ke(Xa(n)?Ci(n):[n],gr(e,1))},Fn.cond=function(t){var e=null==t?0:t.length,n=ao();return t=e?Oe(t,(function(t){if("function"!=typeof t[1])throw new Ct(o);return[n(t[0]),t[1]]})):[],Yr((function(n){for(var r=-1;++r<e;){var i=t[r];if(Te(i[0],this,n))return Te(i[1],this,n)}}))},Fn.conforms=function(t){return function(t){var e=ks(t);return function(n){return ur(n,t,e)}}(sr(t,1))},Fn.constant=eu,Fn.countBy=ga,Fn.create=function(t,e){var n=zn(t);return null==e?n:rr(n,e)},Fn.curry=function t(e,n,r){var o=qi(e,8,i,i,i,i,i,n=r?i:n);return o.placeholder=t.placeholder,o},Fn.curryRight=function t(e,n,r){var o=qi(e,16,i,i,i,i,i,n=r?i:n);return o.placeholder=t.placeholder,o},Fn.debounce=ka,Fn.defaults=As,Fn.defaultsDeep=Es,Fn.defer=Ia,Fn.delay=La,Fn.difference=Bo,Fn.differenceBy=Vo,Fn.differenceWith=Go,Fn.drop=function(t,e,n){var r=null==t?0:t.length;return r?ei(t,(e=n||e===i?1:vs(e))<0?0:e,r):[]},Fn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?ei(t,0,(e=r-(e=n||e===i?1:vs(e)))<0?0:e):[]},Fn.dropRightWhile=function(t,e){return t&&t.length?hi(t,ao(e,3),!0,!0):[]},Fn.dropWhile=function(t,e){return t&&t.length?hi(t,ao(e,3),!0):[]},Fn.fill=function(t,e,n,r){var o=null==t?0:t.length;return o?(n&&"number"!=typeof n&&mo(t,e,n)&&(n=0,r=o),function(t,e,n,r){var o=t.length;for((n=vs(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:vs(r))<0&&(r+=o),r=n>r?0:gs(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Fn.filter=function(t,e){return(Xa(t)?Re:vr)(t,ao(e,3))},Fn.flatMap=function(t,e){return gr(Sa(t,e),1)},Fn.flatMapDeep=function(t,e){return gr(Sa(t,e),c)},Fn.flatMapDepth=function(t,e,n){return n=n===i?1:vs(n),gr(Sa(t,e),n)},Fn.flatten=$o,Fn.flattenDeep=function(t){return null!=t&&t.length?gr(t,c):[]},Fn.flattenDepth=function(t,e){return null!=t&&t.length?gr(t,e=e===i?1:vs(e)):[]},Fn.flip=function(t){return qi(t,512)},Fn.flow=nu,Fn.flowRight=ru,Fn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},Fn.functions=function(t){return null==t?[]:xr(t,ks(t))},Fn.functionsIn=function(t){return null==t?[]:xr(t,Is(t))},Fn.groupBy=xa,Fn.initial=function(t){return null!=t&&t.length?ei(t,0,-1):[]},Fn.intersection=Yo,Fn.intersectionBy=qo,Fn.intersectionWith=Zo,Fn.invert=Ps,Fn.invertBy=Ds,Fn.invokeMap=wa,Fn.iteratee=ou,Fn.keyBy=Ta,Fn.keys=ks,Fn.keysIn=Is,Fn.map=Sa,Fn.mapKeys=function(t,e){var n={};return e=ao(e,3),_r(t,(function(t,r,i){ir(n,e(t,r,i),t)})),n},Fn.mapValues=function(t,e){var n={};return e=ao(e,3),_r(t,(function(t,r,i){ir(n,r,e(t,r,i))})),n},Fn.matches=function(t){return Ur(sr(t,1))},Fn.matchesProperty=function(t,e){return Fr(t,sr(e,1))},Fn.memoize=Ma,Fn.merge=Ls,Fn.mergeWith=Ms,Fn.method=au,Fn.methodOf=su,Fn.mixin=uu,Fn.negate=Na,Fn.nthArg=function(t){return t=vs(t),Yr((function(e){return Br(e,t)}))},Fn.omit=Ns,Fn.omitBy=function(t,e){return Us(t,Na(ao(e)))},Fn.once=function(t){return Pa(2,t)},Fn.orderBy=function(t,e,n,r){return null==t?[]:(Xa(e)||(e=null==e?[]:[e]),Xa(n=r?i:n)||(n=null==n?[]:[n]),Vr(t,e,n))},Fn.over=cu,Fn.overArgs=ja,Fn.overEvery=hu,Fn.overSome=fu,Fn.partial=Ua,Fn.partialRight=Fa,Fn.partition=Aa,Fn.pick=js,Fn.pickBy=Us,Fn.property=du,Fn.propertyOf=function(t){return function(e){return null==t?i:wr(t,e)}},Fn.pull=Jo,Fn.pullAll=Qo,Fn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Wr(t,e,ao(n,2)):t},Fn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Wr(t,e,i,n):t},Fn.pullAt=ta,Fn.range=pu,Fn.rangeRight=vu,Fn.rearg=za,Fn.reject=function(t,e){return(Xa(t)?Re:vr)(t,Na(ao(e,3)))},Fn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=ao(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return Xr(t,i),n},Fn.rest=function(t,e){if("function"!=typeof t)throw new Ct(o);return Yr(t,e=e===i?e:vs(e))},Fn.reverse=ea,Fn.sampleSize=function(t,e,n){return e=(n?mo(t,e,n):e===i)?1:vs(e),(Xa(t)?Kn:Zr)(t,e)},Fn.set=function(t,e,n){return null==t?t:Kr(t,e,n)},Fn.setWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:Kr(t,e,n,r)},Fn.shuffle=function(t){return(Xa(t)?Jn:ti)(t)},Fn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&mo(t,e,n)?(e=0,n=r):(e=null==e?0:vs(e),n=n===i?r:vs(n)),ei(t,e,n)):[]},Fn.sortBy=Ea,Fn.sortedUniq=function(t){return t&&t.length?oi(t):[]},Fn.sortedUniqBy=function(t,e){return t&&t.length?oi(t,ao(e,2)):[]},Fn.split=function(t,e,n){return n&&"number"!=typeof n&&mo(t,e,n)&&(e=n=i),(n=n===i?d:n>>>0)?(t=_s(t))&&("string"==typeof e||null!=e&&!as(e))&&!(e=si(e))&&on(t)?_i(fn(t),0,n):t.split(e,n):[]},Fn.spread=function(t,e){if("function"!=typeof t)throw new Ct(o);return e=null==e?0:yn(vs(e),0),Yr((function(n){var r=n[e],i=_i(n,0,e);return r&&ke(i,r),Te(t,this,i)}))},Fn.tail=function(t){var e=null==t?0:t.length;return e?ei(t,1,e):[]},Fn.take=function(t,e,n){return t&&t.length?ei(t,0,(e=n||e===i?1:vs(e))<0?0:e):[]},Fn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?ei(t,(e=r-(e=n||e===i?1:vs(e)))<0?0:e,r):[]},Fn.takeRightWhile=function(t,e){return t&&t.length?hi(t,ao(e,3),!1,!0):[]},Fn.takeWhile=function(t,e){return t&&t.length?hi(t,ao(e,3)):[]},Fn.tap=function(t,e){return e(t),t},Fn.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Ct(o);return es(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),ka(t,e,{leading:r,maxWait:e,trailing:i})},Fn.thru=pa,Fn.toArray=ds,Fn.toPairs=Fs,Fn.toPairsIn=zs,Fn.toPath=function(t){return Xa(t)?Oe(t,Uo):ls(t)?[t]:Ci(jo(_s(t)))},Fn.toPlainObject=ms,Fn.transform=function(t,e,n){var r=Xa(t),i=r||qa(t)||cs(t);if(e=ao(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:es(t)&&Ja(o)?zn(Wt(t)):{}}return(i?Ae:_r)(t,(function(t,r,i){return e(n,t,r,i)})),n},Fn.unary=function(t){return Ra(t,1)},Fn.union=na,Fn.unionBy=ra,Fn.unionWith=ia,Fn.uniq=function(t){return t&&t.length?ui(t):[]},Fn.uniqBy=function(t,e){return t&&t.length?ui(t,ao(e,2)):[]},Fn.uniqWith=function(t,e){return e="function"==typeof e?e:i,t&&t.length?ui(t,i,e):[]},Fn.unset=function(t,e){return null==t||li(t,e)},Fn.unzip=oa,Fn.unzipWith=aa,Fn.update=function(t,e,n){return null==t?t:ci(t,e,gi(n))},Fn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:ci(t,e,gi(n),r)},Fn.values=Bs,Fn.valuesIn=function(t){return null==t?[]:Ze(t,Is(t))},Fn.without=sa,Fn.words=Js,Fn.wrap=function(t,e){return Ua(gi(e),t)},Fn.xor=ua,Fn.xorBy=la,Fn.xorWith=ca,Fn.zip=ha,Fn.zipObject=function(t,e){return pi(t||[],e||[],tr)},Fn.zipObjectDeep=function(t,e){return pi(t||[],e||[],Kr)},Fn.zipWith=fa,Fn.entries=Fs,Fn.entriesIn=zs,Fn.extend=xs,Fn.extendWith=ws,uu(Fn,Fn),Fn.add=_u,Fn.attempt=Qs,Fn.camelCase=Vs,Fn.capitalize=Gs,Fn.ceil=bu,Fn.clamp=function(t,e,n){return n===i&&(n=e,e=i),n!==i&&(n=(n=ys(n))==n?n:0),e!==i&&(e=(e=ys(e))==e?e:0),ar(ys(t),e,n)},Fn.clone=function(t){return sr(t,4)},Fn.cloneDeep=function(t){return sr(t,5)},Fn.cloneDeepWith=function(t,e){return sr(t,5,e="function"==typeof e?e:i)},Fn.cloneWith=function(t,e){return sr(t,4,e="function"==typeof e?e:i)},Fn.conformsTo=function(t,e){return null==e||ur(t,e,ks(e))},Fn.deburr=Ws,Fn.defaultTo=function(t,e){return null==t||t!=t?e:t},Fn.divide=xu,Fn.endsWith=function(t,e,n){t=_s(t),e=si(e);var r=t.length,o=n=n===i?r:ar(vs(n),0,r);return(n-=e.length)>=0&&t.slice(n,o)==e},Fn.eq=Ba,Fn.escape=function(t){return(t=_s(t))&&Y.test(t)?t.replace($,nn):t},Fn.escapeRegExp=function(t){return(t=_s(t))&&nt.test(t)?t.replace(et,"\\$&"):t},Fn.every=function(t,e,n){var r=Xa(t)?Ce:dr;return n&&mo(t,e,n)&&(e=i),r(t,ao(e,3))},Fn.find=ya,Fn.findIndex=Wo,Fn.findKey=function(t,e){return je(t,ao(e,3),_r)},Fn.findLast=ma,Fn.findLastIndex=Xo,Fn.findLastKey=function(t,e){return je(t,ao(e,3),br)},Fn.floor=wu,Fn.forEach=_a,Fn.forEachRight=ba,Fn.forIn=function(t,e){return null==t?t:yr(t,ao(e,3),Is)},Fn.forInRight=function(t,e){return null==t?t:mr(t,ao(e,3),Is)},Fn.forOwn=function(t,e){return t&&_r(t,ao(e,3))},Fn.forOwnRight=function(t,e){return t&&br(t,ao(e,3))},Fn.get=Cs,Fn.gt=Va,Fn.gte=Ga,Fn.has=function(t,e){return null!=t&&po(t,e,Er)},Fn.hasIn=Rs,Fn.head=Ho,Fn.identity=iu,Fn.includes=function(t,e,n,r){t=Ha(t)?t:Bs(t),n=n&&!r?vs(n):0;var i=t.length;return n<0&&(n=yn(i+n,0)),us(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&Fe(t,e,n)>-1},Fn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:vs(n);return i<0&&(i=yn(r+i,0)),Fe(t,e,i)},Fn.inRange=function(t,e,n){return e=ps(e),n===i?(n=e,e=0):n=ps(n),function(t,e,n){return t>=mn(e,n)&&t<yn(e,n)}(t=ys(t),e,n)},Fn.invoke=Os,Fn.isArguments=Wa,Fn.isArray=Xa,Fn.isArrayBuffer=$a,Fn.isArrayLike=Ha,Fn.isArrayLikeObject=Ya,Fn.isBoolean=function(t){return!0===t||!1===t||ns(t)&&Sr(t)==y},Fn.isBuffer=qa,Fn.isDate=Za,Fn.isElement=function(t){return ns(t)&&1===t.nodeType&&!os(t)},Fn.isEmpty=function(t){if(null==t)return!0;if(Ha(t)&&(Xa(t)||"string"==typeof t||"function"==typeof t.splice||qa(t)||cs(t)||Wa(t)))return!t.length;var e=fo(t);if(e==w||e==C)return!t.size;if(wo(t))return!Mr(t).length;for(var n in t)if(It.call(t,n))return!1;return!0},Fn.isEqual=function(t,e){return Or(t,e)},Fn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:i)?n(t,e):i;return r===i?Or(t,e,i,n):!!r},Fn.isError=Ka,Fn.isFinite=function(t){return"number"==typeof t&&Ne(t)},Fn.isFunction=Ja,Fn.isInteger=Qa,Fn.isLength=ts,Fn.isMap=rs,Fn.isMatch=function(t,e){return t===e||kr(t,e,uo(e))},Fn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:i,kr(t,e,uo(e),n)},Fn.isNaN=function(t){return is(t)&&t!=+t},Fn.isNative=function(t){if(xo(t))throw new xt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ir(t)},Fn.isNil=function(t){return null==t},Fn.isNull=function(t){return null===t},Fn.isNumber=is,Fn.isObject=es,Fn.isObjectLike=ns,Fn.isPlainObject=os,Fn.isRegExp=as,Fn.isSafeInteger=function(t){return Qa(t)&&t>=-9007199254740991&&t<=h},Fn.isSet=ss,Fn.isString=us,Fn.isSymbol=ls,Fn.isTypedArray=cs,Fn.isUndefined=function(t){return t===i},Fn.isWeakMap=function(t){return ns(t)&&fo(t)==D},Fn.isWeakSet=function(t){return ns(t)&&"[object WeakSet]"==Sr(t)},Fn.join=function(t,e){return null==t?"":We.call(t,e)},Fn.kebabCase=Xs,Fn.last=Ko,Fn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=vs(n))<0?yn(r+o,0):mn(o,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,o):Ue(t,Be,o,!0)},Fn.lowerCase=$s,Fn.lowerFirst=Hs,Fn.lt=hs,Fn.lte=fs,Fn.max=function(t){return t&&t.length?pr(t,iu,Ar):i},Fn.maxBy=function(t,e){return t&&t.length?pr(t,ao(e,2),Ar):i},Fn.mean=function(t){return Ve(t,iu)},Fn.meanBy=function(t,e){return Ve(t,ao(e,2))},Fn.min=function(t){return t&&t.length?pr(t,iu,Nr):i},Fn.minBy=function(t,e){return t&&t.length?pr(t,ao(e,2),Nr):i},Fn.stubArray=gu,Fn.stubFalse=yu,Fn.stubObject=function(){return{}},Fn.stubString=function(){return""},Fn.stubTrue=function(){return!0},Fn.multiply=Tu,Fn.nth=function(t,e){return t&&t.length?Br(t,vs(e)):i},Fn.noConflict=function(){return he._===this&&(he._=Ut),this},Fn.noop=lu,Fn.now=Ca,Fn.pad=function(t,e,n){t=_s(t);var r=(e=vs(e))?hn(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Vi(de(i),n)+t+Vi(fe(i),n)},Fn.padEnd=function(t,e,n){t=_s(t);var r=(e=vs(e))?hn(t):0;return e&&r<e?t+Vi(e-r,n):t},Fn.padStart=function(t,e,n){t=_s(t);var r=(e=vs(e))?hn(t):0;return e&&r<e?Vi(e-r,n)+t:t},Fn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),bn(_s(t).replace(rt,""),e||0)},Fn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&mo(t,e,n)&&(e=n=i),n===i&&("boolean"==typeof e?(n=e,e=i):"boolean"==typeof t&&(n=t,t=i)),t===i&&e===i?(t=0,e=1):(t=ps(t),e===i?(e=t,t=0):e=ps(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var o=xn();return mn(t+o*(e-t+se("1e-"+((o+"").length-1))),e)}return $r(t,e)},Fn.reduce=function(t,e,n){var r=Xa(t)?Ie:Xe,i=arguments.length<3;return r(t,ao(e,4),n,i,hr)},Fn.reduceRight=function(t,e,n){var r=Xa(t)?Le:Xe,i=arguments.length<3;return r(t,ao(e,4),n,i,fr)},Fn.repeat=function(t,e,n){return e=(n?mo(t,e,n):e===i)?1:vs(e),Hr(_s(t),e)},Fn.replace=function(){var t=arguments,e=_s(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Fn.result=function(t,e,n){var r=-1,o=(e=yi(e,t)).length;for(o||(o=1,t=i);++r<o;){var a=null==t?i:t[Uo(e[r])];a===i&&(r=o,a=n),t=Ja(a)?a.call(t):a}return t},Fn.round=Su,Fn.runInContext=t,Fn.sample=function(t){return(Xa(t)?Zn:qr)(t)},Fn.size=function(t){if(null==t)return 0;if(Ha(t))return us(t)?hn(t):t.length;var e=fo(t);return e==w||e==C?t.size:Mr(t).length},Fn.snakeCase=Ys,Fn.some=function(t,e,n){var r=Xa(t)?Me:ni;return n&&mo(t,e,n)&&(e=i),r(t,ao(e,3))},Fn.sortedIndex=function(t,e){return ri(t,e)},Fn.sortedIndexBy=function(t,e,n){return ii(t,e,ao(n,2))},Fn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=ri(t,e);if(r<n&&Ba(t[r],e))return r}return-1},Fn.sortedLastIndex=function(t,e){return ri(t,e,!0)},Fn.sortedLastIndexBy=function(t,e,n){return ii(t,e,ao(n,2),!0)},Fn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=ri(t,e,!0)-1;if(Ba(t[n],e))return n}return-1},Fn.startCase=qs,Fn.startsWith=function(t,e,n){return t=_s(t),n=null==n?0:ar(vs(n),0,t.length),e=si(e),t.slice(n,n+e.length)==e},Fn.subtract=Au,Fn.sum=function(t){return t&&t.length?$e(t,iu):0},Fn.sumBy=function(t,e){return t&&t.length?$e(t,ao(e,2)):0},Fn.template=function(t,e,n){var r=Fn.templateSettings;n&&mo(t,e,n)&&(e=i),t=_s(t),e=ws({},e,r,Zi);var o,a,s=ws({},e.imports,r.imports,Zi),u=ks(s),l=Ze(s,u),c=0,h=e.interpolate||_t,f="__p += '",d=At((e.escape||_t).source+"|"+h.source+"|"+(h===K?ht:_t).source+"|"+(e.evaluate||_t).source+"|$","g"),p="//# sourceURL="+(It.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++re+"]")+"\n";t.replace(d,(function(e,n,r,i,s,u){return r||(r=i),f+=t.slice(c,u).replace(bt,rn),n&&(o=!0,f+="' +\n__e("+n+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+e.length,e})),f+="';\n";var v=It.call(e,"variable")&&e.variable;if(v){if(lt.test(v))throw new xt("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(a?f.replace(V,""):f).replace(G,"$1").replace(W,"$1;"),f="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var g=Qs((function(){return wt(u,p+"return "+f).apply(i,l)}));if(g.source=f,Ka(g))throw g;return g},Fn.times=function(t,e){if((t=vs(t))<1||t>h)return[];var n=d,r=mn(t,d);e=ao(e),t-=d;for(var i=He(r,e);++n<t;)e(n);return i},Fn.toFinite=ps,Fn.toInteger=vs,Fn.toLength=gs,Fn.toLower=function(t){return _s(t).toLowerCase()},Fn.toNumber=ys,Fn.toSafeInteger=function(t){return t?ar(vs(t),-9007199254740991,h):0===t?t:0},Fn.toString=_s,Fn.toUpper=function(t){return _s(t).toUpperCase()},Fn.trim=function(t,e,n){if((t=_s(t))&&(n||e===i))return Ye(t);if(!t||!(e=si(e)))return t;var r=fn(t),o=fn(e);return _i(r,Je(r,o),Qe(r,o)+1).join("")},Fn.trimEnd=function(t,e,n){if((t=_s(t))&&(n||e===i))return t.slice(0,dn(t)+1);if(!t||!(e=si(e)))return t;var r=fn(t);return _i(r,0,Qe(r,fn(e))+1).join("")},Fn.trimStart=function(t,e,n){if((t=_s(t))&&(n||e===i))return t.replace(rt,"");if(!t||!(e=si(e)))return t;var r=fn(t);return _i(r,Je(r,fn(e))).join("")},Fn.truncate=function(t,e){var n=30,r="...";if(es(e)){var o="separator"in e?e.separator:o;n="length"in e?vs(e.length):n,r="omission"in e?si(e.omission):r}var a=(t=_s(t)).length;if(on(t)){var s=fn(t);a=s.length}if(n>=a)return t;var u=n-hn(r);if(u<1)return r;var l=s?_i(s,0,u).join(""):t.slice(0,u);if(o===i)return l+r;if(s&&(u+=l.length-u),as(o)){if(t.slice(u).search(o)){var c,h=l;for(o.global||(o=At(o.source,_s(ft.exec(o))+"g")),o.lastIndex=0;c=o.exec(h);)var f=c.index;l=l.slice(0,f===i?u:f)}}else if(t.indexOf(si(o),u)!=u){var d=l.lastIndexOf(o);d>-1&&(l=l.slice(0,d))}return l+r},Fn.unescape=function(t){return(t=_s(t))&&H.test(t)?t.replace(X,pn):t},Fn.uniqueId=function(t){var e=++Lt;return _s(t)+e},Fn.upperCase=Zs,Fn.upperFirst=Ks,Fn.each=_a,Fn.eachRight=ba,Fn.first=Ho,uu(Fn,(mu={},_r(Fn,(function(t,e){It.call(Fn.prototype,e)||(mu[e]=t)})),mu),{chain:!1}),Fn.VERSION="4.17.21",Ae(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Fn[t].placeholder=Fn})),Ae(["drop","take"],(function(t,e){Gn.prototype[t]=function(n){n=n===i?1:yn(vs(n),0);var r=this.__filtered__&&!e?new Gn(this):this.clone();return r.__filtered__?r.__takeCount__=mn(n,r.__takeCount__):r.__views__.push({size:mn(n,d),type:t+(r.__dir__<0?"Right":"")}),r},Gn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),Ae(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Gn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:ao(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),Ae(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Gn.prototype[t]=function(){return this[n](1).value()[0]}})),Ae(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Gn.prototype[t]=function(){return this.__filtered__?new Gn(this):this[n](1)}})),Gn.prototype.compact=function(){return this.filter(iu)},Gn.prototype.find=function(t){return this.filter(t).head()},Gn.prototype.findLast=function(t){return this.reverse().find(t)},Gn.prototype.invokeMap=Yr((function(t,e){return"function"==typeof t?new Gn(this):this.map((function(n){return Pr(n,t,e)}))})),Gn.prototype.reject=function(t){return this.filter(Na(ao(t)))},Gn.prototype.slice=function(t,e){t=vs(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Gn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==i&&(n=(e=vs(e))<0?n.dropRight(-e):n.take(e-t)),n)},Gn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Gn.prototype.toArray=function(){return this.take(d)},_r(Gn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),o=Fn[r?"take"+("last"==e?"Right":""):e],a=r||/^find/.test(e);o&&(Fn.prototype[e]=function(){var e=this.__wrapped__,s=r?[1]:arguments,u=e instanceof Gn,l=s[0],c=u||Xa(e),h=function(t){var e=o.apply(Fn,ke([t],s));return r&&f?e[0]:e};c&&n&&"function"==typeof l&&1!=l.length&&(u=c=!1);var f=this.__chain__,d=!!this.__actions__.length,p=a&&!f,v=u&&!d;if(!a&&c){e=v?e:new Gn(this);var g=t.apply(e,s);return g.__actions__.push({func:pa,args:[h],thisArg:i}),new Vn(g,f)}return p&&v?t.apply(this,s):(g=this.thru(h),p?r?g.value()[0]:g.value():g)})})),Ae(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Rt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Fn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Xa(i)?i:[],t)}return this[n]((function(n){return e.apply(Xa(n)?n:[],t)}))}})),_r(Gn.prototype,(function(t,e){var n=Fn[e];if(n){var r=n.name+"";It.call(Dn,r)||(Dn[r]=[]),Dn[r].push({name:e,func:n})}})),Dn[Ui(i,2).name]=[{name:"wrapper",func:i}],Gn.prototype.clone=function(){var t=new Gn(this.__wrapped__);return t.__actions__=Ci(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ci(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ci(this.__views__),t},Gn.prototype.reverse=function(){if(this.__filtered__){var t=new Gn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Gn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Xa(t),r=e<0,i=n?t.length:0,o=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=mn(e,t+a);break;case"takeRight":t=yn(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,s=o.end,u=s-a,l=r?s:a-1,c=this.__iteratees__,h=c.length,f=0,d=mn(u,this.__takeCount__);if(!n||!r&&i==u&&d==u)return fi(t,this.__actions__);var p=[];t:for(;u--&&f<d;){for(var v=-1,g=t[l+=e];++v<h;){var y=c[v],m=y.iteratee,_=y.type,b=m(g);if(2==_)g=b;else if(!b){if(1==_)continue t;break t}}p[f++]=g}return p},Fn.prototype.at=va,Fn.prototype.chain=function(){return da(this)},Fn.prototype.commit=function(){return new Vn(this.value(),this.__chain__)},Fn.prototype.next=function(){this.__values__===i&&(this.__values__=ds(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?i:this.__values__[this.__index__++]}},Fn.prototype.plant=function(t){for(var e,n=this;n instanceof Bn;){var r=zo(n);r.__index__=0,r.__values__=i,e?o.__wrapped__=r:e=r;var o=r;n=n.__wrapped__}return o.__wrapped__=t,e},Fn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Gn){var e=t;return this.__actions__.length&&(e=new Gn(this)),(e=e.reverse()).__actions__.push({func:pa,args:[ea],thisArg:i}),new Vn(e,this.__chain__)}return this.thru(ea)},Fn.prototype.toJSON=Fn.prototype.valueOf=Fn.prototype.value=function(){return fi(this.__wrapped__,this.__actions__)},Fn.prototype.first=Fn.prototype.head,qt&&(Fn.prototype[qt]=function(){return this}),Fn}();he._=vn,(r=function(){return vn}.call(e,n,e,t))===i||(t.exports=r)}.call(this)},640:function(t,e,n){var r,i;!function(o,a){"use strict";r=function(){var t=function(){},e="undefined",n=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(t,e){var n=t[e];if("function"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(e){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(r){return"debug"===r&&(r="log"),typeof console!==e&&("trace"===r&&n?o:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):t)}function s(e,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<e?t:this.methodFactory(o,e,n)}this.log=this.debug}function u(t,n,r){return function(){typeof console!==e&&(s.call(this,n,r),this[t].apply(this,arguments))}}function l(t,e,n){return a(t)||u.apply(this,arguments)}function c(t,n,i){var o,a=this;n=null==n?"WARN":n;var u="loglevel";function c(){var t;if(typeof window!==e&&u){try{t=window.localStorage[u]}catch(t){}if(typeof t===e)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(u)+"=");-1!==r&&(t=/^([^;]+)/.exec(n.slice(r))[1])}catch(t){}return void 0===a.levels[t]&&(t=void 0),t}}"string"==typeof t?u+=":"+t:"symbol"==typeof t&&(u=void 0),a.name=t,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=i||l,a.getLevel=function(){return o},a.setLevel=function(n,i){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==i&&function(t){var n=(r[t]||"silent").toUpperCase();if(typeof window!==e&&u){try{return void(window.localStorage[u]=n)}catch(t){}try{window.document.cookie=encodeURIComponent(u)+"="+n+";"}catch(t){}}}(n),s.call(a,n,t),typeof console===e&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(t){n=t,c()||a.setLevel(t,!1)},a.resetLevel=function(){a.setLevel(n,!1),function(){if(typeof window!==e&&u){try{return void window.localStorage.removeItem(u)}catch(t){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(t){}}}()},a.enableAll=function(t){a.setLevel(a.levels.TRACE,t)},a.disableAll=function(t){a.setLevel(a.levels.SILENT,t)};var h=c();null==h&&(h=n),a.setLevel(h,!1)}var h=new c,f={};h.getLogger=function(t){if("symbol"!=typeof t&&"string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=f[t];return e||(e=f[t]=new c(t,h.getLevel(),h.methodFactory)),e};var d=typeof window!==e?window.log:void 0;return h.noConflict=function(){return typeof window!==e&&window.log===h&&(window.log=d),h},h.getLoggers=function(){return f},h.default=h,h},void 0===(i=r.call(e,n,e,t))||(t.exports=i)}()},805:(t,e,n)=>{t.exports=n(195)},195:t=>{"use strict";t.exports=class{constructor(t,e,n,r){let i;if("object"==typeof t){let o=t;t=o.k_p,e=o.k_i,n=o.k_d,r=o.dt,i=o.i_max}this.k_p="number"==typeof t?t:1,this.k_i=e||0,this.k_d=n||0,this.dt=r||0,this.i_max=i||0,this.sumError=0,this.lastError=0,this.lastTime=0,this.target=0}setTarget(t){this.target=t}update(t){this.currentValue=t;let e=this.dt;if(!e){let t=Date.now();e=0===this.lastTime?0:(t-this.lastTime)/1e3,this.lastTime=t}"number"==typeof e&&0!==e||(e=1);let n=this.target-this.currentValue;if(this.sumError=this.sumError+n*e,this.i_max>0&&Math.abs(this.sumError)>this.i_max){let t=this.sumError>0?1:-1;this.sumError=t*this.i_max}let r=(n-this.lastError)/e;return this.lastError=n,this.k_p*n+this.k_i*this.sumError+this.k_d*r}reset(){this.sumError=0,this.lastError=0,this.lastTime=0}}},696:t=>{var e,n,r=document.attachEvent,i=!1;function o(t){var e=t.__resizeTriggers__,n=e.firstElementChild,r=e.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight}function a(t){var e=this;o(this),this.__resizeRAF__&&u(this.__resizeRAF__),this.__resizeRAF__=s((function(){(function(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height})(e)&&(e.__resizeLast__.width=e.offsetWidth,e.__resizeLast__.height=e.offsetHeight,e.__resizeListeners__.forEach((function(n){n.call(e,t)})))}))}if(!r){var s=(n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)},function(t){return n(t)}),u=(e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout,function(t){return e(t)}),l=!1,c="",h="animationstart",f="Webkit Moz O ms".split(" "),d="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),p=document.createElement("fakeelement");if(void 0!==p.style.animationName&&(l=!0),!1===l)for(var v=0;v<f.length;v++)if(void 0!==p.style[f[v]+"AnimationName"]){c="-"+f[v].toLowerCase()+"-",h=d[v],l=!0;break}var g="resizeanim",y="@"+c+"keyframes "+g+" { from { opacity: 0; } to { opacity: 0; } } ",m=c+"animation: 1ms "+g+"; "}t.exports=function(t,e){return r?t.attachEvent("onresize",e):(t.__resizeTriggers__||("static"==getComputedStyle(t).position&&(t.style.position="relative"),function(){if(!i){var t=(y||"")+".resize-triggers { "+(m||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t)),e.appendChild(n),i=!0}}(),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=document.createElement("div")).className="resize-triggers",t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',t.appendChild(t.__resizeTriggers__),o(t),t.addEventListener("scroll",a,!0),h&&t.__resizeTriggers__.addEventListener(h,(function(e){e.animationName==g&&o(t)}))),t.__resizeListeners__.push(e)),function(){r?t.detachEvent("onresize",e):(t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),t.__resizeListeners__.length||(t.removeEventListener("scroll",a),t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)))}}},47:(t,e,n)=>{"use strict";var r=n(429),i=Array.prototype.concat,o=Array.prototype.slice,a=t.exports=function(t){for(var e=[],n=0,a=t.length;n<a;n++){var s=t[n];r(s)?e=i.call(e,o.call(s)):e.push(s)}return e};a.wrap=function(t){return function(){return t(a(arguments))}}},670:e=>{"use strict";e.exports=t}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var i={};return(()=>{"use strict";r.r(i),r.d(i,{CompatibilityError:()=>Jr,ForceDirectedLayoutType:()=>uo,FreeLayoutType:()=>ho,GridLayoutType:()=>co,HierarchicalLayoutType:()=>lo,NVL:()=>_s,colorMapperFunctions:()=>bs,d3ForceLayoutType:()=>fo,default:()=>xs,drawCircleBand:()=>zo});var t=r(635);class e{callbacks;constructor(t={}){this.callbacks=t}onLayoutDone(){this.isValidFunction(this.callbacks.onLayoutDone)&&this.callbacks.onLayoutDone()}onLayoutStep(t){this.isValidFunction(this.callbacks.onLayoutStep)&&this.callbacks.onLayoutStep(t)}onLayoutComputing(t){this.isValidFunction(this.callbacks.onLayoutComputing)&&this.callbacks.onLayoutComputing(t)}onError(t){this.isValidFunction(this.callbacks.onError)&&this.callbacks.onError(t)}onWebGLContextLost(t){this.isValidFunction(this.callbacks.onWebGLContextLost)&&this.callbacks.onWebGLContextLost(t)}isValidFunction(t){return void 0!==t&&"function"==typeof t}}var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function o(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var a=function(){function t(t){void 0===t&&(t="Atom@"+Kt()),this.name=t,this.isPendingUnobservation=!0,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=_e.NOT_TRACKING}return t.prototype.onBecomeUnobserved=function(){},t.prototype.reportObserved=function(){ze(this)},t.prototype.reportChanged=function(){Ue(),function(t){if(t.lowestObserverState!==_e.STALE){t.lowestObserverState=_e.STALE;for(var e=t.observers,n=e.length;n--;){var r=e[n];r.dependenciesState===_e.UP_TO_DATE&&(r.isTracing!==be.NONE&&Be(r,t),r.onBecomeStale()),r.dependenciesState=_e.STALE}}}(this),Fe()},t.prototype.toString=function(){return this.name},t}(),s=function(t){function e(e,n,r){void 0===e&&(e="Atom@"+Kt()),void 0===n&&(n=re),void 0===r&&(r=re);var i=t.call(this,e)||this;return i.name=e,i.onBecomeObservedHandler=n,i.onBecomeUnobservedHandler=r,i.isPendingUnobservation=!1,i.isBeingTracked=!1,i}return o(e,t),e.prototype.reportObserved=function(){return Ue(),t.prototype.reportObserved.call(this),this.isBeingTracked||(this.isBeingTracked=!0,this.onBecomeObservedHandler()),Fe(),!!Te.trackingDerivation},e.prototype.onBecomeUnobserved=function(){this.isBeingTracked=!1,this.onBecomeUnobservedHandler()},e}(a),u=ve("Atom",a);function l(t){return t.interceptors&&t.interceptors.length>0}function c(t,e){var n=t.interceptors||(t.interceptors=[]);return n.push(e),ne((function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}))}function h(t,e){var n=Ke();try{var r=t.interceptors;if(r)for(var i=0,o=r.length;i<o&&(Qt(!(e=r[i](e))||e.type,"Intercept handlers should return nothing or a change object"),e);i++);return e}finally{Je(n)}}function f(t){return t.changeListeners&&t.changeListeners.length>0}function d(t,e){var n=t.changeListeners||(t.changeListeners=[]);return n.push(e),ne((function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}))}function p(t,e){var n=Ke(),r=t.changeListeners;if(r){for(var i=0,o=(r=r.slice()).length;i<o;i++)r[i](e);Je(n)}}function v(){return!!Te.spyListeners.length}function g(t){if(Te.spyListeners.length)for(var e=Te.spyListeners,n=0,r=e.length;n<r;n++)e[n](t)}function y(t){g(ue({},t,{spyReportStart:!0}))}var m={spyReportEnd:!0};function _(t){g(t?ue({},t,m):m)}function b(t){return Te.spyListeners.push(t),ne((function(){var e=Te.spyListeners.indexOf(t);-1!==e&&Te.spyListeners.splice(e,1)}))}var x="__$$iterating";function w(t){Qt(!0!==t[x],"Illegal state: cannot recycle array as iterator"),fe(t,x,!0);var e=-1;return fe(t,"next",(function(){return{done:++e>=this.length,value:e<this.length?this[e]:void 0}})),t}function T(t,e){fe(t,"function"==typeof Symbol&&Symbol.iterator||"@@iterator",e)}var S,A,E=function(){var t=!1,e={};return Object.defineProperty(e,"0",{set:function(){t=!0}}),Object.create(e)[0]=1,!1===t}(),C=0,R=function(){};S=R,A=Array.prototype,void 0!==Object.setPrototypeOf?Object.setPrototypeOf(S.prototype,A):void 0!==S.prototype.__proto__?S.prototype.__proto__=A:S.prototype=A,Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach((function(t){Object.defineProperty(R.prototype,t,{configurable:!0,writable:!0,value:Array.prototype[t]})}));var P=function(){function t(t,e,n,r){this.array=n,this.owned=r,this.values=[],this.lastKnownLength=0,this.interceptors=null,this.changeListeners=null,this.atom=new a(t||"ObservableArray@"+Kt()),this.enhancer=function(n,r){return e(n,r,t+"[..]")}}return t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.dehanceValues=function(t){return void 0!==this.dehancer?t.map(this.dehancer):t},t.prototype.intercept=function(t){return c(this,t)},t.prototype.observe=function(t,e){return void 0===e&&(e=!1),e&&t({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),d(this,t)},t.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},t.prototype.setArrayLength=function(t){if("number"!=typeof t||t<0)throw new Error("[mobx.array] Out of range: "+t);var e=this.values.length;if(t!==e)if(t>e){for(var n=new Array(t-e),r=0;r<t-e;r++)n[r]=void 0;this.spliceWithArray(e,0,n)}else this.spliceWithArray(t,e-t)},t.prototype.updateArrayLength=function(t,e){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=e,e>0&&t+e+1>C&&L(t+e+1)},t.prototype.spliceWithArray=function(t,e,n){var r=this;He(this.atom);var i=this.values.length;if(void 0===t?t=0:t>i?t=i:t<0&&(t=Math.max(0,i+t)),e=1===arguments.length?i-t:null==e?0:Math.max(0,Math.min(e,i-t)),void 0===n&&(n=[]),l(this)){var o=h(this,{object:this.array,type:"splice",index:t,removedCount:e,added:n});if(!o)return qt;e=o.removedCount,n=o.added}var a=(n=n.map((function(t){return r.enhancer(t,void 0)}))).length-e;this.updateArrayLength(i,a);var s=this.spliceItemsIntoValues(t,e,n);return 0===e&&0===n.length||this.notifyArraySplice(t,n,s),this.dehanceValues(s)},t.prototype.spliceItemsIntoValues=function(t,e,n){if(n.length<1e4)return(r=this.values).splice.apply(r,[t,e].concat(n));var r,i=this.values.slice(t,t+e);return this.values=this.values.slice(0,t).concat(n,this.values.slice(t+e)),i},t.prototype.notifyArrayChildUpdate=function(t,e,n){var r=!this.owned&&v(),i=f(this),o=i||r?{object:this.array,type:"update",index:t,newValue:e,oldValue:n}:null;r&&y(o),this.atom.reportChanged(),i&&p(this,o),r&&_()},t.prototype.notifyArraySplice=function(t,e,n){var r=!this.owned&&v(),i=f(this),o=i||r?{object:this.array,type:"splice",index:t,removed:n,added:e,removedCount:n.length,addedCount:e.length}:null;r&&y(o),this.atom.reportChanged(),i&&p(this,o),r&&_()},t}(),D=function(t){function e(e,n,r,i){void 0===r&&(r="ObservableArray@"+Kt()),void 0===i&&(i=!1);var o=t.call(this)||this,a=new P(r,n,o,i);return fe(o,"$mobx",a),e&&e.length&&o.spliceWithArray(0,0,e),E&&Object.defineProperty(a.array,"0",O),o}return o(e,t),e.prototype.intercept=function(t){return this.$mobx.intercept(t)},e.prototype.observe=function(t,e){return void 0===e&&(e=!1),this.$mobx.observe(t,e)},e.prototype.clear=function(){return this.splice(0)},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),t.map((function(t){return N(t)?t.peek():t})))},e.prototype.replace=function(t){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,t)},e.prototype.toJS=function(){return this.slice()},e.prototype.toJSON=function(){return this.toJS()},e.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},e.prototype.find=function(t,e,n){void 0===n&&(n=0);var r=this.findIndex.apply(this,arguments);return-1===r?void 0:this.get(r)},e.prototype.findIndex=function(t,e,n){void 0===n&&(n=0);for(var r=this.peek(),i=r.length,o=n;o<i;o++)if(t.call(e,r[o],o,this))return o;return-1},e.prototype.splice=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(t);case 2:return this.$mobx.spliceWithArray(t,e)}return this.$mobx.spliceWithArray(t,e,n)},e.prototype.spliceWithArray=function(t,e,n){return this.$mobx.spliceWithArray(t,e,n)},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.$mobx;return n.spliceWithArray(n.values.length,0,t),n.values.length},e.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},e.prototype.shift=function(){return this.splice(0,1)[0]},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.$mobx;return n.spliceWithArray(0,0,t),n.values.length},e.prototype.reverse=function(){var t=this.slice();return t.reverse.apply(t,arguments)},e.prototype.sort=function(t){var e=this.slice();return e.sort.apply(e,arguments)},e.prototype.remove=function(t){var e=this.$mobx.dehanceValues(this.$mobx.values).indexOf(t);return e>-1&&(this.splice(e,1),!0)},e.prototype.move=function(t,e){function n(t){if(t<0)throw new Error("[mobx.array] Index out of bounds: "+t+" is negative");var e=this.$mobx.values.length;if(t>=e)throw new Error("[mobx.array] Index out of bounds: "+t+" is not smaller than "+e)}if(n.call(this,t),n.call(this,e),t!==e){var r,i=this.$mobx.values;r=t<e?i.slice(0,t).concat(i.slice(t+1,e+1),[i[t]],i.slice(e+1)):i.slice(0,e).concat([i[t]],i.slice(e,t),i.slice(t+1)),this.replace(r)}},e.prototype.get=function(t){var e=this.$mobx;if(e){if(t<e.values.length)return e.atom.reportObserved(),e.dehanceValue(e.values[t]);console.warn("[mobx.array] Attempt to read an array index ("+t+") that is out of bounds ("+e.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},e.prototype.set=function(t,e){var n=this.$mobx,r=n.values;if(t<r.length){He(n.atom);var i=r[t];if(l(n)){var o=h(n,{type:"update",object:this,index:t,newValue:e});if(!o)return;e=o.newValue}(e=n.enhancer(e,i))!==i&&(r[t]=e,n.notifyArrayChildUpdate(t,e,i))}else{if(t!==r.length)throw new Error("[mobx.array] Index out of bounds, "+t+" is larger than "+r.length);n.spliceWithArray(t,0,[e])}},e}(R);T(D.prototype,(function(){return w(this.slice())})),Object.defineProperty(D.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(t){this.$mobx.setArrayLength(t)}}),["every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toString","toLocaleString"].forEach((function(t){var e=Array.prototype[t];Qt("function"==typeof e,"Base function not defined on Array prototype: '"+t+"'"),he(D.prototype,t,(function(){return e.apply(this.peek(),arguments)}))})),function(t,e){for(var n=0;n<e.length;n++)he(t,e[n],t[e[n]])}(D.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var O=k(0);function k(t){return{enumerable:!1,configurable:!1,get:function(){return this.get(t)},set:function(e){this.set(t,e)}}}function I(t){Object.defineProperty(D.prototype,""+t,k(t))}function L(t){for(var e=C;e<t;e++)I(e);C=t}L(1e3);var M=ve("ObservableArrayAdministration",P);function N(t){return ae(t)&&M(t.$mobx)}var j={},U=function(t){function e(e,n,r,i){void 0===r&&(r="ObservableValue@"+Kt()),void 0===i&&(i=!0);var o=t.call(this,r)||this;return o.enhancer=n,o.hasUnreportedChange=!1,o.dehancer=void 0,o.value=n(e,void 0,r),i&&v()&&g({type:"create",object:o,newValue:o.value}),o}return o(e,t),e.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},e.prototype.set=function(t){var e=this.value;if((t=this.prepareNewValue(t))!==j){var n=v();n&&y({type:"update",object:this,newValue:t,oldValue:e}),this.setNewValue(t),n&&_()}},e.prototype.prepareNewValue=function(t){if(He(this),l(this)){var e=h(this,{object:this,type:"update",newValue:t});if(!e)return j;t=e.newValue}return t=this.enhancer(t,this.value,this.name),this.value!==t?t:j},e.prototype.setNewValue=function(t){var e=this.value;this.value=t,this.reportChanged(),f(this)&&p(this,{type:"update",object:this,newValue:t,oldValue:e})},e.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},e.prototype.intercept=function(t){return c(this,t)},e.prototype.observe=function(t,e){return e&&t({object:this,type:"update",newValue:this.value,oldValue:void 0}),d(this,t)},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.value+"]"},e.prototype.valueOf=function(){return me(this.get())},e}(a);U.prototype[ye()]=U.prototype.valueOf;var F=ve("ObservableValue",U),z={m001:"It is not allowed to assign new values to @action fields",m002:"`runInAction` expects a function",m003:"`runInAction` expects a function without arguments",m004:"autorun expects a function",m005:"Warning: attempted to pass an action to autorun. Actions are untracked and will not trigger on state changes. Use `reaction` or wrap only your state modification code in an action.",m006:"Warning: attempted to pass an action to autorunAsync. Actions are untracked and will not trigger on state changes. Use `reaction` or wrap only your state modification code in an action.",m007:"reaction only accepts 2 or 3 arguments. If migrating from MobX 2, please provide an options object",m008:"wrapping reaction expression in `asReference` is no longer supported, use options object instead",m009:"@computed can only be used on getter functions, like: '@computed get myProps() { return ...; }'. It looks like it was used on a property.",m010:"@computed can only be used on getter functions, like: '@computed get myProps() { return ...; }'",m011:"First argument to `computed` should be an expression. If using computed as decorator, don't pass it arguments",m012:"computed takes one or two arguments if used as function",m013:"[mobx.expr] 'expr' should only be used inside other reactive functions.",m014:"extendObservable expected 2 or more arguments",m015:"extendObservable expects an object as first argument",m016:"extendObservable should not be used on maps, use map.merge instead",m017:"all arguments of extendObservable should be objects",m018:"extending an object with another observable (object) is not supported. Please construct an explicit propertymap, using `toJS` if need. See issue #540",m019:"[mobx.isObservable] isObservable(object, propertyName) is not supported for arrays and maps. Use map.has or array.length instead.",m020:"modifiers can only be used for individual object properties",m021:"observable expects zero or one arguments",m022:"@observable can not be used on getters, use @computed instead",m024:"whyRun() can only be used if a derivation is active, or by passing an computed value / reaction explicitly. If you invoked whyRun from inside a computation; the computation is currently suspended but re-evaluating because somebody requested its value.",m025:"whyRun can only be used on reactions and computed values",m026:"`action` can only be invoked on functions",m028:"It is not allowed to set `useStrict` when a derivation is running",m029:"INTERNAL ERROR only onBecomeUnobserved shouldn't be called twice in a row",m030a:"Since strict-mode is enabled, changing observed observable values outside actions is not allowed. Please wrap the code in an `action` if this change is intended. Tried to modify: ",m030b:"Side effects like changing state are not allowed at this point. Are you trying to modify state from, for example, the render function of a React component? Tried to modify: ",m031:"Computed values are not allowed to cause side effects by changing observables that are already being observed. Tried to modify: ",m032:"* This computation is suspended (not in use by any reaction) and won't run automatically.\n\tDidn't expect this computation to be suspended at this point?\n\t  1. Make sure this computation is used by a reaction (reaction, autorun, observer).\n\t  2. Check whether you are using this computation synchronously (in the same stack as they reaction that needs it).",m033:"`observe` doesn't support the fire immediately property for observable maps.",m034:"`mobx.map` is deprecated, use `new ObservableMap` or `mobx.observable.map` instead",m035:"Cannot make the designated object observable; it is not extensible",m036:"It is not possible to get index atoms from arrays",m037:'Hi there! I\'m sorry you have just run into an exception.\nIf your debugger ends up here, know that some reaction (like the render() of an observer component, autorun or reaction)\nthrew an exception and that mobx caught it, to avoid that it brings the rest of your application down.\nThe original cause of the exception (the code that caused this reaction to run (again)), is still in the stack.\n\nHowever, more interesting is the actual stack trace of the error itself.\nHopefully the error is an instanceof Error, because in that case you can inspect the original stack of the error from where it was thrown.\nSee `error.stack` property, or press the very subtle "(...)" link you see near the console.error message that probably brought you here.\nThat stack is more interesting than the stack of this console.error itself.\n\nIf the exception you see is an exception you created yourself, make sure to use `throw new Error("Oops")` instead of `throw "Oops"`,\nbecause the javascript environment will only preserve the original stack trace in the first form.\n\nYou can also make sure the debugger pauses the next time this very same exception is thrown by enabling "Pause on caught exception".\n(Note that it might pause on many other, unrelated exception as well).\n\nIf that all doesn\'t help you out, feel free to open an issue https://github.com/mobxjs/mobx/issues!\n',m038:"Missing items in this list?\n    1. Check whether all used values are properly marked as observable (use isObservable to verify)\n    2. Make sure you didn't dereference values too early. MobX observes props, not primitives. E.g: use 'person.name' instead of 'name' in your computation.\n"};function B(t){return z[t]}function V(t,e){Qt("function"==typeof e,B("m026")),Qt("string"==typeof t&&t.length>0,"actions should have valid names, got: '"+t+"'");var n=function(){return G(t,e,this,arguments)};return n.originalFn=e,n.isMobxAction=!0,n}function G(t,e,n,r){var i=function(t,e,n,r){var i=v()&&!!t,o=0;if(i){o=Date.now();var a=r&&r.length||0,s=new Array(a);if(a>0)for(var u=0;u<a;u++)s[u]=r[u];y({type:"action",name:t,fn:e,object:n,arguments:s})}var l=Ke();return Ue(),{prevDerivation:l,prevAllowStateChanges:X(!0),notifySpy:i,startTime:o}}(t,e,n,r);try{return e.apply(n,r)}finally{!function(t){$(t.prevAllowStateChanges),Fe(),Je(t.prevDerivation),t.notifySpy&&_({time:Date.now()-t.startTime})}(i)}}function W(t){Qt(null===Te.trackingDerivation,B("m028")),Te.strictMode=t,Te.allowStateChanges=!t}function X(t){var e=Te.allowStateChanges;return Te.allowStateChanges=t,e}function $(t){Te.allowStateChanges=t}function H(t,e,n,r,i){function o(o,a,s,u,l){if(void 0===l&&(l=0),Qt(i||Z(arguments),"This function is a decorator, but it wasn't invoked like a decorator"),s){ce(o,"__mobxLazyInitializers")||he(o,"__mobxLazyInitializers",o.__mobxLazyInitializers&&o.__mobxLazyInitializers.slice()||[]);var c=s.value,h=s.initializer;return o.__mobxLazyInitializers.push((function(e){t(e,a,h?h.call(e):c,u,s)})),{enumerable:r,configurable:!0,get:function(){return!0!==this.__mobxDidRunLazyInitializers&&q(this),e.call(this,a)},set:function(t){!0!==this.__mobxDidRunLazyInitializers&&q(this),n.call(this,a,t)}}}var f={enumerable:r,configurable:!0,get:function(){return this.__mobxInitializedProps&&!0===this.__mobxInitializedProps[a]||Y(this,a,void 0,t,u,s),e.call(this,a)},set:function(e){this.__mobxInitializedProps&&!0===this.__mobxInitializedProps[a]?n.call(this,a,e):Y(this,a,e,t,u,s)}};return(arguments.length<3||5===arguments.length&&l<3)&&Object.defineProperty(o,a,f),f}return i?function(){if(Z(arguments))return o.apply(null,arguments);var t=arguments,e=arguments.length;return function(n,r,i){return o(n,r,i,t,e)}}:o}function Y(t,e,n,r,i,o){ce(t,"__mobxInitializedProps")||he(t,"__mobxInitializedProps",{}),t.__mobxInitializedProps[e]=!0,r(t,e,n,i,o)}function q(t){!0!==t.__mobxDidRunLazyInitializers&&t.__mobxLazyInitializers&&(he(t,"__mobxDidRunLazyInitializers",!0),t.__mobxDidRunLazyInitializers&&t.__mobxLazyInitializers.forEach((function(e){return e(t)})))}function Z(t){return(2===t.length||3===t.length)&&"string"==typeof t[1]}var K=H((function(t,e,n,r,i){var o=r&&1===r.length?r[0]:n.name||e||"<unnamed action>";he(t,e,Q(o,n))}),(function(t){return this[t]}),(function(){Qt(!1,B("m001"))}),!1,!0),J=H((function(t,e,n){nt(t,e,n)}),(function(t){return this[t]}),(function(){Qt(!1,B("m001"))}),!1,!1),Q=function(t,e,n,r){return 1===arguments.length&&"function"==typeof t?V(t.name||"<unnamed action>",t):2===arguments.length&&"function"==typeof e?V(t,e):1===arguments.length&&"string"==typeof t?tt(t):tt(e).apply(null,arguments)};function tt(t){return function(e,n,r){if(r&&"function"==typeof r.value)return r.value=V(t,r.value),r.enumerable=!1,r.configurable=!0,r;if(void 0!==r&&void 0!==r.get)throw new Error("[mobx] action is not expected to be used with getters");return K(t).apply(this,arguments)}}function et(t){return"function"==typeof t&&!0===t.isMobxAction}function nt(t,e,n){var r=function(){return G(e,n,t,arguments)};r.isMobxAction=!0,he(t,e,r)}Q.bound=function(t,e,n){if("function"==typeof t){var r=V("<not yet bound action>",t);return r.autoBind=!0,r}return J.apply(null,arguments)};var rt=Object.prototype.toString;function it(t,e){return ot(t,e)}function ot(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"===i||"object"===i||"object"==typeof e)&&function(t,e,n,r){t=at(t),e=at(e);var i=rt.call(t);if(i!==rt.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(t)===Symbol.valueOf.call(e)}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!("function"==typeof a&&a instanceof a&&"function"==typeof s&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var u=(n=n||[]).length;u--;)if(n[u]===t)return r[u]===e;if(n.push(t),r.push(e),o){if((u=t.length)!==e.length)return!1;for(;u--;)if(!ot(t[u],e[u],n,r))return!1}else{var l,c=Object.keys(t);if(u=c.length,Object.keys(e).length!==u)return!1;for(;u--;)if(!st(e,l=c[u])||!ot(t[l],e[l],n,r))return!1}return n.pop(),r.pop(),!0}(t,e,n,r)}function at(t){return N(t)?t.peek():Yt(t)?t.entries():ge(t)?function(t){for(var e=[];;){var n=t.next();if(n.done)break;e.push(n.value)}return e}(t.entries()):t}function st(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ut(t,e){return t===e}var lt={identity:ut,structural:function(t,e){return it(t,e)},default:function(t,e){return function(t,e){return"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}(t,e)||ut(t,e)}};function ct(t,e,n){var r,i,o;"string"==typeof t?(r=t,i=e,o=n):(r=t.name||"Autorun@"+Kt(),i=t,o=e),Qt("function"==typeof i,B("m004")),Qt(!1===et(i),B("m005")),o&&(i=i.bind(o));var a=new nn(r,(function(){this.track(s)}));function s(){i(a)}return a.schedule(),a.getDisposer()}function ht(t,e,n){var r;arguments.length>3&&Jt(B("m007")),Ut(t)&&Jt(B("m008")),(r="object"==typeof n?n:{}).name=r.name||t.name||e.name||"Reaction@"+Kt(),r.fireImmediately=!0===n||!0===r.fireImmediately,r.delay=r.delay||0,r.compareStructural=r.compareStructural||r.struct||!1,e=Q(r.name,r.context?e.bind(r.context):e),r.context&&(t=t.bind(r.context));var i,o=!0,a=!1,s=r.equals?r.equals:r.compareStructural||r.struct?lt.structural:lt.default,u=new nn(r.name,(function(){o||r.delay<1?l():a||(a=!0,setTimeout((function(){a=!1,l()}),r.delay))}));function l(){if(!u.isDisposed){var n=!1;u.track((function(){var e=t(u);n=o||!s(i,e),i=e})),o&&r.fireImmediately&&e(i,u),o||!0!==n||e(i,u),o&&(o=!1)}}return u.schedule(),u.getDisposer()}var ft=function(){function t(t,e,n,r,i){this.derivation=t,this.scope=e,this.equals=n,this.dependenciesState=_e.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=_e.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+Kt(),this.value=new Ge(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=be.NONE,this.name=r||"ComputedValue@"+Kt(),i&&(this.setter=V(r+"-setter",i))}return t.prototype.onBecomeStale=function(){!function(t){if(t.lowestObserverState===_e.UP_TO_DATE){t.lowestObserverState=_e.POSSIBLY_STALE;for(var e=t.observers,n=e.length;n--;){var r=e[n];r.dependenciesState===_e.UP_TO_DATE&&(r.dependenciesState=_e.POSSIBLY_STALE,r.isTracing!==be.NONE&&Be(r,t),r.onBecomeStale())}}}(this)},t.prototype.onBecomeUnobserved=function(){qe(this),this.value=void 0},t.prototype.get=function(){Qt(!this.isComputing,"Cycle detected in computation "+this.name,this.derivation),0===Te.inBatch?(Ue(),Xe(this)&&(this.isTracing!==be.NONE&&console.log("[mobx.trace] '"+this.name+"' is being read outside a reactive context and doing a full recompute"),this.value=this.computeValue(!1)),Fe()):(ze(this),Xe(this)&&this.trackAndCompute()&&function(t){if(t.lowestObserverState!==_e.STALE){t.lowestObserverState=_e.STALE;for(var e=t.observers,n=e.length;n--;){var r=e[n];r.dependenciesState===_e.POSSIBLY_STALE?r.dependenciesState=_e.STALE:r.dependenciesState===_e.UP_TO_DATE&&(t.lowestObserverState=_e.UP_TO_DATE)}}}(this));var t=this.value;if(We(t))throw t.cause;return t},t.prototype.peek=function(){var t=this.computeValue(!1);if(We(t))throw t.cause;return t},t.prototype.set=function(t){if(this.setter){Qt(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else Qt(!1,"[ComputedValue '"+this.name+"'] It is not possible to assign a new value to a computed value.")},t.prototype.trackAndCompute=function(){v()&&g({object:this.scope,type:"compute",fn:this.derivation});var t=this.value,e=this.dependenciesState===_e.NOT_TRACKING,n=this.value=this.computeValue(!0);return e||We(t)||We(n)||!this.equals(t,n)},t.prototype.computeValue=function(t){var e;if(this.isComputing=!0,Te.computationDepth++,t)e=Ye(this,this.derivation,this.scope);else try{e=this.derivation.call(this.scope)}catch(t){e=new Ge(t)}return Te.computationDepth--,this.isComputing=!1,e},t.prototype.observe=function(t,e){var n=this,r=!0,i=void 0;return ct((function(){var o=n.get();if(!r||e){var a=Ke();t({type:"update",object:n,newValue:o,oldValue:i}),Je(a)}r=!1,i=o}))},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},t.prototype.valueOf=function(){return me(this.get())},t.prototype.whyRun=function(){var t=Boolean(Te.trackingDerivation),e=ie(this.isComputing?this.newObserving:this.observing).map((function(t){return t.name})),n=ie(Le(this).map((function(t){return t.name})));return"\nWhyRun? computation '"+this.name+"':\n * Running because: "+(t?"[active] the value of this computation is needed by a reaction":this.isComputing?"[get] The value of this computed was requested outside a reaction":"[idle] not running at the moment")+"\n"+(this.dependenciesState===_e.NOT_TRACKING?B("m032"):" * This computation will re-run if any of the following observables changes:\n    "+oe(e)+"\n    "+(this.isComputing&&t?" (... or any observable accessed during the remainder of the current run)":"")+"\n    "+B("m038")+"\n\n  * If the outcome of this computation changes, the following observers will be re-run:\n    "+oe(n)+"\n")},t}();ft.prototype[ye()]=ft.prototype.valueOf;var dt=ve("ComputedValue",ft),pt=function(){function t(t,e){this.target=t,this.name=e,this.values={},this.changeListeners=null,this.interceptors=null}return t.prototype.observe=function(t,e){return Qt(!0!==e,"`observe` doesn't support the fire immediately property for observable objects."),d(this,t)},t.prototype.intercept=function(t){return c(this,t)},t}();function vt(t,e){if(St(t)&&t.hasOwnProperty("$mobx"))return t.$mobx;Qt(Object.isExtensible(t),B("m035")),se(t)||(e=(t.constructor.name||"ObservableObject")+"@"+Kt()),e||(e="ObservableObject@"+Kt());var n=new pt(t,e);return fe(t,"$mobx",n),n}function gt(t,e,n,r){if(t.values[e]&&!dt(t.values[e]))return Qt("value"in n,"The property "+e+" in "+t.name+" is already observable, cannot redefine it as computed property"),void(t.target[e]=n.value);if("value"in n)if(Ut(n.value)){var i=n.value;yt(t,e,i.initialValue,i.enhancer)}else et(n.value)&&!0===n.value.autoBind?nt(t.target,e,n.value.originalFn):dt(n.value)?function(t,e,n){var r=t.name+"."+e;n.name=r,n.scope||(n.scope=t.target),t.values[e]=n,Object.defineProperty(t.target,e,xt(e))}(t,e,n.value):yt(t,e,n.value,r);else mt(t,e,n.get,n.set,lt.default,!0)}function yt(t,e,n,r){if(pe(t.target,e),l(t)){var i=h(t,{object:t.target,name:e,type:"add",newValue:n});if(!i)return;n=i.newValue}n=(t.values[e]=new U(n,r,t.name+"."+e,!1)).value,Object.defineProperty(t.target,e,function(t){return _t[t]||(_t[t]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.values[t].get()},set:function(e){wt(this,t,e)}})}(e)),function(t,e,n,r){var i=f(t),o=v(),a=i||o?{type:"add",object:e,name:n,newValue:r}:null;o&&y(a),i&&p(t,a),o&&_()}(t,t.target,e,n)}function mt(t,e,n,r,i,o){o&&pe(t.target,e),t.values[e]=new ft(n,t.target,i,t.name+"."+e,r),o&&Object.defineProperty(t.target,e,xt(e))}var _t={},bt={};function xt(t){return bt[t]||(bt[t]={configurable:!0,enumerable:!1,get:function(){return this.$mobx.values[t].get()},set:function(e){return this.$mobx.values[t].set(e)}})}function wt(t,e,n){var r=t.$mobx,i=r.values[e];if(l(r)){if(!(s=h(r,{type:"update",object:t,name:e,newValue:n})))return;n=s.newValue}if((n=i.prepareNewValue(n))!==j){var o=f(r),a=v(),s=o||a?{type:"update",object:t,oldValue:i.value,name:e,newValue:n}:null;a&&y(s),i.setNewValue(n),o&&p(r,s),a&&_()}}var Tt=ve("ObservableObjectAdministration",pt);function St(t){return!!ae(t)&&(q(t),Tt(t.$mobx))}function At(t,e){if(null==t)return!1;if(void 0!==e){if(N(t)||Yt(t))throw new Error(B("m019"));if(St(t)){var n=t.$mobx;return n.values&&!!n.values[e]}return!1}return St(t)||!!t.$mobx||u(t)||un(t)||dt(t)}function Et(t){return Qt(!!t,":("),H((function(e,n,r,i,o){pe(e,n),Qt(!o||!o.get,B("m022")),yt(vt(e,void 0),n,r,t)}),(function(t){var e=this.$mobx.values[t];if(void 0!==e)return e.get()}),(function(t,e){wt(this,t,e)}),!0,!1)}function Ct(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Pt(t,zt,e)}function Rt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Pt(t,Vt,e)}function Pt(t,e,n){Qt(arguments.length>=2,B("m014")),Qt("object"==typeof t,B("m015")),Qt(!Yt(t),B("m016")),n.forEach((function(t){Qt("object"==typeof t,B("m017")),Qt(!At(t),B("m018"))}));for(var r=vt(t),i={},o=n.length-1;o>=0;o--){var a=n[o];for(var s in a)if(!0!==i[s]&&ce(a,s)){if(i[s]=!0,t===a&&!de(t,s))continue;var u=Object.getOwnPropertyDescriptor(a,s);gt(r,s,u,e)}}return t}var Dt=Et(zt),Ot=Et(Bt),kt=Et(Vt),It=Et(Gt),Lt=Et(Wt),Mt={box:function(t,e){return arguments.length>2&&jt("box"),new U(t,zt,e)},shallowBox:function(t,e){return arguments.length>2&&jt("shallowBox"),new U(t,Vt,e)},array:function(t,e){return arguments.length>2&&jt("array"),new D(t,zt,e)},shallowArray:function(t,e){return arguments.length>2&&jt("shallowArray"),new D(t,Vt,e)},map:function(t,e){return arguments.length>2&&jt("map"),new Ht(t,zt,e)},shallowMap:function(t,e){return arguments.length>2&&jt("shallowMap"),new Ht(t,Vt,e)},object:function(t,e){arguments.length>2&&jt("object");var n={};return vt(n,e),Ct(n,t),n},shallowObject:function(t,e){arguments.length>2&&jt("shallowObject");var n={};return vt(n,e),Rt(n,t),n},ref:function(){return arguments.length<2?Ft(Vt,arguments[0]):kt.apply(null,arguments)},shallow:function(){return arguments.length<2?Ft(Bt,arguments[0]):Ot.apply(null,arguments)},deep:function(){return arguments.length<2?Ft(zt,arguments[0]):Dt.apply(null,arguments)},struct:function(){return arguments.length<2?Ft(Gt,arguments[0]):It.apply(null,arguments)}},Nt=function(t){if(void 0===t&&(t=void 0),"string"==typeof arguments[1])return Dt.apply(null,arguments);if(Qt(arguments.length<=1,B("m021")),Qt(!Ut(t),B("m020")),At(t))return t;var e=zt(t,0,void 0);return e!==t?e:Nt.box(t)};function jt(t){Jt("Expected one or two arguments to observable."+t+". Did you accidentally try to use observable."+t+" as decorator?")}function Ut(t){return"object"==typeof t&&null!==t&&!0===t.isMobxModifierDescriptor}function Ft(t,e){return Qt(!Ut(e),"Modifiers cannot be nested"),{isMobxModifierDescriptor:!0,initialValue:e,enhancer:t}}function zt(t,e,n){return Ut(t)&&Jt("You tried to assign a modifier wrapped value to a collection, please define modifiers when creating the collection, not when modifying it"),At(t)?t:Array.isArray(t)?Nt.array(t,n):se(t)?Nt.object(t,n):ge(t)?Nt.map(t,n):t}function Bt(t,e,n){return Ut(t)&&Jt("You tried to assign a modifier wrapped value to a collection, please define modifiers when creating the collection, not when modifying it"),null==t||St(t)||N(t)||Yt(t)?t:Array.isArray(t)?Nt.shallowArray(t,n):se(t)?Nt.shallowObject(t,n):ge(t)?Nt.shallowMap(t,n):Jt("The shallow modifier / decorator can only used in combination with arrays, objects and maps")}function Vt(t){return t}function Gt(t,e,n){if(it(t,e))return e;if(At(t))return t;if(Array.isArray(t))return new D(t,Gt,n);if(ge(t))return new Ht(t,Gt,n);if(se(t)){var r={};return vt(r,n),Pt(r,Gt,[t]),r}return t}function Wt(t,e,n){return it(t,e)?e:t}function Xt(t,e){void 0===e&&(e=void 0),Ue();try{return t.apply(e)}finally{Fe()}}Object.keys(Mt).forEach((function(t){return Nt[t]=Mt[t]})),Nt.deep.struct=Nt.struct,Nt.ref.struct=function(){return arguments.length<2?Ft(Wt,arguments[0]):Lt.apply(null,arguments)};var $t={},Ht=function(){function t(t,e,n){void 0===e&&(e=zt),void 0===n&&(n="ObservableMap@"+Kt()),this.enhancer=e,this.name=n,this.$mobx=$t,this._data=Object.create(null),this._hasMap=Object.create(null),this._keys=new D(void 0,Vt,this.name+".keys()",!0),this.interceptors=null,this.changeListeners=null,this.dehancer=void 0,this.merge(t)}return t.prototype._has=function(t){return void 0!==this._data[t]},t.prototype.has=function(t){return!!this.isValidKey(t)&&(t=""+t,this._hasMap[t]?this._hasMap[t].get():this._updateHasMapEntry(t,!1).get())},t.prototype.set=function(t,e){this.assertValidKey(t),t=""+t;var n=this._has(t);if(l(this)){var r=h(this,{type:n?"update":"add",object:this,newValue:e,name:t});if(!r)return this;e=r.newValue}return n?this._updateValue(t,e):this._addValue(t,e),this},t.prototype.delete=function(t){var e=this;if(this.assertValidKey(t),t=""+t,l(this)&&!(i=h(this,{type:"delete",object:this,name:t})))return!1;if(this._has(t)){var n=v(),r=f(this),i=r||n?{type:"delete",object:this,oldValue:this._data[t].value,name:t}:null;return n&&y(i),Xt((function(){e._keys.remove(t),e._updateHasMapEntry(t,!1),e._data[t].setNewValue(void 0),e._data[t]=void 0})),r&&p(this,i),n&&_(),!0}return!1},t.prototype._updateHasMapEntry=function(t,e){var n=this._hasMap[t];return n?n.setNewValue(e):n=this._hasMap[t]=new U(e,Vt,this.name+"."+t+"?",!1),n},t.prototype._updateValue=function(t,e){var n=this._data[t];if((e=n.prepareNewValue(e))!==j){var r=v(),i=f(this),o=i||r?{type:"update",object:this,oldValue:n.value,name:t,newValue:e}:null;r&&y(o),n.setNewValue(e),i&&p(this,o),r&&_()}},t.prototype._addValue=function(t,e){var n=this;Xt((function(){var r=n._data[t]=new U(e,n.enhancer,n.name+"."+t,!1);e=r.value,n._updateHasMapEntry(t,!0),n._keys.push(t)}));var r=v(),i=f(this),o=i||r?{type:"add",object:this,name:t,newValue:e}:null;r&&y(o),i&&p(this,o),r&&_()},t.prototype.get=function(t){return t=""+t,this.has(t)?this.dehanceValue(this._data[t].get()):this.dehanceValue(void 0)},t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.keys=function(){return w(this._keys.slice())},t.prototype.values=function(){return w(this._keys.map(this.get,this))},t.prototype.entries=function(){var t=this;return w(this._keys.map((function(e){return[e,t.get(e)]})))},t.prototype.forEach=function(t,e){var n=this;this.keys().forEach((function(r){return t.call(e,n.get(r),r,n)}))},t.prototype.merge=function(t){var e=this;return Yt(t)&&(t=t.toJS()),Xt((function(){se(t)?Object.keys(t).forEach((function(n){return e.set(n,t[n])})):Array.isArray(t)?t.forEach((function(t){var n=t[0],r=t[1];return e.set(n,r)})):ge(t)?t.forEach((function(t,n){return e.set(n,t)})):null!=t&&Jt("Cannot initialize map from "+t)})),this},t.prototype.clear=function(){var t=this;Xt((function(){Ze((function(){t.keys().forEach(t.delete,t)}))}))},t.prototype.replace=function(t){var e=this;return Xt((function(){var n,r=se(n=t)?Object.keys(n):Array.isArray(n)?n.map((function(t){return t[0]})):ge(n)?Array.from(n.keys()):Yt(n)?n.keys():Jt("Cannot get keys from "+n);e.keys().filter((function(t){return-1===r.indexOf(t)})).forEach((function(t){return e.delete(t)})),e.merge(t)})),this},Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.toJS=function(){var t=this,e={};return this.keys().forEach((function(n){return e[n]=t.get(n)})),e},t.prototype.toJSON=function(){return this.toJS()},t.prototype.isValidKey=function(t){return null!=t&&("string"==typeof t||"number"==typeof t||"boolean"==typeof t)},t.prototype.assertValidKey=function(t){if(!this.isValidKey(t))throw new Error("[mobx.map] Invalid key: '"+t+"', only strings, numbers and booleans are accepted as key in observable maps.")},t.prototype.toString=function(){var t=this;return this.name+"[{ "+this.keys().map((function(e){return e+": "+t.get(e)})).join(", ")+" }]"},t.prototype.observe=function(t,e){return Qt(!0!==e,B("m033")),d(this,t)},t.prototype.intercept=function(t){return c(this,t)},t}();T(Ht.prototype,(function(){return this.entries()}));var Yt=ve("ObservableMap",Ht),qt=[];function Zt(){return"undefined"!=typeof window?window:r.g}function Kt(){return++Te.mobxGuid}function Jt(t,e){throw Qt(!1,t,e),"X"}function Qt(t,e,n){if(!t)throw new Error("[mobx] Invariant failed: "+e+(n?" in '"+n+"'":""))}Object.freeze(qt);var te=[];function ee(t){return-1===te.indexOf(t)&&(te.push(t),console.error("[mobx] Deprecated: "+t),!0)}function ne(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}var re=function(){};function ie(t){var e=[];return t.forEach((function(t){-1===e.indexOf(t)&&e.push(t)})),e}function oe(t,e,n){return void 0===e&&(e=100),void 0===n&&(n=" - "),t?t.slice(0,e).join(n)+(t.length>e?" (... and "+(t.length-e)+"more)":""):""}function ae(t){return null!==t&&"object"==typeof t}function se(t){if(null===t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}function ue(){for(var t=arguments[0],e=1,n=arguments.length;e<n;e++){var r=arguments[e];for(var i in r)ce(r,i)&&(t[i]=r[i])}return t}var le=Object.prototype.hasOwnProperty;function ce(t,e){return le.call(t,e)}function he(t,e,n){Object.defineProperty(t,e,{enumerable:!1,writable:!0,configurable:!0,value:n})}function fe(t,e,n){Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!0,value:n})}function de(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!n||!1!==n.configurable&&!1!==n.writable}function pe(t,e){Qt(de(t,e),"Cannot make property '"+e+"' observable, it is not configurable and writable in the target object")}function ve(t,e){var n="isMobX"+t;return e.prototype[n]=!0,function(t){return ae(t)&&!0===t[n]}}function ge(t){return void 0!==Zt().Map&&t instanceof Zt().Map}function ye(){return"function"==typeof Symbol&&Symbol.toPrimitive||"@@toPrimitive"}function me(t){return null===t?null:"object"==typeof t?""+t:t}var _e,be,xe=["mobxGuid","resetId","spyListeners","strictMode","runId"],we=function(){this.version=5,this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.strictMode=!1,this.resetId=0,this.spyListeners=[],this.globalReactionErrorHandlers=[]},Te=new we,Se=!1,Ae=!1,Ee=!1,Ce=Zt();function Re(t,e){if("object"==typeof t&&null!==t){if(N(t))return Qt(void 0===e,B("m036")),t.$mobx.atom;if(Yt(t)){var n=t;return void 0===e?Re(n._keys):(Qt(!!(r=n._data[e]||n._hasMap[e]),"the entry '"+e+"' does not exist in the observable map '"+De(t)+"'"),r)}var r;if(q(t),e&&!t.$mobx&&t[e],St(t))return e?(Qt(!!(r=t.$mobx.values[e]),"no observable property '"+e+"' found on the observable object '"+De(t)+"'"),r):Jt("please specify a property");if(u(t)||dt(t)||un(t))return t}else if("function"==typeof t&&un(t.$mobx))return t.$mobx;return Jt("Cannot obtain atom from "+t)}function Pe(t,e){return Qt(t,"Expecting some object"),void 0!==e?Pe(Re(t,e)):u(t)||dt(t)||un(t)||Yt(t)?t:(q(t),t.$mobx?t.$mobx:void Qt(!1,"Cannot obtain administration from "+t))}function De(t,e){return(void 0!==e?Re(t,e):St(t)||Yt(t)?Pe(t):Re(t)).name}function Oe(t,e){return ke(Re(t,e))}function ke(t){var e={name:t.name};return t.observing&&t.observing.length>0&&(e.dependencies=ie(t.observing).map(ke)),e}function Ie(t){var e={name:t.name};return function(t){return t.observers&&t.observers.length>0}(t)&&(e.observers=Le(t).map(Ie)),e}function Le(t){return t.observers}function Me(t,e){var n=t.observers.length;n&&(t.observersIndexes[e.__mapid]=n),t.observers[n]=e,t.lowestObserverState>e.dependenciesState&&(t.lowestObserverState=e.dependenciesState)}function Ne(t,e){if(1===t.observers.length)t.observers.length=0,je(t);else{var n=t.observers,r=t.observersIndexes,i=n.pop();if(i!==e){var o=r[e.__mapid]||0;o?r[i.__mapid]=o:delete r[i.__mapid],n[o]=i}delete r[e.__mapid]}}function je(t){t.isPendingUnobservation||(t.isPendingUnobservation=!0,Te.pendingUnobservations.push(t))}function Ue(){Te.inBatch++}function Fe(){if(0==--Te.inBatch){an();for(var t=Te.pendingUnobservations,e=0;e<t.length;e++){var n=t[e];n.isPendingUnobservation=!1,0===n.observers.length&&n.onBecomeUnobserved()}Te.pendingUnobservations=[]}}function ze(t){var e=Te.trackingDerivation;null!==e?e.runId!==t.lastAccessedBy&&(t.lastAccessedBy=e.runId,e.newObserving[e.unboundDepsCount++]=t):0===t.observers.length&&je(t)}function Be(t,e){if(console.log("[mobx.trace] '"+t.name+"' is invalidated due to a change in: '"+e.name+"'"),t.isTracing===be.BREAK){var n=[];Ve(Oe(t),n,1),new Function("debugger;\n/*\nTracing '"+t.name+"'\n\nYou are entering this break point because derivation '"+t.name+"' is being traced and '"+e.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(t instanceof ft?t.derivation.toString():"")+"\n\nThe dependencies for this derivation are:\n\n"+n.join("\n")+"\n*/\n    ")()}}function Ve(t,e,n){e.length>=1e3?e.push("(and many more)"):(e.push(""+new Array(n).join("\t")+t.name),t.dependencies&&t.dependencies.forEach((function(t){return Ve(t,e,n+1)})))}Ce.__mobxInstanceCount?(Ce.__mobxInstanceCount++,setTimeout((function(){Se||Ae||Ee||(Ee=!0,console.warn("[mobx] Warning: there are multiple mobx instances active. This might lead to unexpected results. See https://github.com/mobxjs/mobx/issues/1082 for details."))}),1)):Ce.__mobxInstanceCount=1,function(t){t[t.NOT_TRACKING=-1]="NOT_TRACKING",t[t.UP_TO_DATE=0]="UP_TO_DATE",t[t.POSSIBLY_STALE=1]="POSSIBLY_STALE",t[t.STALE=2]="STALE"}(_e||(_e={})),function(t){t[t.NONE=0]="NONE",t[t.LOG=1]="LOG",t[t.BREAK=2]="BREAK"}(be||(be={}));var Ge=function(t){this.cause=t};function We(t){return t instanceof Ge}function Xe(t){switch(t.dependenciesState){case _e.UP_TO_DATE:return!1;case _e.NOT_TRACKING:case _e.STALE:return!0;case _e.POSSIBLY_STALE:for(var e=Ke(),n=t.observing,r=n.length,i=0;i<r;i++){var o=n[i];if(dt(o)){try{o.get()}catch(t){return Je(e),!0}if(t.dependenciesState===_e.STALE)return Je(e),!0}}return Qe(t),Je(e),!1}}function $e(){return null!==Te.trackingDerivation}function He(t){var e=t.observers.length>0;Te.computationDepth>0&&e&&Jt(B("m031")+t.name),!Te.allowStateChanges&&e&&Jt(B(Te.strictMode?"m030a":"m030b")+t.name)}function Ye(t,e,n){Qe(t),t.newObserving=new Array(t.observing.length+100),t.unboundDepsCount=0,t.runId=++Te.runId;var r,i=Te.trackingDerivation;Te.trackingDerivation=t;try{r=e.call(n)}catch(t){r=new Ge(t)}return Te.trackingDerivation=i,function(t){for(var e=t.observing,n=t.observing=t.newObserving,r=_e.UP_TO_DATE,i=0,o=t.unboundDepsCount,a=0;a<o;a++)0===(s=n[a]).diffValue&&(s.diffValue=1,i!==a&&(n[i]=s),i++),s.dependenciesState>r&&(r=s.dependenciesState);for(n.length=i,t.newObserving=null,o=e.length;o--;)0===(s=e[o]).diffValue&&Ne(s,t),s.diffValue=0;for(;i--;){var s;1===(s=n[i]).diffValue&&(s.diffValue=0,Me(s,t))}r!==_e.UP_TO_DATE&&(t.dependenciesState=r,t.onBecomeStale())}(t),r}function qe(t){var e=t.observing;t.observing=[];for(var n=e.length;n--;)Ne(e[n],t);t.dependenciesState=_e.NOT_TRACKING}function Ze(t){var e=Ke(),n=t();return Je(e),n}function Ke(){var t=Te.trackingDerivation;return Te.trackingDerivation=null,t}function Je(t){Te.trackingDerivation=t}function Qe(t){if(t.dependenciesState!==_e.UP_TO_DATE){t.dependenciesState=_e.UP_TO_DATE;for(var e=t.observing,n=e.length;n--;)e[n].lowestObserverState=_e.UP_TO_DATE}}function tn(t){return console.log(t),t}function en(t){switch(t.length){case 0:return Te.trackingDerivation;case 1:return Re(t[0]);case 2:return Re(t[0],t[1])}}var nn=function(){function t(t,e){void 0===t&&(t="Reaction@"+Kt()),this.name=t,this.onInvalidate=e,this.observing=[],this.newObserving=[],this.dependenciesState=_e.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+Kt(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=be.NONE}return t.prototype.onBecomeStale=function(){this.schedule()},t.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,Te.pendingReactions.push(this),an())},t.prototype.isScheduled=function(){return this._isScheduled},t.prototype.runReaction=function(){this.isDisposed||(Ue(),this._isScheduled=!1,Xe(this)&&(this._isTrackPending=!0,this.onInvalidate(),this._isTrackPending&&v()&&g({object:this,type:"scheduled-reaction"})),Fe())},t.prototype.track=function(t){Ue();var e,n=v();n&&(e=Date.now(),y({object:this,type:"reaction",fn:t})),this._isRunning=!0;var r=Ye(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&qe(this),We(r)&&this.reportExceptionInDerivation(r.cause),n&&_({time:Date.now()-e}),Fe()},t.prototype.reportExceptionInDerivation=function(t){var e=this;if(this.errorHandler)this.errorHandler(t,this);else{var n="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this,r=B("m037");console.error(n||r,t),v()&&g({type:"error",message:n,error:t,object:this}),Te.globalReactionErrorHandlers.forEach((function(n){return n(t,e)}))}},t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(Ue(),qe(this),Fe()))},t.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t.$mobx=this,t.onError=rn,t},t.prototype.toString=function(){return"Reaction["+this.name+"]"},t.prototype.whyRun=function(){var t=ie(this._isRunning?this.newObserving:this.observing).map((function(t){return t.name}));return"\nWhyRun? reaction '"+this.name+"':\n * Status: ["+(this.isDisposed?"stopped":this._isRunning?"running":this.isScheduled()?"scheduled":"idle")+"]\n * This reaction will re-run if any of the following observables changes:\n    "+oe(t)+"\n    "+(this._isRunning?" (... or any observable accessed during the remainder of the current run)":"")+"\n\t"+B("m038")+"\n"},t.prototype.trace=function(t){void 0===t&&(t=!1),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=!1;"boolean"==typeof t[t.length-1]&&(n=t.pop());var r=en(t);if(!r)return Jt("'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly");r.isTracing===be.NONE&&console.log("[mobx.trace] '"+r.name+"' tracing enabled"),r.isTracing=n?be.BREAK:be.LOG}(this,t)},t}();function rn(t){Qt(this&&this.$mobx&&un(this.$mobx),"Invalid `this`"),Qt(!this.$mobx.errorHandler,"Only one onErrorHandler can be registered"),this.$mobx.errorHandler=t}var on=function(t){return t()};function an(){Te.inBatch>0||Te.isRunningReactions||on(sn)}function sn(){Te.isRunningReactions=!0;for(var t=Te.pendingReactions,e=0;t.length>0;){100==++e&&(console.error("Reaction doesn't converge to a stable state after 100 iterations. Probably there is a cycle in the reactive function: "+t[0]),t.splice(0));for(var n=t.splice(0),r=0,i=n.length;r<i;r++)n[r].runReaction()}Te.isRunningReactions=!1}var un=ve("Reaction",nn);function ln(t){return H((function(e,n,r,i,o){Qt(void 0!==o,B("m009")),Qt("function"==typeof o.get,B("m010")),mt(vt(e,""),n,o.get,o.set,t,!1)}),(function(t){var e=this.$mobx.values[t];if(void 0!==e)return e.get()}),(function(t,e){this.$mobx.values[t].set(e)}),!1,!1)}var cn=ln(lt.default),hn=ln(lt.structural),fn=function(t,e,n){if("string"==typeof e)return cn.apply(null,arguments);Qt("function"==typeof t,B("m011")),Qt(arguments.length<3,B("m012"));var r="object"==typeof e?e:{};r.setter="function"==typeof e?e:r.setter;var i=r.equals?r.equals:r.compareStructural||r.struct?lt.structural:lt.default;return new ft(t,r.context,i,r.name||t.name||"",r.setter)};function dn(t,e,n){function r(r){return e&&n.push([t,r]),r}if(void 0===e&&(e=!0),void 0===n&&(n=[]),At(t)){if(e&&null===n&&(n=[]),e&&null!==t&&"object"==typeof t)for(var i=0,o=n.length;i<o;i++)if(n[i][0]===t)return n[i][1];if(N(t)){var a=r([]),s=t.map((function(t){return dn(t,e,n)}));for(a.length=s.length,i=0,o=s.length;i<o;i++)a[i]=s[i];return a}if(St(t)){for(var u in a=r({}),t)a[u]=dn(t[u],e,n);return a}if(Yt(t)){var l=r({});return t.forEach((function(t,r){return l[r]=dn(t,e,n)})),l}if(F(t))return dn(t.get(),e,n)}return t}fn.struct=hn,fn.equals=ln;var pn={allowStateChanges:function(t,e){var n,r=X(t);try{n=e()}finally{$(r)}return n},deepEqual:it,getAtom:Re,getDebugName:De,getDependencyTree:Oe,getAdministration:Pe,getGlobalState:function(){return Te},getObserverTree:function(t,e){return Ie(Re(t,e))},interceptReads:function(t,e,n){var r;if(Yt(t)||N(t)||F(t))r=Pe(t);else{if(!St(t))return Jt("Expected observable map, object or array as first array");if("string"!=typeof e)return Jt("InterceptReads can only be used with a specific property, not with an object in general");r=Pe(t,e)}return void 0!==r.dehancer?Jt("An intercept reader was already established"):(r.dehancer="function"==typeof e?e:n,function(){r.dehancer=void 0})},isComputingDerivation:$e,isSpyEnabled:v,onReactionError:function(t){return Te.globalReactionErrorHandlers.push(t),function(){var e=Te.globalReactionErrorHandlers.indexOf(t);e>=0&&Te.globalReactionErrorHandlers.splice(e,1)}},reserveArrayBuffer:L,resetGlobalState:function(){Te.resetId++;var t=new we;for(var e in t)-1===xe.indexOf(e)&&(Te[e]=t[e]);Te.allowStateChanges=!Te.strictMode},isolateGlobalState:function(){Ae=!0,Zt().__mobxInstanceCount--},shareGlobalState:function(){ee("Using `shareGlobalState` is not recommended, use peer dependencies instead. See https://github.com/mobxjs/mobx/issues/1082 for details."),Se=!0;var t=Zt(),e=Te;if(t.__mobservableTrackingStack||t.__mobservableViewStack)throw new Error("[mobx] An incompatible version of mobservable is already loaded.");if(t.__mobxGlobal&&t.__mobxGlobal.version!==e.version)throw new Error("[mobx] An incompatible version of mobx is already loaded.");t.__mobxGlobal?Te=t.__mobxGlobal:t.__mobxGlobal=e},spyReport:g,spyReportEnd:_,spyReportStart:y,setReactionScheduler:function(t){var e=on;on=function(n){return t((function(){return e(n)}))}}},vn={Reaction:nn,untracked:Ze,Atom:s,BaseAtom:a,useStrict:W,isStrictModeEnabled:function(){return Te.strictMode},spy:b,comparer:lt,asReference:function(t){return ee("asReference is deprecated, use observable.ref instead"),Nt.ref(t)},asFlat:function(t){return ee("asFlat is deprecated, use observable.shallow instead"),Nt.shallow(t)},asStructure:function(t){return ee("asStructure is deprecated. Use observable.struct, computed.struct or reaction options instead."),Nt.struct(t)},asMap:function(t){return ee("asMap is deprecated, use observable.map or observable.shallowMap instead"),Nt.map(t||{})},isModifierDescriptor:Ut,isObservableObject:St,isBoxedObservable:F,isObservableArray:N,ObservableMap:Ht,isObservableMap:Yt,map:function(t){return ee("`mobx.map` is deprecated, use `new ObservableMap` or `mobx.observable.map` instead"),Nt.map(t)},transaction:Xt,observable:Nt,computed:fn,isObservable:At,isComputed:function(t,e){if(null==t)return!1;if(void 0!==e){if(!1===St(t))return!1;if(!t.$mobx.values[e])return!1;var n=Re(t,e);return dt(n)}return dt(t)},extendObservable:Ct,extendShallowObservable:Rt,observe:function(t,e,n,r){return"function"==typeof n?function(t,e,n,r){return Pe(t,e).observe(n,r)}(t,e,n,r):function(t,e,n){return Pe(t).observe(e,n)}(t,e,n)},intercept:function(t,e,n){return"function"==typeof n?function(t,e,n){return Pe(t,e).intercept(n)}(t,e,n):function(t,e){return Pe(t).intercept(e)}(t,e)},autorun:ct,autorunAsync:function(t,e,n,r){var i,o,a,s;"string"==typeof t?(i=t,o=e,a=n,s=r):(i=t.name||"AutorunAsync@"+Kt(),o=t,a=e,s=n),Qt(!1===et(o),B("m006")),void 0===a&&(a=1),s&&(o=o.bind(s));var u=!1,l=new nn(i,(function(){u||(u=!0,setTimeout((function(){u=!1,l.isDisposed||l.track(c)}),a))}));function c(){o(l)}return l.schedule(),l.getDisposer()},when:function(t,e,n,r){var i,o,a,s;return"string"==typeof t?(i=t,o=e,a=n,s=r):(i="When@"+Kt(),o=t,a=e,s=n),ct(i,(function(t){if(o.call(s)){t.dispose();var e=Ke();a.call(s),Je(e)}}))},reaction:ht,action:Q,isAction:et,runInAction:function(t,e,n){var r="string"==typeof t?t:t.name||"<unnamed action>",i="function"==typeof t?t:e,o="function"==typeof t?e:n;return Qt("function"==typeof i,B("m002")),Qt(0===i.length,B("m003")),Qt("string"==typeof r&&r.length>0,"actions should have valid names, got: '"+r+"'"),G(r,i,o,void 0)},expr:function(t,e){return $e()||console.warn(B("m013")),fn(t,{context:e}).get()},toJS:dn,createTransformer:function(t,e){Qt("function"==typeof t&&t.length<2,"createTransformer expects a function that accepts one argument");var n={},r=Te.resetId,i=function(r){function i(e,n){var i=r.call(this,(function(){return t(n)}),void 0,lt.default,"Transformer-"+t.name+"-"+e,void 0)||this;return i.sourceIdentifier=e,i.sourceObject=n,i}return o(i,r),i.prototype.onBecomeUnobserved=function(){var t=this.value;r.prototype.onBecomeUnobserved.call(this),delete n[this.sourceIdentifier],e&&e(t,this.sourceObject)},i}(ft);return function(t){r!==Te.resetId&&(n={},r=Te.resetId);var e=function(t){if("string"==typeof t||"number"==typeof t)return t;if(null===t||"object"!=typeof t)throw new Error("[mobx] transform expected some kind of object or primitive value, got: "+t);var e=t.$transformId;return void 0===e&&he(t,"$transformId",e=Kt()),e}(t),o=n[e];return o?o.get():(o=n[e]=new i(e,t)).get()}},whyRun:function(t,e){return ee("`whyRun` is deprecated in favor of `trace`"),(t=en(arguments))?dt(t)||un(t)?tn(t.whyRun()):Jt(B("m025")):tn(B("m024"))},isArrayLike:function(t){return Array.isArray(t)||N(t)},extras:pn},gn=!1,yn=function(t){var e=vn[t];Object.defineProperty(vn,t,{get:function(){return gn||(gn=!0,console.warn("Using default export (`import mobx from 'mobx'`) is deprecated and won’t work in mobx@4.0.0\nUse `import * as mobx from 'mobx'` instead")),e}})};for(var mn in vn)yn(mn);"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:b,extras:pn});var _n=r(696),bn=r.n(_n),xn={value:()=>{}};function wn(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Tn(r)}function Tn(t){this._=t}function Sn(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function An(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function En(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=xn,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Tn.prototype=wn.prototype={constructor:Tn,on:function(t,e){var n,r=this._,i=Sn(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=En(r[n],t.name,e);else if(null==e)for(n in r)r[n]=En(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=An(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Tn(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const Cn=wn;var Rn,Pn,Dn=0,On=0,kn=0,In=0,Ln=0,Mn=0,Nn="object"==typeof performance&&performance.now?performance:Date,jn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Un(){return Ln||(jn(Fn),Ln=Nn.now()+Mn)}function Fn(){Ln=0}function zn(){this._call=this._time=this._next=null}function Bn(t,e,n){var r=new zn;return r.restart(t,e,n),r}function Vn(){Ln=(In=Nn.now())+Mn,Dn=On=0;try{!function(){Un(),++Dn;for(var t,e=Rn;e;)(t=Ln-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Dn}()}finally{Dn=0,function(){for(var t,e,n=Rn,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Rn=e);Pn=t,Wn(r)}(),Ln=0}}function Gn(){var t=Nn.now(),e=t-In;e>1e3&&(Mn-=e,In=t)}function Wn(t){Dn||(On&&(On=clearTimeout(On)),t-Ln>24?(t<1/0&&(On=setTimeout(Vn,t-Nn.now()-Mn)),kn&&(kn=clearInterval(kn))):(kn||(In=Nn.now(),kn=setInterval(Gn,1e3)),Dn=1,jn(Vn)))}zn.prototype=Bn.prototype={constructor:zn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Un():+n)+(null==e?0:+e),this._next||Pn===this||(Pn?Pn._next=this:Rn=this,Pn=this),this._call=t,this._time=n,Wn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Wn())}};const Xn=4294967296;function $n(t){return t.x}function Hn(t){return t.y}var Yn=Math.PI*(3-Math.sqrt(5));function qn(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,u,l,c,h,f,d=t._root,p={data:r},v=t._x0,g=t._y0,y=t._x1,m=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((l=e>=(o=(v+y)/2))?v=o:y=o,(c=n>=(a=(g+m)/2))?g=a:m=a,i=d,!(d=d[h=c<<1|l]))return i[h]=p,t;if(s=+t._x.call(null,d.data),u=+t._y.call(null,d.data),e===s&&n===u)return p.next=d,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(l=e>=(o=(v+y)/2))?v=o:y=o,(c=n>=(a=(g+m)/2))?g=a:m=a}while((h=c<<1|l)==(f=(u>=a)<<1|s>=o));return i[f]=d,i[h]=p,t}function Zn(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Kn(t){return t[0]}function Jn(t){return t[1]}function Qn(t,e,n){var r=new tr(null==e?Kn:e,null==n?Jn:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function tr(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function er(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var nr=Qn.prototype=tr.prototype;function rr(t){return function(){return t}}function ir(t){return 1e-6*(t()-.5)}function or(){var t,e,n,r,i,o=rr(-30),a=1,s=1/0,u=.81;function l(n){var i,o=t.length,a=Qn(t,$n,Hn).visitAfter(h);for(r=n,i=0;i<o;++i)e=t[i],a.visit(f)}function c(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function h(t){var e,n,r,o,a,s=0,u=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,r+=n*e.x,o+=n*e.y);t.x=r/u,t.y=o/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function f(t,o,l,c){if(!t.value)return!0;var h=t.x-e.x,f=t.y-e.y,d=c-o,p=h*h+f*f;if(d*d/u<p)return p<s&&(0===h&&(p+=(h=ir(n))*h),0===f&&(p+=(f=ir(n))*f),p<a&&(p=Math.sqrt(a*p)),e.vx+=h*t.value*r/p,e.vy+=f*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===h&&(p+=(h=ir(n))*h),0===f&&(p+=(f=ir(n))*f),p<a&&(p=Math.sqrt(a*p)));do{t.data!==e&&(d=i[t.data.index]*r/p,e.vx+=h*d,e.vy+=f*d)}while(t=t.next)}}return l.initialize=function(e,r){t=e,n=r,c()},l.strength=function(t){return arguments.length?(o="function"==typeof t?t:rr(+t),c(),l):o},l.distanceMin=function(t){return arguments.length?(a=t*t,l):Math.sqrt(a)},l.distanceMax=function(t){return arguments.length?(s=t*t,l):Math.sqrt(s)},l.theta=function(t){return arguments.length?(u=t*t,l):Math.sqrt(u)},l}function ar(t){return t.x+t.vx}function sr(t){return t.y+t.vy}function ur(t){return t.index}function lr(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}nr.copy=function(){var t,e,n=new tr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=er(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=er(e));return n},nr.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return qn(this.cover(e,n),e,n,t)},nr.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),u=1/0,l=1/0,c=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<u&&(u=r),r>c&&(c=r),i<l&&(l=i),i>h&&(h=i));if(u>c||l>h)return this;for(this.cover(u,l).cover(c,h),n=0;n<o;++n)qn(this,a[n],s[n],t[n]);return this},nr.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,u=i-n||1,l=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=l,l=a,u*=2,s){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},nr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},nr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},nr.find=function(t,e,n){var r,i,o,a,s,u,l,c=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],v=this._root;for(v&&p.push(new Zn(v,c,h,f,d)),null==n?n=1/0:(c=t-n,h=e-n,f=t+n,d=e+n,n*=n);u=p.pop();)if(!(!(v=u.node)||(i=u.x0)>f||(o=u.y0)>d||(a=u.x1)<c||(s=u.y1)<h))if(v.length){var g=(i+a)/2,y=(o+s)/2;p.push(new Zn(v[3],g,y,a,s),new Zn(v[2],i,y,g,s),new Zn(v[1],g,o,a,y),new Zn(v[0],i,o,g,y)),(l=(e>=y)<<1|t>=g)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=u)}else{var m=t-+this._x.call(null,v.data),_=e-+this._y.call(null,v.data),b=m*m+_*_;if(b<n){var x=Math.sqrt(n=b);c=t-x,h=e-x,f=t+x,d=e+x,r=v.data}}return r},nr.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,u,l,c,h,f,d=this._root,p=this._x0,v=this._y0,g=this._x1,y=this._y1;if(!d)return this;if(d.length)for(;;){if((l=o>=(s=(p+g)/2))?p=s:g=s,(c=a>=(u=(v+y)/2))?v=u:y=u,e=d,!(d=d[h=c<<1|l]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=i,this)},nr.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},nr.root=function(){return this._root},nr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},nr.visit=function(t){var e,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new Zn(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&u.length){var l=(r+o)/2,c=(i+a)/2;(n=u[3])&&s.push(new Zn(n,l,c,o,a)),(n=u[2])&&s.push(new Zn(n,r,c,l,a)),(n=u[1])&&s.push(new Zn(n,l,i,o,c)),(n=u[0])&&s.push(new Zn(n,r,i,l,c))}return this},nr.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Zn(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,u=e.x1,l=e.y1,c=(a+u)/2,h=(s+l)/2;(o=i[0])&&n.push(new Zn(o,a,s,c,h)),(o=i[1])&&n.push(new Zn(o,c,s,u,h)),(o=i[2])&&n.push(new Zn(o,a,h,c,l)),(o=i[3])&&n.push(new Zn(o,c,h,u,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},nr.x=function(t){return arguments.length?(this._x=t,this):this._x},nr.y=function(t){return arguments.length?(this._y=t,this):this._y};const cr=256,hr=4096,fr=25,dr="#ededed",pr={position:"absolute",top:0,bottom:0,left:0,right:0},vr=()=>window.devicePixelRatio||1;function gr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return yr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function yr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var mr=function(e){var n=new Map;return e.forEach((function(t){var e=t.id,r=t.from,i=t.to,o=t.color,a=t.width,s=t.disabled,u=[r,i].sort(),l="".concat(u[0],".").concat(u[1]),c=n.get(l);c?c&&c.bundledRels.push({id:e,color:o||void 0,disabled:s||!1,width:a||1}):n.set(l,{bundledRels:[{id:e,color:o||void 0,disabled:s||!1,width:a||1}],key:l,from:r,to:i,color:o||void 0,disabled:s||!1,width:0})})),n.forEach((function(e){var n=(0,t.uniqBy)(e.bundledRels,"disabled"),r=1===n.length&&n[0].disabled,i=1===n.length&&!n[0].disabled;if(r)e.color=dr,e.width=1;else{var o=e.bundledRels.filter((function(t){return!t.disabled})),a=(0,t.uniqBy)(o,"color");i?(e.color=a.length>1?void 0:e.bundledRels[0].color,e.bundledRels.map((function(t){e.width+=t.width}))):(e.color=1===a.length?a[0].color:void 0,e.disabled=!1,e.bundledRels.map((function(t){e.width+=t.disabled?0:t.width})))}})),Array.from(n.values())},_r=function(t,e,n,r){var i,o=new Set(t),a=gr(new Set(e));try{for(a.s();!(i=a.n()).done;){var s=i.value,u=r.idToItem[s],l=u.from,c=u.to;o.add(l),o.add(c)}}catch(t){a.e(t)}finally{a.f()}var h,f=function(t){var e,n={},r={},i=gr(t);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,a=o.from,s=o.to,u="".concat(a,"-").concat(s),l="".concat(s,"-").concat(a),c=0,h=[u,l];c<h.length;c++){var f=h[c];r[f]?r[f].push(o):r[f]=[o]}n[a]||(n[a]=new Set),n[s]||(n[s]=new Set),n[a].add(s),n[s].add(a)}}catch(t){i.e(t)}finally{i.f()}return{adjNodesMap:n,relMap:r}}(r.items),d=f.adjNodesMap,p=f.relMap,v={},g={},y=function(t){var e=[];for(v[t]||e.push(t);e.length>0;){var r=e.shift();if(v[r]=n.idToItem[r],d[r]){var i,o=gr(d[r]);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(!v[a]){e.push(a);var s=p["".concat(r,"-").concat(a)];if(s){var u,l=gr(s);try{for(l.s();!(u=l.n()).done;){var c=u.value;g[c.id]||(g[c.id]=c)}}catch(t){l.e(t)}finally{l.f()}}}}}catch(t){o.e(t)}finally{o.f()}}}},m=gr(o);try{for(m.s();!(h=m.n()).done;)y(h.value)}catch(t){m.e(t)}finally{m.f()}return{connectedNodes:v,connectedRels:g}};function br(t,e,n){const r=t.filter((t=>void 0===t.x&&void 0===t.y));r.forEach(((t,i)=>{t.x=e.x+n*Math.sin(2*Math.PI*i/r.length),t.y=e.y+n*Math.cos(2*Math.PI*i/r.length)}))}const xr=t=>"number"==typeof t.source||"number"==typeof t.target||"string"==typeof t.source||"string"==typeof t.target?45*devicePixelRatio:(t.source.size||fr)+(t.target.size||fr)+90*devicePixelRatio,wr=t=>(t.size?t.size:fr)+25*devicePixelRatio,Tr=t=>45*t/(2*Math.PI),Sr=()=>-400*Math.pow(devicePixelRatio,2),Ar=()=>2*Sr();function Er(t){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(t)}function Cr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Rr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Rr(Object(n),!0).forEach((function(e){Dr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Dr(t,e,n){return(e=kr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Or(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kr(r.key),r)}}function kr(t){var e=function(t,e){if("object"!==Er(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Er(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Er(e)?e:String(e)}var Ir="d3ForceLayout",Lr=function(t){return t?dn(t):t},Mr=function(){function e(t){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=t.state;this.state=r,this.d3Nodes={},this.d3RelList={},this.computing=!0,this.center={x:0,y:0};var i=this.state,o=i.nodes,a=i.rels;o.addChannel(Ir),a.addChannel(Ir),this.simulation=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=Bn(h),l=Cn("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Xn)/Xn}();function h(){f(),l.call("tick",e),n<r&&(u.stop(),l.call("end",e))}function f(r){var u,l,c=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(o-n)*i,s.forEach((function(t){t(n)})),u=0;u<c;++u)null==(l=t[u]).fx?l.x+=l.vx*=a:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=a:(l.y=l.fy,l.vy=0);return e}function d(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*Yn;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),d(),e={tick:f,restart:function(){return u.restart(h),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(c=t,s.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,u,l=0,c=t.length;for(null==r?r=1/0:r*=r,l=0;l<c;++l)(a=(i=e-(s=t[l]).x)*i+(o=n-s.y)*o)<r&&(u=s,r=a);return u},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}}().velocityDecay(.4).force("charge",or().strength(Sr)).force("centerX",function(t){var e,n,r,i=rr(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=rr(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:rr(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:rr(+e),a(),o):t},o}(0).strength(.03)).force("centerY",function(t){var e,n,r,i=rr(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=rr(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:rr(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:rr(+e),a(),o):t},o}(0).strength(.03)).alpha(1).alphaMin(.05).on("end",(function(){n.simulationStopped=!0,n.shouldUpdate=!1})).stop(),this.simulationStopped=!0,this.shouldUpdate=!0,this.stateDisposers=[],this.stateDisposers.push(this.state.reaction((function(){return n.state.graphUpdates}),(function(){void 0!==n.state.nodes.version&&(n.shouldUpdate=!0),void 0!==n.state.rels.version&&(n.shouldUpdate=!0)})))}var n,r;return n=e,r=[{key:"setOptions",value:function(t){}},{key:"updateNodes",value:function(t){var e=this;t.forEach((function(t){void 0===e.d3Nodes[t.id]&&(e.d3Nodes[t.id]={id:t.id}),null!=t&&t.pinned?(e.d3Nodes[t.id].fx=t.x,e.d3Nodes[t.id].fy=t.y):(e.d3Nodes[t.id].x=t.x,e.d3Nodes[t.id].y=t.y),e.d3Nodes[t.id].vy=0,e.d3Nodes[t.id].vx=0})),this.shouldUpdate=!0,this.simulation.tick().alpha(.2)}},{key:"update",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.shouldUpdate||e){var n=this.state,r=n.nodes,i=n.rels,o=r.channels[Ir],a=i.channels[Ir],s=Object.values(o.adds).length>0,u=Object.values(a.adds).length>0,l=Object.values(o.removes).length>0,c=Object.values(a.removes).length>0,h=Object.values(o.updates).length>0;if(s||u||l||c||h){var f=s&&0===Object.keys(this.d3Nodes).length,d=Lr(o.removes);Object.keys(d).forEach((function(e){delete t.d3Nodes[e]}));var p=Lr(o.adds);if(Object.keys(p).forEach((function(e){t.d3Nodes[e]=Pr({},p[e])})),h){var v=Object.values(o.updates);v.forEach((function(e){!0===e.pinned?(t.d3Nodes[e.id].fx=t.d3Nodes[e.id].x,t.d3Nodes[e.id].fy=t.d3Nodes[e.id].y):!1===e.pinned&&(t.d3Nodes[e.id].fx=null,t.d3Nodes[e.id].fy=null),void 0!==e.size&&(t.d3Nodes[e.id].size=e.size)}))}if((u||c)&&(this.d3RelList=mr(Lr(i.items)).filter((function(t){return t.from!==t.to})).map((function(t,e){return{source:t.from,target:t.to,index:e}}))),f){var g=Object.values(this.d3Nodes);br(g,this.center,Tr(g.length))}this.layout(r.items,i.items,f)}r.clearChannel(Ir),i.clearChannel(Ir),this.shouldUpdate=!1,this.simulation.alpha()>this.simulation.alphaMin()&&(this.shouldUpdate=!0,this.simulationStopped&&(this.simulation.restart(),this.simulationStopped=!1))}}},{key:"layout",value:function(e,n,r){if(!(0,t.isEmpty)(this.d3Nodes)){if(this.simulation.stop(),this.simulation.nodes(Object.values(this.d3Nodes)).force("collide",function(t){var e,n,r,i=1,o=1;function a(){for(var t,a,u,l,c,h,f,d=e.length,p=0;p<o;++p)for(a=Qn(e,ar,sr).visitAfter(s),t=0;t<d;++t)u=e[t],h=n[u.index],f=h*h,l=u.x+u.vx,c=u.y+u.vy,a.visit(v);function v(t,e,n,o,a){var s=t.data,d=t.r,p=h+d;if(!s)return e>l+p||o<l-p||n>c+p||a<c-p;if(s.index>u.index){var v=l-s.x-s.vx,g=c-s.y-s.vy,y=v*v+g*g;y<p*p&&(0===v&&(y+=(v=ir(r))*v),0===g&&(y+=(g=ir(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,u.vx+=(v*=y)*(p=(d*=d)/(f+d)),u.vy+=(g*=y)*p,s.vx-=v*(p=1-p),s.vy-=g*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=rr(null==t?1:+t)),a.initialize=function(t,n){e=t,r=n,u()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:rr(+e),u(),a):t},a}().radius(wr)),this.simulation.force("link",function(t){var e,n,r,i,o,a,s=ur,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},l=rr(30),c=1;function h(r){for(var i=0,s=t.length;i<c;++i)for(var u,l,h,f,d,p,v,g=0;g<s;++g)l=(u=t[g]).source,f=(h=u.target).x+h.vx-l.x-l.vx||ir(a),d=h.y+h.vy-l.y-l.vy||ir(a),f*=p=((p=Math.sqrt(f*f+d*d))-n[g])/p*r*e[g],d*=p,h.vx-=f*(v=o[g]),h.vy-=d*v,l.vx+=f*(v=1-v),l.vy+=d*v}function f(){if(r){var a,u,l=r.length,c=t.length,h=new Map(r.map(((t,e)=>[s(t,e,r),t])));for(a=0,i=new Array(l);a<c;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=lr(h,u.source)),"object"!=typeof u.target&&(u.target=lr(h,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)u=t[a],o[a]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(c),d(),n=new Array(c),p()}}function d(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+u(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+l(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){r=t,a=e,f()},h.links=function(e){return arguments.length?(t=e,f(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(c=+t,h):c},h.strength=function(t){return arguments.length?(u="function"==typeof t?t:rr(+t),d(),h):u},h.distance=function(t){return arguments.length?(l="function"==typeof t?t:rr(+t),p(),h):l},h}(this.d3RelList).id((function(t){return t.id})).distance(xr)),r){var i=0;this.simulation.force("charge",or().strength(Ar));for(var o=performance.now();performance.now()-o<300&&i<200;)this.simulation.alpha(1),this.simulation.tick(1),i+=1;this.simulation.force("charge",or().strength(Sr));for(var a=performance.now();performance.now()-a<100&&this.simulation.alpha()>=this.simulation.alphaMin();)this.simulation.tick(1);return this.computing=!1,void this.simulation.restart()}this.simulation.alpha(1).restart()}}},{key:"getNodePositions",value:function(t){var e,n=[],r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Cr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,o=this.d3Nodes[i.id];if(void 0!==o){var a={id:o.id,x:o.x,y:o.y};n.push(a)}}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"getShouldUpdate",value:function(){return this.shouldUpdate}},{key:"getComputing",value:function(){return this.computing}},{key:"terminateUpdate",value:function(){this.simulation.alpha(this.simulation.alphaMin()).stop,this.simulationStopped=!0}},{key:"destroy",value:function(){this.stateDisposers.forEach((function(t){t()})),this.state.nodes.removeChannel(Ir),this.state.rels.removeChannel(Ir),this.simulation.stop()}},{key:"setAlpha",value:function(t){this.simulation.alpha(t),this.simulation.restart(),this.simulation.shouldUpdate=!0}}],r&&Or(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),Nr=r(640),jr=r.n(Nr)().getLogger("NVL"),Ur=r(670);const Fr=(t,e,n)=>t+(e-t)*(t=>t*t*(3-2*t))(n);class zr{positions;oldPositions;startTime;t;currentT;state;shouldUpdateAnimator;parents;animationCompleteCallback;shouldUpdate;constructor(t){const{state:e}=t;this.positions={},this.oldPositions={},this.startTime=0,this.t=1,this.currentT=1,this.state=e,this.shouldUpdateAnimator=!1,this.parents={},this.animationCompleteCallback=t.animationCompleteCallback}getPositionMapFromState(){const{idToPosition:t,items:e}=this.state.nodes,n={};for(const r of e){const e=t[r.id];void 0!==e&&(n[r.id]={id:r.id,x:e.x,y:e.y})}return n}updatePositionsFromState(){this.positions={...this.getPositionMapFromState()}}updateOldPositionFromState(){this.oldPositions={...this.getPositionMapFromState()}}startAnimation(){this.updateOldPositionFromState(),this.startTime=Date.now(),this.t=0,this.currentT=0,this.shouldUpdateAnimator=!0}update(){const t=this.shouldUpdateAnimator,e=(Date.now()-this.startTime)/400;this.t=Math.min(e,1),this.currentT<1?this.shouldUpdateAnimator=!0:(this.shouldUpdateAnimator=!1,t&&!this.shouldUpdateAnimator&&void 0!==this.animationCompleteCallback&&this.animationCompleteCallback(),this.shouldUpdateAnimator||this.updatePositionsFromState())}updateNodes(t){for(const e of t)void 0!==e.x&&void 0!==e.y&&(this.positions[e.id]={id:e.id,x:e.x,y:e.y}),this.shouldUpdate=!0}getNodePositions(t){const{parents:e,state:{nodes:{idToPosition:n}}}=this,r=((t,e)=>{const n={x:0,y:0},r=t.length;let i=0;for(let o=0;o<r;o++){const r=e[t[o].id];Boolean(r)&&r.x&&r.y&&0!==r.x&&0!==r.y&&(n.x+=r.x,n.y+=r.y,i+=1)}return i>0?[n.x/i,n.y/i]:[0,0]})(t,n),i={x:r[0],y:r[1]},o=[];for(const r of t){const t=this.positions[r.id],a=n[r.id],s={id:r.id};if(void 0!==t){let n=r.id,o=this.oldPositions[r.id]??{...i};for(;void 0===o&&void 0!==e[n];)n=e[n],o=this.oldPositions[n];o.x=o.x||i.x,o.y=o.y||i.y,s.x=Fr(o.x,t.x,this.t),s.y=Fr(o.y,t.y,this.t)}else void 0!==a&&(s.x=a.x||i.x,s.y=a.y||i.y);o.push(s)}return this.currentT=this.t,o}}const Br=t=>void 0!==t?dn(t):t;class Vr extends zr{stateDisposers;cytoCompleteCallback;computing;pendingLayoutData;worker;constructor(t){super(t),this.stateDisposers=[],this.stateDisposers.push(this.state.reaction((()=>this.state.graphUpdates),(()=>{void 0!==this.state.nodes.version&&(this.shouldUpdate=!0),void 0!==this.state.rels.version&&(this.shouldUpdate=!0)})));const{nodes:e,rels:n}=this.state;this.cytoCompleteCallback=t.cytoCompleteCallback,this.shouldUpdate=!0,this.computing=!1,this.pendingLayoutData=null,this.worker=(0,Ur.createCoseBilkentLayoutWorker)(),this.worker.port.start(),this.setOptions(t),this.layout(e.items,n.items)}setOptions(t){this.shouldUpdate=!0}update(t=!1,e=[],n=[]){if(this.shouldUpdate||t){const t=Br(e),r=Br(n);(t.length>0||r.length>0)&&(this.updatePositionsFromState(),this.layout(t,r))}super.update(),this.shouldUpdate=!1}getShouldUpdate(){return this.shouldUpdate||this.shouldUpdateAnimator}getComputing(){return this.computing}layout(t,e){if(!t.length)return;const n={elements:[...t.map((t=>({group:"nodes",data:{id:t.id}}))),...e.map((t=>({group:"edges",data:{id:`rel${t.id}`,source:t.from,target:t.to}})))],spacingFactor:t.reduce(((t,e)=>t+(e.size||fr)),0)/t.length*4.5/50*vr()};this.computing?this.pendingLayoutData=n:(this.computing=!0,this.worker.port.onmessage=({data:{positions:t}})=>{if(this.computing){for(const[e,n]of Object.entries(t))this.positions[e]={id:e,...n};this.cytoCompleteCallback(),this.startAnimation()}this.computing=!1,this.shouldUpdate=!0},setTimeout((()=>{this.computing&&this.worker.port.postMessage(n)}),0))}terminateUpdate(){this.computing=!1}destroy(){this.stateDisposers.forEach((t=>{t()})),this.worker.port.close()}}var Gr="undefined"!=typeof Float32Array?Float32Array:Array;function Wr(){var t=new Gr(16);return Gr!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Xr=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*l,t[15]=1,t},$r=r(637),Hr=r.n($r);function Yr(t){return Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yr(t)}function qr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Yr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Yr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Yr(i)?i:String(i)),r)}var i}var Kr=function(){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};qr(this,t);var o=e.createShader(e.FRAGMENT_SHADER);if(!e.isShader(o))throw new Error("Could not create shader object");var a=Hr()(r,i);e.shaderSource(o,a),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)||jr.info(e.getShaderInfoLog(o));var s=e.createShader(e.VERTEX_SHADER);if(!e.isShader(s))throw new Error("Could not create shader object");var u=Hr()(n,i);if(e.shaderSource(s,u),e.compileShader(s),e.getShaderParameter(s,e.COMPILE_STATUS)||jr.info(e.getShaderInfoLog(s)),this._shaderProgram=e.createProgram(),e.attachShader(this._shaderProgram,o),e.attachShader(this._shaderProgram,s),e.linkProgram(this._shaderProgram),!e.getProgramParameter(this._shaderProgram,e.LINK_STATUS))throw new Error("Could not initialise shader");this._gl=e,this._curTexture=0,this._scanUniforms(),this._scanAttributes()}var e,n;return e=t,(n=[{key:"_scanAttributes",value:function(){var t=this._gl;this._attributeInfo={};for(var e,n,r=t.getProgramParameter(this._shaderProgram,t.ACTIVE_ATTRIBUTES),i=0;i<r;i++)e=t.getActiveAttrib(this._shaderProgram,i),n=t.getAttribLocation(this._shaderProgram,e.name),this._attributeInfo[e.name]={type:e.type,position:n}}},{key:"_scanUniforms",value:function(){var t=this._gl;this._uniformInfo={};for(var e,n=t.getProgramParameter(this._shaderProgram,t.ACTIVE_UNIFORMS),r=0;r<n;r++){e=t.getActiveUniform(this._shaderProgram,r);var i=t.getUniformLocation(this._shaderProgram,e.name),o={type:e.type,location:i};e.type===t.SAMPLER_2D&&(o.texture=this._curTexture,this._curTexture++),this._uniformInfo[e.name]=o}}},{key:"setUniform",value:function(t,e){var n=this._gl,r=this._uniformInfo[t];if(!r)throw new Error("Shader.setUniform - Uniform ".concat(t," not found in shader"));switch(r.type){case n.INT:n.uniform1i(r.location,e);break;case n.INT_VEC2:n.uniform2iv(r.location,e);break;case n.INT_VEC3:n.uniform3iv(r.location,e);break;case n.INT_VEC4:n.uniform4iv(r.location,e);break;case n.SAMPLER_2D:n.activeTexture(n.TEXTURE0+r.texture),n.bindTexture(n.TEXTURE_2D,e),n.uniform1i(r.location,r.texture);break;case n.SAMPLER_CUBE:case n.FLOAT:n.uniform1f(r.location,e);break;case n.FLOAT_VEC2:n.uniform2fv(r.location,e);break;case n.FLOAT_VEC3:n.uniform3fv(r.location,e);break;case n.FLOAT_VEC4:n.uniform4fv(r.location,e);break;case n.FLOAT_MAT2:n.uniformMatrix2fv(r.location,!1,e);break;case n.FLOAT_MAT3:n.uniformMatrix3fv(r.location,!1,e);break;case n.FLOAT_MAT4:n.uniformMatrix4fv(r.location,!1,e)}}},{key:"setAttributePointer",value:function(t,e,n,r){var i=this._gl,o=this._attributeInfo[t];n*=Float32Array.BYTES_PER_ELEMENT,r*=Float32Array.BYTES_PER_ELEMENT,i.enableVertexAttribArray(o.position),i.vertexAttribPointer(o.position,e,i.FLOAT,!1,r,n)}},{key:"setAttributePointerFloat",value:function(t,e,n,r){var i=this._gl,o=this._attributeInfo[t];i.enableVertexAttribArray(o.position),i.vertexAttribPointer(o.position,e,i.FLOAT,!1,r,n)}},{key:"setAttributePointerUShort",value:function(t,e,n,r){var i=this._gl,o=this._attributeInfo[t];i.enableVertexAttribArray(o.position),i.vertexAttribPointer(o.position,e,i.UNSIGNED_SHORT,!1,r,n)}},{key:"setAttributePointerByteNorm",value:function(t,e,n,r){var i=this._gl,o=this._attributeInfo[t];i.enableVertexAttribArray(o.position),i.vertexAttribPointer(o.position,e,i.UNSIGNED_BYTE,!0,r,n)}},{key:"setAttributePointerByte",value:function(t,e,n,r){var i=this._gl,o=this._attributeInfo[t];i.enableVertexAttribArray(o.position),i.vertexAttribPointer(o.position,e,i.UNSIGNED_BYTE,!1,r,n)}},{key:"use",value:function(){this._gl.useProgram(this._shaderProgram)}},{key:"remove",value:function(){this._gl.deleteProgram(this._shaderProgram)}}])&&Zr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();class Jr extends Error{toString(){return this.message}}const Qr="uniform mat4 u_projection;\n\nattribute vec2 a_position;\n//attribute float a_index;\n\n//varying highp float index;\n\nvoid main() {\n//  index = a_index;\n  gl_Position = u_projection * vec4(a_position, 0.0, 1.0);\n}";function ti(t){return ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ti(t)}function ei(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ti(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ti(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ti(i)?i:String(i)),r)}var i}var ni=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.graph=this.constructGraphObjects(e,n),this.subGraphs=[],this.sunMap={}}var e,n;return e=t,n=[{key:"constructGraphObjects",value:function(t,e){var n=new Array(t.nodes.length),r=new Array(t.rels.length),i={},o=[];return t.nodes.forEach((function(t,e){n[e]=[],r[e]=[],o.push(t)})),t.rels.forEach((function(t){var o=e[t.from],a=e[t.to];void 0!==o&&void 0!==a&&(n[o].push(a),n[a].push(o),r[o].push(t.id),r[a].push(t.id),i[t.id]=t)})),this.relIdMap=r,{nodes:o,relationships:n,idToRel:i}}},{key:"coarsenTo",value:function(t){for(var e=this.graph,n=e.nodes.length,r=0;e.nodes.length>t&&e.relationships.some((function(t){return t.length>0}));){var i=this.coarsen(e,0===r);if(0===r&&(this.nodeSortMap=i.nodeSortMap),this.subGraphs.push(i.sortedInput),0===(e=i.output).relationships.length||e.relationships.every((function(t){return 0===t.length}))||n===e.nodes.length)break;n=e.nodes.length,r++}return this.subGraphs.push(e),e}},{key:"coarsenBy",value:function(t){for(var e=this.graph,n=e.nodes.length,r=t;t>0;){var i=this.coarsen(e,t===r);if(this.subGraphs.push(i.sortedInput),0===(e=i.output).relationships.length||e.relationships.every((function(t){return 0===t.length}))||n===e.nodes.length)break;n=e.nodes.length,t--}return this.subGraphs.push(e),e}},{key:"coarsen",value:function(t,e){var n=this,r=t.nodes,i=t.relationships,o=r.map((function(t,e){return e})),a={},s={};r.forEach((function(t,e){a[e]=t,s[t.id]=e}));for(var u=i.map((function(t){return t.slice()})),l={suns:{},planets:{},moons:{}},c=[],h=[],f=function(){var t=o[0];o.splice(o.indexOf(t),1),i[t].forEach((function(e){var n=o.indexOf(e);n>=0&&o.splice(n,1);var r=-1,i=u[e];i.forEach((function(e,n){var i=o.indexOf(e);i>=0?o.splice(i,1):e===t&&(r=n)})),i.splice(r,1)}));var n={id:t};if(e)n.originalId=a[t].id;else{var r=a[t];n.finestIndex=r.finestIndex,n.originalId=r.originalId}c.push(n),l.suns[t]=n};o.length>0;)f();c.forEach((function(t,e){h[e]=[]})),c.forEach((function(t,n){var r={},o=[];i[t.id].forEach((function(i){if(i!==t.id&&!r[i]){var s={id:i,parent:t,sunId:n,moons:[]},u=a[i];s.size=function(){return s.moons.length+1},s.weight=u.weight||1,s.children=function(){return s.moons},e?s.originalId=u.id:(s.finestIndex=u.finestIndex,s.originalId=u.originalId),o.push(s),r[i]=!0}})),o.forEach((function(t){l.planets[t.id]=t})),t.planets=o,t.children=function(){return t.planets},t.weight=t.planets.reduce((function(t,e){return t+(e.weight||1)}),0)+(a[t.id].weight||1),t.size=function(){return t.planets.reduce((function(t,e){return t+e.size()}),0)+1}}));var d=r.filter((function(t,e){return!c.find((function(t){return t.id===e}))&&!l.planets[e]})),p=[];d.forEach((function(t){for(var n=s[t.id],r=u[n],i=null,o=-1,c=0;c<r.length;c++){var h=r[c];if(h!==n&&(i=l.planets[h])){o=c;break}}if(r.splice(o,1),i){var f={id:n,size:function(){return 0}};f.weight=a[n].weight||1,f.parent=i,f.sunId=i.sunId,e?f.originalId=t.id:(f.finestIndex=t.finestIndex,f.originalId=t.originalId),l.moons[n]=f,i.moons.push(f),i.weight+=f.weight,i.parent.weight+=f.weight;var d=u[i.id];d.splice(d.indexOf(n),1)}else p.push(t)})),u.forEach((function(t,e){if(!l.suns[e]){var n=l.planets[e]||l.moons[e];u[e].forEach((function(t){var e=l.planets[t];if(e||(e=l.moons[t]),n.sunId!==e.sunId){var r=h[n.sunId];r.includes(e.sunId)||r.push(e.sunId)}}))}}));var v=[],g=0,y={};c.forEach((function(t,i){var o=r[t.id];y[t.id]=g,t.previousIndex=i,t.id=g++,e&&(o.finestIndex=t.id,t.finestIndex=t.id),v.push(o),t.planets.forEach((function(i){var o=r[i.id];y[i.id]=g,i.id=g++,i.sunId=t.id,e&&(o.finestIndex=i.id),n.sunMap[i.originalId]=t.originalId,v.push(o),i.moons.forEach((function(i){var o=r[i.id];y[i.id]=g,i.id=g++,i.sunId=t.id,e&&(o.finestIndex=i.id),n.sunMap[i.originalId]=t.originalId,v.push(o)}))}))}));var m=[],_=[];return i.forEach((function(t,r){var i=y[r];m[i]=t.map((function(t){return y[t]})),e&&(_[i]=t.map((function(t,e){return n.relIdMap[r][e]})))})),_&&_.length>0&&(this.relIdMap=_),{output:{nodes:c,relationships:h},sortedInput:{nodes:v,relationships:m},nodeSortMap:y}}}],n&&ei(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ri=function(t,e,n){for(var r=2*Math.PI/n,i=[],o=0;o<n;o++){var a=r*o;i.push({x:t.x+e*Math.cos(a),y:t.y+e*Math.sin(a)})}return i};function ii(t){return ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ii(t)}function oi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ai(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ai(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ai(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ii(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ii(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ii(i)?i:String(i)),r)}var i}var ui=300,li="PhysLayout",ci=new Float32Array(4),hi=256,fi=function(t){for(var e={},n={},r=0;r<t.length;r++)e[t[r].id]=r,n[r]=t[r].id;return{nodeIdToIndex:e,nodeIndexToId:n}},di=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e.state,i=e.webGLContext;if(jr.info("layout - webGLContext",Boolean(i)),void 0===e.webGLContext)throw new Error("PhysLayout missing options: webGLContext - webgl context");if(void 0===e.state)throw new Error("PhysLayout missing options: state - state object");var o=i;this._checkCompatibility(o),this._printGlStats(o),this._physVbo=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this._physVbo);var a=new Float32Array([0,0,cr,0,0,cr,cr,cr]);o.bufferData(o.ARRAY_BUFFER,a,o.STATIC_DRAW),this._physSmallVbo=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this._physSmallVbo);var s=new Float32Array([0,0,hi,0,0,hi,hi,hi]);o.bufferData(o.ARRAY_BUFFER,s,o.STATIC_DRAW),this._physProjection=Wr(),Xr(this._physProjection,0,cr,cr,0,0,1e6),this._physSmallProjection=Wr(),Xr(this._physSmallProjection,0,hi,hi,0,0,1e6),o.disable(o.DEPTH_TEST),this._gl=o,this._useReadpixelWorkaround&&this._setupReadpixelWorkaround(),this._setupUpdates(),this._averageNodeSize=fr,this.shouldUpdate=!0,this.iterationCount=0,this.lastSpeedValues=[],this.rollingAvgGraphSpeed=0,this.nodeVariation=0,this.nodeCenterPoint=[0,0],this.peakIterationMultiplier=160,this.setOptions(e,!0),this._definePhysicsArrays();var u=r.nodes,l=r.rels;u.addChannel(li),l.addChannel(li),this.stateDisposers=[],this.stateDisposers.push(r.reaction((function(){return r.graphUpdates}),(function(){var t=u.channels[li];if(void 0!==u.version&&t){var e=Object.values(t.adds).length>0,r=Object.values(t.removes).length>0,i=Object.values(t.updates),o=n._hasSizeChanged(i);(e||r||o)&&(n.shouldUpdate=!0,n._checkForUpdates())}var a=l.channels[li];if(void 0!==l.version&&a){var s=Object.values(a.adds).length>0,c=Object.values(a.removes).length>0;(s||c)&&(n.shouldUpdate=!0,n._checkForUpdates())}}))),this.setData({nodes:u.items,rels:l.items}),this._state=r,this._dpr=window.devicePixelRatio||1}var e,n;return e=t,n=[{key:"setOptions",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var n=t.intelWorkaround,r=t.simulationStopVelocity,i=void 0===r?100:r,o=t.gravity,a=void 0===o?100:o;e&&(this.intelWorkaround=n),i?this.simulationStopVelocitySquared=i*i:e&&(this.simulationStopVelocitySquared=1e4),this.gravity=a,this.force=0}}},{key:"setData",value:function(t){var e=fi(t.nodes),n=e.nodeIdToIndex,r=e.nodeIndexToId;return this._nodeIdToIndex=n,this._nodeIndexToId=r,this._numNodes=t.nodes.length,this.solarMerger=new ni(t,n),this.solarMerger.coarsenTo(1),this.subGraphs=this.solarMerger.subGraphs,this.nodeSortMap=this.solarMerger.nodeSortMap,this._setupSprings(this.subGraphs[0]),this._setupSize(this.subGraphs[0]),this._setupPhysics(),this._firstUpdate=!0,this._curPhysData=0,this.shouldUpdate=!0,this.iterationCount=0,this.subGraphs[0]}},{key:"update",value:function(t){var e=this._gl;if(this._checkForUpdates(t),!this.shouldUpdate)return e.bindFramebuffer(e.FRAMEBUFFER,this._getPhysData(0).frameBuffer),void e.readPixels(0,0,cr,cr,e.RGBA,e.FLOAT,this._physPositions);e.disable(e.BLEND);for(var n=this.nodeVariation/(this._numNodes||1)>.3,r=this._getScaleNumber(this.iterationCount),i=this.subGraphs?this.subGraphs.length:0,o=this._getPhysData(0).texture,a=i-1;a>0;a--){var s=this.subGraphs[a].nodes.length,u=a===i-1;this._apprxRepForceShader.use(),this._apprxRepForceShader.setUniform("u_physData",o),this._apprxRepForceShader.setUniform("u_clusterData",this.levelsClusterTexture[a]),this._apprxRepForceShader.setUniform("u_finestIndexes",this.levelsFinestIndexTexture[a]),this._apprxRepForceShader.setUniform("u_prevForce",u?this.initalLevelTexture:this.levelsData[a+1].texture),this._apprxRepForceShader.setUniform("u_numNodes",s),this._apprxRepForceShader.setUniform("u_iterationMultiplier",r),this._apprxRepForceShader.setUniform("u_baseLength",this._getBaseLength(s)),this._apprxRepForceShader.setUniform("u_isTopLevel",u?1:0),e.bindBuffer(e.ARRAY_BUFFER,this._physSmallVbo),this._apprxRepForceShader.setAttributePointer("a_position",2,0,2),e.bindFramebuffer(e.FRAMEBUFFER,this.levelsData[a].frameBuffer),e.viewport(0,0,hi,hi),e.drawArrays(e.TRIANGLE_STRIP,0,4)}if(this.collisionDetectionMultiplier=0,this.collisionDetectionMultiplier=n?Math.min(this.iterationCount/Math.min(this._numNodes,ui),1):1,this.force=i<=1?this.initalLevelTexture:this.levelsData[1].texture,this._physShader.use(),this._physShader.setUniform("u_prevForce",i<=1?this.initalLevelTexture:this.levelsData[1].texture),this._physShader.setUniform("u_connections",this._springTexture),this._physShader.setUniform("u_sizeTexture",this._sizeTexture),this._physShader.setUniform("u_connectionOffsets",this._offsetTexture),this._physShader.setUniform("u_physData",o),this._physShader.setUniform("u_pinnedNodes",this._pinTexture),this._physShader.setUniform("u_iterationMultiplier",r),this._physShader.setUniform("u_curIteration",this.iterationCount),this._physShader.setUniform("u_numNodes",this._numNodes),this._physShader.setUniform("u_clusterData",this.levelsClusterTexture[0]),this._physShader.setUniform("u_collisionMultiplier",this.collisionDetectionMultiplier),this._physShader.setUniform("u_baseLength",this._getBaseLength()),this._firstUpdate=!1,e.bindBuffer(e.ARRAY_BUFFER,this._physVbo),this._physShader.setAttributePointer("a_position",2,0,2),e.bindFramebuffer(e.FRAMEBUFFER,this._getPhysData(1).frameBuffer),e.viewport(0,0,cr,cr),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._useReadpixelWorkaround?this._doReadpixelWorkaround():(e.bindFramebuffer(e.FRAMEBUFFER,this._getPhysData(0).frameBuffer),e.readPixels(0,0,cr,cr,e.RGBA,e.FLOAT,this._physPositions)),this._curPhysData=(this._curPhysData+1)%this._physData.length,this.iterationCount++,this._numNodes<2)this.shouldUpdate=!1,this.iterationCount=0;else if(this.iterationCount%5==0){var l=this.iterationCount<ui,c=l?this._getMaxSpeedSquared():this._getMedianSpeedSquared(this.addedNodes);this.lastSpeedValues.push(c),this.rollingAvgGraphSpeed=this.lastSpeedValues.reduce((function(t,e){return t+e}),0)/this.lastSpeedValues.length;var h=l&&c>=this.rollingAvgGraphSpeed,f=this.simulationStopVelocitySquared&&this.rollingAvgGraphSpeed<this.simulationStopVelocitySquared;this.lastSpeedValues.length>20&&this.lastSpeedValues.shift(),!h&&f&&this.iterationCount>2&&this.terminateUpdate()}return this.shouldUpdate}},{key:"terminateUpdate",value:function(){jr.info("Cooling down after ".concat(this.iterationCount," iterations at graph speed of ").concat(Math.sqrt(this.rollingAvgGraphSpeed))),this.shouldUpdate=!1,this.iterationCount=0,this.rollingAvgGraphSpeed=0,this.lastSpeedValues=[],this.addedNodes=null,this.nodeVariation=0}},{key:"getShouldUpdate",value:function(){return this.shouldUpdate}},{key:"getComputing",value:function(){return!1}},{key:"getNodePositions",value:function(t){var e=[];if(this._useReadpixelWorkaround){var n,r=oi(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this._nodeIdToIndex[i.id],a={id:i.id};void 0!==o&&(a.x=this._workaroundData[0].dataFloat[o],a.y=this._workaroundData[1].dataFloat[o]),e.push(a)}}catch(t){r.e(t)}finally{r.f()}}else{var s,u=oi(t);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=this._nodeIdToIndex[l.id],h={id:l.id};void 0!==c&&(h.x=this._physPositions[4*c+0],h.y=this._physPositions[4*c+1]),e.push(h)}}catch(t){u.e(t)}finally{u.f()}}return e}},{key:"reheat",value:function(t){this._setupSize(this.subGraphs[0]),this.shouldUpdate=!0,this.iterationCount=0,this.nodeVariation=t.nodes.length}},{key:"updateNodes",value:function(t){var e=this._gl,n=new Set;e.bindTexture(e.TEXTURE_2D,this._getPhysData().texture);var r,i=oi(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=this._nodeIdToIndex[o.id];if(void 0!==o.x&&void 0!==o.y){ci[0]=o.x,ci[1]=o.y,ci[2]=0,ci[3]=0;var s=a%cr,u=(a-s)/cr;e.texSubImage2D(e.TEXTURE_2D,0,s,u,1,1,e.RGBA,e.FLOAT,ci),this._useReadpixelWorkaround?(this._workaroundData[0].dataFloat[a]=o.x,this._workaroundData[1].dataFloat[a]=o.y):(this._physPositions[4*a+0]=o.x,this._physPositions[4*a+1]=o.y)}void 0!==o.pinned&&(this._pinData[a]=o.pinned?255:0),Object.keys(o).forEach((function(t){return n.add(t)}))}}catch(t){i.e(t)}finally{i.f()}n.has("pinned")&&(e.bindTexture(e.TEXTURE_2D,this._pinTexture),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,cr,cr,0,e.ALPHA,e.UNSIGNED_BYTE,this._pinData)),(n.has("x")||n.has("y")||n.has("size"))&&(this.shouldUpdate=!0,this.iterationCount=0)}},{key:"addRemoveData",value:function(t,e){var n=this._gl;this._numNodes=t.nodes.length,this._physShader.use(),this._physShader.setUniform("u_numNodes",this._numNodes),this._physShader.setUniform("u_baseLength",this._getBaseLength());var r=fi(t.nodes).nodeIdToIndex,i=new ni(t,r);i.coarsenTo(1);var o=i.subGraphs[0],a=this.subGraphs[0],s=function(t){return a.nodes.findIndex((function(e){return e.id===t}))},u=Object.values(e.adds),l=Object.values(e.removes);this.addedNodes=u.length>0?{}:null,this.nodeVariation=u.length+l.length;for(var c,h=3*Math.sqrt(t.nodes.length),f={x:0,y:0},d=o.nodes.length,p=new Uint8Array(65536),v=0;v<d;v++){var g=0,y=0,m=o.nodes[v];if(c=m.id,Boolean(e.adds[c])){if(this.addedNodes[v]=m.id,g=m.position?m.position.x:void 0,y=m.position?m.position.y:void 0,void 0===g||void 0===y){var _=i.sunMap,b=void 0;for(b=_[m.id];void 0!==b;b=_[b]){var x=s(b);if(-1!==x){var w=this._getNodePosition(x);g=w.x+10*(Math.random()-.5),y=w.y+10*(Math.random()-.5);break}}void 0===b&&(g=this.nodeCenterPoint[0]+h*(Math.random()-.5),y=this.nodeCenterPoint[1]+h*(Math.random()-.5))}this._updateData[2*v]=g,this._updateData[2*v+1]=y,p[v]=m.pinned?255:0}else{var T=s(m.id),S=this._getNodePosition(T);g=S.x,y=S.y,this._updateData[2*v]=T,this._updateData[2*v+1]=999999,p[v]=this._pinData[T]}f.x+=g||0,f.y+=y||0}this.nodeCenterPoint=d?[f.x/d,f.y/d]:[0,0],this._pinData=p,this.subGraphs=i.subGraphs,this.nodeSortMap=i.nodeSortMap,this._setupSprings(this.subGraphs[0]),this._setupSize(this.subGraphs[0]);var A=fi(this.subGraphs[0].nodes),E=A.nodeIdToIndex,C=A.nodeIndexToId;return this._nodeIdToIndex=E,this._nodeIndexToId=C,n.bindTexture(n.TEXTURE_2D,this._updateTexture),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,cr,cr,0,n.ALPHA,n.FLOAT,this._updateData),jr.info("Setting gravity center to ",this.nodeCenterPoint),this._physShader.setUniform("u_gravityCenter",this.nodeCenterPoint),this._updateShader.use(),this._updateShader.setUniform("u_numNodesNew",o.nodes.length),this._updateShader.setUniform("u_physData",this._getPhysData(0).texture),this._updateShader.setUniform("u_updateData",this._updateTexture),n.disable(n.BLEND),n.bindBuffer(n.ARRAY_BUFFER,this._physVbo),this._updateShader.setAttributePointer("a_position",2,0,2),n.bindFramebuffer(n.FRAMEBUFFER,this._getPhysData(1).frameBuffer),n.viewport(0,0,cr,cr),n.drawArrays(n.TRIANGLE_STRIP,0,4),this._curPhysData=(this._curPhysData+1)%this._physData.length,this._useReadpixelWorkaround?this._doReadpixelWorkaround():(n.bindFramebuffer(n.FRAMEBUFFER,this._getPhysData().frameBuffer),n.readPixels(0,0,cr,cr,n.RGBA,n.FLOAT,this._physPositions)),(u.length>0||l.length>0)&&(n.bindTexture(n.TEXTURE_2D,this._pinTexture),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,cr,cr,0,n.ALPHA,n.UNSIGNED_BYTE,this._pinData)),this.shouldUpdate=!0,this.iterationCount=0,this._setupPhysicsForCoarse(),this.subGraphs[0]}},{key:"destroy",value:function(){var t=this;this._gl.deleteBuffer(this._physVbo),this._gl.deleteBuffer(this._physSmallVbo),this._physData.forEach((function(e){t._gl.deleteFramebuffer(e.frameBuffer),t._gl.deleteTexture(e.texture)})),this.levelsData.forEach((function(e){t._gl.deleteFramebuffer(e.frameBuffer),t._gl.deleteTexture(e.texture)})),this.levelsClusterTexture.forEach((function(e){t._gl.deleteTexture(e)})),this.levelsFinestIndexTexture.forEach((function(e){t._gl.deleteTexture(e)})),this._gl.deleteTexture(this.initalLevelTexture),this._gl.deleteTexture(this._sizeTexture),this._gl.deleteTexture(this._offsetTexture),this._gl.deleteTexture(this._springTexture),this._gl.deleteTexture(this._pinTexture),this._gl.deleteTexture(this._updateTexture),this._apprxRepForceShader&&this._apprxRepForceShader.remove(),this._updateShader&&this._updateShader.remove(),this._physShader&&this._physShader.remove(),this._physPositions=null,this._gl=null,this.stateDisposers.forEach((function(t){t()})),this._state.nodes.removeChannel(li),this._state.rels.removeChannel(li)}},{key:"_dumpTexture",value:function(t,e,n){var r=this._gl;jr.info("--- Dumping texture ",n),r.bindFramebuffer(r.FRAMEBUFFER,t),r.readPixels(0,0,cr,cr,r.RGBA,r.FLOAT,this._physPositions);for(var i=0;i<e;i++)jr.info(i,": ",this._physPositions[4*i+0],this._physPositions[4*i+1],this._physPositions[4*i+2],this._physPositions[4*i+3])}},{key:"_getScaleNumber",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t,e,n){return n+Math.pow(10,6)*Math.pow(t-120,-1.7)},n=200,r=10;return 0===t?0:t<ui?n+-1/Math.pow(10,5)*3*Math.pow(Math.abs(t-n+12),3):e(t,n,r)}},{key:"_getBaseLength",value:function(t){if(!t||t===this._numNodes)return 100*this._dpr;var e=Math.pow(this._averageNodeSize/2,2)*Math.PI,n=this._numNodes/t*e;return(100+Math.sqrt(n/Math.PI)/2/t)*this._dpr}},{key:"_hasSizeChanged",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Boolean(t.find((function(t){return"size"in t})))}},{key:"_checkForUpdates",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._state,n=e.nodes,r=e.rels,i={nodes:n.items,rels:r.items},o=Object.values(n.channels[li].adds).length>0,a=Object.values(r.channels[li].adds).length>0,s=Object.values(n.channels[li].removes).length>0,u=Object.values(r.channels[li].removes).length>0,l=Object.values(n.channels[li].updates);(o||a||s||u)&&this.addRemoveData(i,{adds:n.channels[li].adds,removes:n.channels[li].removes}),t?(this.updateNodes(i.nodes),this.reheat(i,this.solarMerger)):l.length>0&&(this.updateNodes(l),this._hasSizeChanged(l)&&this.reheat(i,this.solarMerger)),n.clearChannel(li),r.clearChannel(li)}},{key:"_getNodePosition",value:function(t){return this._useReadpixelWorkaround?{x:this._workaroundData[0].dataFloat[t],y:this._workaroundData[1].dataFloat[t]}:{x:this._physPositions[4*t+0],y:this._physPositions[4*t+1]}}},{key:"_getMaxSpeedSquared",value:function(){var t=0;if(this._useReadpixelWorkaround)for(var e=0;e<this._numNodes;e++){var n=this._workaroundData[2].dataFloat[e],r=this._workaroundData[3].dataFloat[e],i=n*n+r*r;i>t&&(t=i)}else for(var o=0;o<this._numNodes;o++){var a=this._physPositions[4*o+2],s=this._physPositions[4*o+3],u=a*a+s*s;u>t&&(t=u)}return t}},{key:"_getMedianSpeedSquared",value:function(t){var e=[];if(this._useReadpixelWorkaround)for(var n=0;n<this._numNodes;n++){var r=this._workaroundData[2].dataFloat[n],i=this._workaroundData[3].dataFloat[n],o=r*r+i*i;e[n]=o}else for(var a=0;a<this._numNodes;a++)if(!t||t[a]){var s=this._physPositions[4*a+2],u=this._physPositions[4*a+3],l=s*s+u*u;e.push(l)}return e.sort((function(t,e){return t-e})),e[Math.floor(e.length/2)]}},{key:"_getPhysData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._physData[(this._curPhysData+t)%this._physData.length]}},{key:"_getLevelData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._levelData[(this._curPhysData+t)%this._levelData.length]}},{key:"_newTexture",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.FLOAT,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.RGBA,o=t.createTexture();return t.bindTexture(t.TEXTURE_2D,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,i,n,n,0,i,r,e),o}},{key:"_newFramebuffer",value:function(t,e){var n=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),n}},{key:"_checkCompatibility",value:function(t){function e(t){throw new Jr(t)}t||e("Could not initialize WebGL"),0===t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&e("Vertex shader texture access not available"),t.getExtension("OES_texture_float")||e("OES_texture_float extension not available");var n=t.getParameter(t.MAX_TEXTURE_SIZE),r=Math.max(cr,hr);n<r&&e("Need larger WebGL texture support. Avaliable: ".concat(n," needed: ").concat(r));var i=new Float32Array(4),o=this._newTexture(t,i,1),a=this._newFramebuffer(t,o);t.bindFramebuffer(t.FRAMEBUFFER,a),t.readPixels(0,0,1,1,t.RGBA,t.FLOAT,i),t.getError()!==t.NO_ERROR&&(jr.info("gl.readPixels doesnt work for float texture, activating workaround"),this._useReadpixelWorkaround=!0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(a),t.deleteTexture(o)}},{key:"_printGlStats",value:function(t){var e=t.getExtension("WEBGL_debug_renderer_info"),n="?",r="?";null!==e&&(n=t.getParameter(e.UNMASKED_VENDOR_WEBGL),r=t.getParameter(e.UNMASKED_RENDERER_WEBGL)),jr.trace("Vendor: ".concat(n)),jr.trace("Renderer: ".concat(r));var i=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE);jr.trace("Line width range: ".concat(i));var o=t.getSupportedExtensions();jr.trace("Extentions:"),o.length>0&&o.forEach((function(t){return jr.trace(t)}))}},{key:"_adjustToGlSize",value:function(t){return t*this._dpr*2.5}},{key:"_setupSize",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{nodes:[]},e=new Float32Array(65536),n=t.nodes,r=n.length,i=0,o=0;o<r;o++){var a=parseInt(n[o].size||fr);e[o]=this._adjustToGlSize(a),i+=a}this._averageNodeSize=r?i/r:fr;var s=this._gl;void 0===this._sizeTexture&&(this._sizeTexture=s.createTexture()),s.bindTexture(s.TEXTURE_2D,this._sizeTexture),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,cr,cr,0,s.ALPHA,s.FLOAT,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE)}},{key:"_setupSprings",value:function(t){var e,n,r=this._gl,i=t.relationships;this.connections=i;var o=new Float32Array(16777216),a=new Float32Array(65536),s=0;for(e=0;e<t.nodes.length;e++)for(a[e]=s,o[s]=i[e].length,s++,n=0;n<i[e].length;n++)o[s]=i[e][n],s++;for(n=s;n<o.length;n++)o[n]=1;for(n=e;n<a.length;n++)a[n]=0;void 0===this._offsetTexture&&(this._offsetTexture=r.createTexture()),r.bindTexture(r.TEXTURE_2D,this._offsetTexture),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,cr,cr,0,r.ALPHA,r.FLOAT,a),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),void 0===this._springTexture&&(this._springTexture=r.createTexture()),r.bindTexture(r.TEXTURE_2D,this._springTexture),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,hr,hr,0,r.ALPHA,r.FLOAT,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)}},{key:"_setupPhysics",value:function(){this._setupPhysicsForCoarse(),this._setupPhysicsForNodes(),this._physPositions=new Float32Array(262144),this._setupPinData()}},{key:"_setupPhysicsForNodes",value:function(){var t=this._gl,e=this.subGraphs.length,n=this.subGraphs[0].nodes,r=3*Math.sqrt(n.length),i=new Float32Array(262144),o=new Float32Array(262144);this._numNodes=n.length;for(var a=0;a<262144;a++)i[a]=0,o[a]=0;for(var s=function(t,e,n,r){r[4*t+0]=e,r[4*t+1]=n,r[4*t+2]=0,r[4*t+3]=0},u=e-1;u>=0;u--){var l=u===e-1?[]:this.subGraphs[u+1].nodes;0===l.length?this.subGraphs[u].nodes.forEach((function(t,e){var n=t.placement?t.placement.x:r*(Math.random()-.5),o=t.placement?t.placement.y:r*(Math.random()-.5);s(void 0===t.finestIndex?e:t.finestIndex,n,o,i)})):l.forEach((function(t){var e=t.finestIndex,n=i[4*t.finestIndex],r=i[4*t.finestIndex+1],o=ri({x:n,y:r},10,t.planets.length+1);e++,t.planets.forEach((function(t,n){var r=o[n];s(e++,r.x,r.y,i);var a=ri({x:r.x,y:r.y},10,t.moons.length+1);t.moons.forEach((function(t,n){var r=a[n];s(e++,r.x,r.y,i)}))}))}))}this._physData=[];for(var c=0;c<2;c++){var h=this._newTexture(t,0===c?i:o,cr),f=this._newFramebuffer(t,h);this._physData.push({texture:h,frameBuffer:f})}this._physShader=new Kr(t,Qr,"precision mediump float;\n\nuniform sampler2D u_physData;\nuniform sampler2D u_connections;\nuniform sampler2D u_connectionOffsets;\nuniform sampler2D u_pinnedNodes;\nuniform sampler2D u_sizeTexture;\nuniform float u_baseLength;\nuniform float u_curIteration;\nuniform float u_iterationMultiplier;\nuniform vec2 u_gravityCenter;\nuniform float u_numNodes;\nuniform float u_gravity;\n\nuniform sampler2D u_clusterData;\nuniform sampler2D u_prevForce;\nuniform float u_collisionMultiplier;\n\nfloat TIMESTEP = 1.0 / 30.0;\nfloat VELOCITYDECAY = 0.6;\nfloat accLimitLow = 500000.0;\nfloat accLimitHigh = 750000.0;\nfloat accLimitPosHigh = 10000000.0;\n\nconst float denseNodeThreshold = 1000.0;\nconst float MIN_DISTANCE = 0.00000001;\nconst float MAX_DISTANCE = 1000000000.0;\nconst float MAX_ACCELERATION = 500000.0;\n\nvec4 getTextureData(sampler2D texture, float index, float base) {\n  float x = mod(index, base);\n  float y = (index - x) / base;\n  return texture2D(texture, vec2(x + 0.5, y + 0.5) / base);\n}\n\nbool isNan(float val) {\n  return (val < 0.0 || 0.0 < val || val == 0.0) ? false : true;\n}\n\nconst float BIG_NUMBER = 999999999999999999.0;\nbool isInf(float val) {\n  return val > BIG_NUMBER || val < -BIG_NUMBER;\n}\n\nvec2 getDelta(vec2 v1, vec2 v2) {\n  vec2 delta = v1 - v2;\n  float dist = length(delta);\n  if (dist < MIN_DISTANCE || isNan(dist)) {\n    return vec2(MIN_DISTANCE, MIN_DISTANCE);\n  }\n  if (dist > MAX_DISTANCE) {\n    vec2 normDelta = delta / dist;\n    return normDelta * MAX_DISTANCE;\n  }\n  return delta;\n}\n\nvec4 getOtherNodePosition(float i) {\n  return getTextureData(u_physData, i, 256.0);\n}\n\nfloat getCombinedNodeSize(float i, float nodeSize) {\n  float otherNodeSize = getTextureData(u_sizeTexture, i, 256.0).a;\n  return nodeSize + otherNodeSize;\n}\n\nvec2 getSpringForce(float curConnection,  float numConnections, float springFScale, vec4 myPosition, float i) {\n  float curSpring = getTextureData(u_connections, curConnection + i, 4096.0).a;\n\n  vec4 otherPosition = getTextureData(u_physData, curSpring, 256.0);\n  float otherDataPosition = getTextureData(u_connectionOffsets, curSpring, 256.0).a;\n  float avgDegree;\n#if INTEL_WORKAROUND\n    avgDegree = max(numConnections, 4.0);\n#else\n    float otherNumConnections = getTextureData(u_connections, otherDataPosition, 4096.0).a;\n    avgDegree = max((otherNumConnections + numConnections * 3.0) / 4.0, 4.0);\n#endif\n\n  vec2 delta = getDelta(myPosition.xy, otherPosition.xy);\n  float dist = length(delta);\n\n  float F = (dist * dist * springFScale) / (u_baseLength * avgDegree);\n  if (u_collisionMultiplier > 0.0) {\n    F *= u_collisionMultiplier;\n  }\n  return (-delta / dist) * F;\n}\n\nvec2 getCollisionForce(float combinedNodeSize, float dist, float fScale, vec2 delta) {\n  float collisionForce = ((combinedNodeSize - dist) / dist);\n  if (u_collisionMultiplier > 0.0) {\n    collisionForce *= u_collisionMultiplier;\n  }\n  return (delta * collisionForce * fScale * combinedNodeSize) / (combinedNodeSize + 1.0);\n}\n\nvec2 getRepulsionForce(float dist, float fScale, vec2 delta) {\n  float F = (u_baseLength * u_baseLength * (fScale / 1.5)) / dist;\n  return (delta / dist) * F * 0.05;\n}\n\nvoid main(void) {\n  float textureSide = 256.0; //#TEXTURE_SIDE#;\n  float index = (gl_FragCoord.x - 0.5) + (gl_FragCoord.y - 0.5) * textureSide;\n\n  if (index >= u_numNodes) {\n    discard;\n  }\n\n  vec4 clusterData = getTextureData(u_clusterData, index, 256.0);\n\n  float clusterIndex = clusterData.x;\n  float clusterStartIndex = clusterData.y;\n  float clusterSize = clusterData.z;\n  float clusterWeight = clusterData.w;\n\n  vec4 myPosition = getTextureData(u_physData, index, 256.0);\n  vec4 previousForce = getTextureData(u_prevForce, clusterIndex, 256.0);\n\n  vec2 acceleration = previousForce.xy;\n\n  float isPinned = getTextureData(u_pinnedNodes, index, 256.0).a;\n  float nodeSize = getTextureData(u_sizeTexture, index, 256.0).a;\n\n  if (isPinned > 0.5) {\n    gl_FragColor = vec4(myPosition.xy, 0.0, 0.0);\n    return;\n  }\n\n  float curConnection = getTextureData(u_connectionOffsets, index, 256.0).a;\n  float numConnections = getTextureData(u_connections, curConnection, 4096.0).a;\n\n  float fScale = 1.0 + sqrt(u_iterationMultiplier);\n  float springFScale = fScale;\n\n  if (numConnections > denseNodeThreshold) {\n    springFScale = sqrt(fScale);\n  }\n\n  float numOfRels = 0.0;\n\n  // Springs\n  for (float i = 1.0; i <= 256.0 * 256.0; i++) {\n    if (numOfRels >= numConnections) {\n      break;\n    }\n    acceleration += getSpringForce(curConnection, numConnections, springFScale, myPosition, i);\n    numOfRels += 1.0;\n  }\n\n  // Repulsion && collision detection\n  if (u_collisionMultiplier > 0.0) {\n    float number_of_collisions = 0.0;\n    for (float i = 0.0; i < 256.0 * 256.0; i++) {\n      if (i >= u_numNodes) {\n        break;\n      }\n\n      if (i == index) {\n        continue;\n      }\n\n      vec4 otherPosition = getOtherNodePosition(i);\n      vec2 delta = getDelta(myPosition.xy, otherPosition.xy);\n      float dist = length(delta);\n      float combinedNodeSize = getCombinedNodeSize(i, nodeSize) * 2.0;\n\n      if (dist < combinedNodeSize && number_of_collisions < 40.0) {\n        number_of_collisions++;\n        acceleration += getCollisionForce(combinedNodeSize, dist, fScale, delta);\n      }\n\n      if (i >= clusterStartIndex && i < clusterStartIndex + clusterSize) {\n        acceleration += getRepulsionForce(dist, fScale, delta);\n      }\n    }\n  } else {\n    for (float i = 0.0; i < 256.0 * 256.0; i++) {\n      if (i >= clusterStartIndex + clusterSize || i >= u_numNodes) {\n        break;\n      }\n\n      if (i < clusterStartIndex || i == index) {\n        continue;\n      }\n\n      vec4 otherPosition = getOtherNodePosition(i);\n      vec2 delta = getDelta(myPosition.xy, otherPosition.xy);\n      float dist = length(delta);\n      float combinedNodeSize = getCombinedNodeSize(i, nodeSize);\n\n      if (dist < combinedNodeSize) {\n        acceleration += getCollisionForce(combinedNodeSize, dist, fScale, delta);\n      }\n\n      acceleration += getRepulsionForce(dist, fScale, delta);\n    }\n  }\n\n  // Gravity\n  vec2 delta = getDelta(u_gravityCenter, myPosition.xy);\n  float dist = length(delta);\n\n  vec2 grav = (delta / dist) * u_gravity * fScale;\n  acceleration += grav * smoothstep(0.0, 500.0, dist);\n\n  float accMagnitude = length(acceleration);\n  acceleration *= min(MAX_ACCELERATION, accMagnitude) / accMagnitude;\n\n  float iterationFrictionThreshold = 1000.0;\n\n  if (u_curIteration > iterationFrictionThreshold) {\n    float friction = 1.0 + pow((u_curIteration - iterationFrictionThreshold), 2.0) / 100.0;\n    acceleration *= 1.0 / friction;\n  }\n\n  if (u_curIteration == 0.0) {\n    gl_FragColor = vec4(myPosition.xy, acceleration * TIMESTEP * 0.5);\n  } else {\n    myPosition.zw = myPosition.zw * VELOCITYDECAY;\n    gl_FragColor = vec4(myPosition.xy + myPosition.zw * TIMESTEP, myPosition.zw + acceleration * TIMESTEP);\n  }\n}",{INTEL_WORKAROUND:this.intelWorkaround?1:0}),this._physShader.use(),this._physShader.setUniform("u_projection",this._physProjection),this._physShader.setUniform("u_baseLength",this._getBaseLength()),this._physShader.setUniform("u_connections",this._springTexture),this._physShader.setUniform("u_sizeTexture",this._sizeTexture),this._physShader.setUniform("u_connectionOffsets",this._offsetTexture),this._physShader.setUniform("u_pinnedNodes",this._pinTexture),this._physShader.setUniform("u_gravityCenter",this.nodeCenterPoint),this._physShader.setUniform("u_numNodes",this._numNodes),this._physShader.setUniform("u_gravity",this.gravity)}},{key:"_setupPhysicsForCoarse",value:function(){var t=this,e=this._gl;this.levelsData=[],this.levelsClusterTexture=[],this.levelsFinestIndexTexture=[];var n,r,i=this.subGraphs.length,o=function(t,e,r,i,o){n[4*t+0]=e,n[4*t+1]=r,n[4*t+2]=o.size(),n[4*t+3]=i||1};if(1===i){n=new Float32Array(262144);var a=this.subGraphs[0].nodes;a.forEach((function(t,e){o(e,0,0,t.weight,{size:function(){return a.length}})})),this.levelsClusterTexture[0]=this._newTexture(e,n,hi)}else for(var s=function(){var i=t.subGraphs[u].nodes,a=u===t.subGraphs.length-1?[]:t.subGraphs[u+1].nodes;n=new Float32Array(262144),r=new Float32Array(65536);var s=0;if(a.length>0){var l=a.slice();l.sort((function(t,e){return t.previousIndex-e.previousIndex})),l.forEach((function(t,e){var n=s,u=a.indexOf(t);o(s,u,n,i[t.id].weight,t),r[s]=i[s].finestIndex,s++,t.planets.forEach((function(e){o(s,u,n,e.weight,t),r[s]=i[s].finestIndex,s++,e.moons.forEach((function(e){o(s,u,n,e.weight,t),r[s]=i[s].finestIndex,s++}))}))}))}else i.forEach((function(t,e){o(e,0,0,t.weight,{size:function(){return i.length}}),r[e]=i[e].finestIndex}));var c=t._newTexture(e,null,hi),h=t._newFramebuffer(e,c);t.levelsData[u]={texture:c,frameBuffer:h},t.levelsClusterTexture[u]=t._newTexture(e,n,hi),t.levelsFinestIndexTexture[u]=t._newTexture(e,r,cr,e.FLOAT,e.ALPHA)},u=this.subGraphs.length-1;u>=0;u--)s();for(var l=new Float32Array(262144),c=0;c<l.length;c++)l[c]=0;this.initalLevelTexture=this._newTexture(e,l,hi),this._apprxRepForceShader=new Kr(e,Qr,"precision mediump float;\nuniform sampler2D u_physData;\nuniform sampler2D u_clusterData;\nuniform sampler2D u_finestIndexes;\nuniform sampler2D u_prevForce;\n\nuniform float u_baseLength;\nuniform float u_numNodes;\nuniform float u_iterationMultiplier;\nuniform float u_isTopLevel;\n\nfloat TIMESTEP = 1.0 / 30.0;\nfloat VELOCITYDECAY = 0.6;\n\nvec4 getTextureData(sampler2D texture, float index, float base) {\n  float x = mod(index, base);\n  float y = (index - x) / base;\n  return texture2D(texture, vec2(x + 0.5, y + 0.5) / base);\n}\n\nfloat getLogClusterWeight(float value) {\n  return value / max(log(value), 1.0);\n}\n\nvoid main(void) {\n  float index = (gl_FragCoord.x - 0.5) + (gl_FragCoord.y - 0.5) * 256.0;\n\n  if (index >= u_numNodes) {\n    discard;\n  }\n\n  vec4 clusterData = getTextureData(u_clusterData, index, 256.0);\n\n  float clusterIndex = clusterData.x;\n  float clusterStartIndex = clusterData.y;\n  float clusterSize = clusterData.z;\n\n  float finestIndex = getTextureData(u_finestIndexes, index, 256.0).a;\n  vec4 myPosition = getTextureData(u_physData, finestIndex, 256.0);\n  vec4 previousForce = getTextureData(u_prevForce, clusterIndex, 256.0);\n  float fScale = 1.0 + sqrt(u_iterationMultiplier);\n\n  vec2 acceleration = previousForce.xy;\n\n  // Repulsion & Collision Detection\n  for (float i = 0.0; i < 256.0 * 256.0; i++) {\n    if (i >= clusterStartIndex + clusterSize || i >= u_numNodes) {\n      break;\n    }\n    if (i < clusterStartIndex || i == index) {\n      continue;\n    }\n\n    vec4 otherClusterData = getTextureData(u_clusterData, i, 256.0);\n    float otherClusterWeight = getLogClusterWeight(otherClusterData.w);\n\n    float otherFinestIndex = getTextureData(u_finestIndexes, i, 256.0).a;\n    vec4 otherPosition = getTextureData(u_physData, otherFinestIndex, 256.0);\n\n    vec2 delta = myPosition.xy - otherPosition.xy;\n    float dist = max(length(delta), 0.0000001);\n    float maxDist = 25.0;\n    float repulsionForceScale = 0.1;\n\n    float F = ((u_baseLength * u_baseLength) * (fScale / 1.5)) / dist;\n\n    if (u_isTopLevel == 1.0) {\n      repulsionForceScale = 0.3;\n    }\n\n    acceleration += ((delta / dist) * F) * repulsionForceScale * otherClusterWeight;\n\n    if (dist < maxDist) {\n      float collide = (maxDist - dist) / dist;\n      acceleration += delta * collide * fScale * maxDist / (maxDist + 1.0);\n    }\n  }\n\n  gl_FragColor = vec4(acceleration, vec2(finestIndex, 0));\n}"),this._apprxRepForceShader.use(),this._apprxRepForceShader.setUniform("u_projection",this._physSmallProjection)}},{key:"_setupPinData",value:function(){var t=this._gl;this._pinTexture=t.createTexture(),this._pinData=new Uint8Array(65536);for(var e=0;e<65536;e++)this._pinData[e]=0;t.bindTexture(t.TEXTURE_2D,this._pinTexture),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,cr,cr,0,t.ALPHA,t.UNSIGNED_BYTE,this._pinData),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}},{key:"_setupUpdates",value:function(){var t=this._gl;this._updateData=new Float32Array(65536),this._updateTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._updateTexture),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,cr,cr,0,t.ALPHA,t.FLOAT,this._updateData),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this._updateShader=new Kr(t,Qr,"precision mediump float;\n\nuniform sampler2D u_physData;\nuniform sampler2D u_updateData;\nuniform float u_numNodesNew;\n\nconst float INDEX_FLAG = 999999.0;\n\nvec4 getTextureData(sampler2D texture, float index, float base) {\n  float x = mod(index, base);\n  float y = (index - x) / base;\n  return texture2D(texture, vec2(x + 0.5, y + 0.5) / base);\n}\n\nvoid main(void) {\n  float textureSide = 256.0; //#TEXTURE_SIDE#;\n  float index = (gl_FragCoord.x - 0.5) + (gl_FragCoord.y - 0.5)*textureSide;\n\n  if (index >= u_numNodesNew) {\n    discard;\n  }\n\n  float firstValue = getTextureData(u_updateData, index * 2.0, 256.0).a;\n  float secondValue = getTextureData(u_updateData, index * 2.0 + 1.0, 256.0).a;\n\n  if (secondValue == INDEX_FLAG) {\n    vec4 myPosition = getTextureData(u_physData, firstValue, 256.0);\n    gl_FragColor = myPosition;\n  } else {\n    gl_FragColor = vec4(firstValue, secondValue, 0.0, 0.0);\n  }\n}\n"),this._updateShader.use(),this._updateShader.setUniform("u_projection",this._physProjection)}},{key:"_setupReadpixelWorkaround",value:function(){var t=this._gl;this._workaroundShader=new Kr(t,Qr,"precision lowp float;\n\nuniform sampler2D u_physData;\nuniform float u_index;\n\nfloat shift_right (float v, float amt) { \n    v = floor(v) + 0.5; \n    return floor(v / exp2(amt)); \n}\n\nfloat shift_left (float v, float amt) { \n    return floor(v * exp2(amt) + 0.5); \n}\n\nfloat mask_last (float v, float bits) { \n    return mod(v, shift_left(1.0, bits)); \n}\n\nfloat extract_bits (float num, float from, float to) { \n    from = floor(from + 0.5); to = floor(to + 0.5); \n    return mask_last(shift_right(num, from), to - from); \n}\n\n// From https://stackoverflow.com/questions/17981163/webgl-read-pixels-from-floating-point-render-target\nvec4 encode_float (float val) { \n    if (val == 0.0) return vec4(0, 0, 0, 0); \n    float sign = val > 0.0 ? 0.0 : 1.0; \n    val = abs(val); \n    float exponent = floor(log2(val)); \n    float biased_exponent = exponent + 127.0; \n    float fraction = ((val / exp2(exponent)) - 1.0) * 8388608.0; \n    float t = biased_exponent / 2.0; \n    float last_bit_of_biased_exponent = fract(t) * 2.0; \n    float remaining_bits_of_biased_exponent = floor(t); \n    float byte4 = extract_bits(fraction, 0.0, 8.0) / 255.0; \n    float byte3 = extract_bits(fraction, 8.0, 16.0) / 255.0; \n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extract_bits(fraction, 16.0, 23.0)) / 255.0; \n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0; \n    return vec4(byte4, byte3, byte2, byte1); \n}\n\nvoid main(void) {\n  vec4 texData = texture2D(u_physData, gl_FragCoord.xy / 255.0);\n  float data;\n  if (u_index == 0.0) {\n    data = texData.x;\n  } else if (u_index == 1.0) {\n    data = texData.y;\n  } else if (u_index == 2.0) {\n    data = texData.z;\n  } else if (u_index == 3.0) {\n    data = texData.w;\n  }\n\n  gl_FragColor = encode_float(data);\n}\n"),this._workaroundShader.use(),this._workaroundShader.setUniform("u_projection",this._physProjection),this._workaroundData=[];for(var e=0;e<4;e++){var n=new Uint8Array(262144),r=this._newTexture(t,null,cr,t.UNSIGNED_BYTE),i=this._newFramebuffer(t,r);this._workaroundData.push({dataByte:n,dataFloat:new Float32Array(n.buffer),texture:r,fb:i})}}},{key:"_doReadpixelWorkaround",value:function(){for(var t=this._gl,e=0;e<4;e++){var n=this._workaroundData[e];t.bindFramebuffer(t.FRAMEBUFFER,n.fb),t.viewport(0,0,cr,cr),this._workaroundShader.use(),this._workaroundShader.setUniform("u_index",e),this._workaroundShader.setUniform("u_physData",this._getPhysData(0).texture),t.bindBuffer(t.ARRAY_BUFFER,this._physVbo),this._workaroundShader.setAttributePointer("a_position",2,0,2),t.drawArrays(t.TRIANGLE_STRIP,0,4),t.readPixels(0,0,cr,cr,t.RGBA,t.UNSIGNED_BYTE,n.dataByte)}}},{key:"_definePhysicsArrays",value:function(){this._physData=[],this.levelsData=[],this.levelsClusterTexture=[],this.levelsFinestIndexTexture=[]}}],n&&si(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function pi(t){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pi(t)}function vi(t){return function(t){if(Array.isArray(t))return gi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return gi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gi(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function yi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==pi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==pi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===pi(i)?i:String(i)),r)}var i}var mi="ForceCytoLayout",_i="forceDirected",bi="coseBilkent",xi=100,wi=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e.state,i=e.isCytoscapeEnabled;this.isCytoscapeEnabled=null==i||i,this._physLayout=new di(e),this._coseBilkentLayout=new Vr({state:r,cytoCompleteCallback:function(){for(n._physLayout.update(!0),n.copyLayoutPositions(n._state.nodes.items,n._coseBilkentLayout,n._physLayout);n._physLayout.update(!1););n.copyLayoutPositions(n._state.nodes.items,n._physLayout,n._coseBilkentLayout)},animationCompleteCallback:function(){n._currentLayoutType===bi&&setTimeout((function(){return n._setLayout(_i,!1)}),50)}}),this._currentLayout=this._physLayout,this._currentLayoutType=_i;var o=r.nodes,a=r.rels;o.addChannel(mi),a.addChannel(mi),this._state=r}var e,n;return e=t,n=[{key:"setOptions",value:function(t){t&&(this._currentLayout.setOptions(t),this.isCytoscapeEnabled=t.isCytoscapeEnabled)}},{key:"_getLayout",value:function(t){return t===bi?this._coseBilkentLayout:this._physLayout}},{key:"_setLayout",value:function(t){if(t!==this._currentLayoutType){jr.info("Switching to layout: ".concat(t," in ForceCyto"));var e=this._getLayout(t);this._currentLayout=e,this._currentLayoutType=t}}},{key:"copyLayoutPositions",value:function(t,e,n){var r=e.getNodePositions(t);n.updateNodes(r)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._state,n=e.nodes,r=e.rels,i=n.channels[mi],o=r.channels[mi],a=Object.values(i.adds).length,s=Object.values(o.adds).length,u=Object.values(i.adds).map((function(t){return t.id})),l=Object.values(o.adds).map((function(t){return t.id})),c=new Set(Object.keys(i.adds)),h=new Set(Object.keys(o.adds));if(n.clearChannel(mi),r.clearChannel(mi),this._currentLayoutType===_i&&this.isCytoscapeEnabled&&n.items.length<=xi&&a<xi&&a>0&&s>0){var f=n.items.map((function(t){return t.id})),d=new Set([].concat(vi(f),vi(u))),p=r.items.map((function(t){return t.id})),v=new Set([].concat(vi(p),vi(l)));if(d.size<=xi&&v.size<=300){var g=_r(c,h,n,r),y=g.connectedNodes,m=g.connectedRels,_=Object.values(y),b=Object.values(m),x=_.length,w=b.length;x===c.size&&w===h.size&&(h.size>0||c.size>0)?(this._setLayout(bi),this._currentLayout.update(!0,n.items,r.items)):w>0&&h.size/w>.25&&(this._setLayout(bi),this._currentLayout.update(!0,_,b))}}this._physLayout.update(t),this._coseBilkentLayout.update(t)}},{key:"getShouldUpdate",value:function(){return this._currentLayout.getShouldUpdate()}},{key:"getComputing",value:function(){return this._currentLayout.getComputing()}},{key:"updateNodes",value:function(t){this._setLayout(_i),this._physLayout.updateNodes(t)}},{key:"getNodePositions",value:function(t){return this._currentLayout.getNodePositions(t)}},{key:"terminateUpdate",value:function(){this._physLayout.terminateUpdate(),this._coseBilkentLayout.terminateUpdate()}},{key:"destroy",value:function(){this._physLayout.destroy(),this._coseBilkentLayout.destroy()}}],n&&yi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();const Ti="FreeLayout";class Si{state;positions;shouldUpdate;stateDisposers;constructor(t){const{state:e}=t;this.state=e,this.positions={},this.stateDisposers=[],this.stateDisposers.push(this.state.reaction((()=>this.state.graphUpdates),(()=>{void 0!==this.state.nodes.version&&(this.shouldUpdate=!0),void 0!==this.state.rels.version&&(this.shouldUpdate=!0)})));const{nodes:n,rels:r}=this.state;n.addChannel(Ti),r.addChannel(Ti),this.shouldUpdate=!0,this.setOptions(),this.layout(n.items,n.idToItem,n.idToPosition)}setOptions(){}updateNodes(t){for(const e of t)void 0!==e.x&&void 0!==e.y&&(this.positions[e.id]={x:e.x,y:e.y}),this.shouldUpdate=!0}update(t=!1){if(this.shouldUpdate||t){const{nodes:t,rels:e}=this.state,n=Object.values(t.channels[Ti].adds).length>0,r=Object.values(e.channels[Ti].adds).length>0,i=Object.values(t.channels[Ti].removes).length>0,o=Object.values(e.channels[Ti].removes).length>0;(n||r||i||o)&&this.layout(t.items,t.idToItem,t.idToPosition),t.clearChannel(Ti),e.clearChannel(Ti)}this.shouldUpdate=!1}layout(e,n,r){const i=void 0!==(o=e)?dn(o):o;var o;if((0,t.isEmpty)(i))return;const a={};for(let t=0;t<i.length;++t){const{id:e}=i[t],{x:n=0,y:o=0}=r[e]??{};a[e]={id:e,x:n,y:o}}this.positions=a,this.shouldUpdate=!1}setNodePositions(t){this.positions=t}getNodePositions(t){const e=[];for(const n of t){const t=this.positions[n.id],r={id:n.id,...t};e.push(r)}return e}getShouldUpdate(){return this.shouldUpdate}getComputing(){return!1}terminateUpdate(){}destroy(){this.state.nodes.removeChannel(Ti),this.state.rels.removeChannel(Ti)}}function Ai(t){return Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ai(t)}function Ei(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ci(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ei(Object(n),!0).forEach((function(e){Ri(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ei(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ri(t,e,n){return(e=ki(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Di(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Di(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Di(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Oi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ki(r.key),r)}}function ki(t){var e=function(t,e){if("object"!==Ai(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ai(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Ai(e)?e:String(e)}var Ii="GridLayout",Li=function(){function e(t){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=t.state;this.state=r,this.positions={},this.stateDisposers=[],this.stateDisposers.push(this.state.reaction((function(){return n.state.graphUpdates}),(function(){void 0!==n.state.nodes.version&&(n.shouldUpdate=!0),void 0!==n.state.rels.version&&(n.shouldUpdate=!0)})));var i=this.state,o=i.nodes,a=i.rels;o.addChannel(Ii),a.addChannel(Ii),this.shouldUpdate=!0,this.setOptions(t),this.layout(o.items,o.idToItem,o.idToPosition,a.items)}var n,r;return n=e,r=[{key:"setOptions",value:function(t){}},{key:"updateNodes",value:function(t){var e,n=Pi(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;void 0!==r.x&&void 0!==r.y&&(this.positions[r.id]={x:r.x,y:r.y}),this.shouldUpdate=!0}}catch(t){n.e(t)}finally{n.f()}}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.shouldUpdate||t){var e=this.state,n=e.nodes,r=e.rels,i=Object.values(n.channels[Ii].adds).length>0,o=Object.values(r.channels[Ii].adds).length>0,a=Object.values(n.channels[Ii].removes).length>0,s=Object.values(r.channels[Ii].removes).length>0;(i||o||a||s)&&(this.layout(n.items,n.idToItem,n.idToPosition,r.items),n.idToPosition=this.positions),n.clearChannel(Ii),r.clearChannel(Ii)}this.shouldUpdate=!1}},{key:"layout",value:function(e,n,r,i){var o;if(e=(o=e)?dn(o):o,!(0,t.isEmpty)(e)){for(var a=e.length,s=Math.ceil(Math.sqrt(a)),u=new Array(a),l=0,c=0;c<s;++c){for(var h=0;h<s&&(u[l]={y:0+150*c,x:0+150*h},++l!==a);++h);if(l===a)break}for(var f=e.sort(),d={},p=0;p<a;++p){var v=f[p],g=u[p];v.x===g.x&&v.y===g.y||(d[v.id]=Ci({id:v.id},g))}this.positions=d,this.shouldUpdate=!1}}},{key:"getNodePositions",value:function(t){var e,n=[],r=Pi(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,o=this.positions[i.id],a=Ci({id:i.id},o);n.push(a)}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"getShouldUpdate",value:function(){return this.shouldUpdate}},{key:"getComputing",value:function(){return!1}},{key:"terminateUpdate",value:function(){this.shouldUpdate=!1}},{key:"destroy",value:function(){this.state.nodes.removeChannel(Ii),this.state.rels.removeChannel(Ii)}}],r&&Oi(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();const Mi="down",Ni={up:"BT",[Mi]:"TB",left:"RL",right:"LR"},ji="bin",Ui=[ji,"stack"],Fi="HierarchicalLayout",zi=t=>void 0!==t?dn(t):t;class Bi extends zr{direction;packing;stateDisposers;oldComputing;computing;pendingLayoutData;worker;directionChanged;packingChanged;constructor(t){super(t),this.direction=Mi,this.packing=ji;const{nodes:e,rels:n}=this.state;e.addChannel(Fi),n.addChannel(Fi),this.stateDisposers=[this.state.reaction((()=>this.state.graphUpdates),(()=>{if(void 0!==e.version){const t=e.channels[Fi],n=Object.values(t.adds).length>0,r=Object.values(t.removes).length>0,i=((t=[])=>Boolean(t.find((t=>"size"in t))))(Object.values(t.updates));this.shouldUpdate=this.shouldUpdate||n||r||i}if(void 0!==n.version){const t=n.channels[Fi],e=Object.values(t.adds).length>0,r=Object.values(t.removes).length>0;this.shouldUpdate=this.shouldUpdate||e||r}}))],this.shouldUpdate=!0,this.oldComputing=!1,this.computing=!1,this.pendingLayoutData=null,this.worker=(0,Ur.createHierarchicalLayoutWorker)(),this.worker.port.start(),this.setOptions(t),this.layout(e.items,e.idToItem,e.idToPosition,n.items)}setOptions(t){if(void 0===t)return;const{direction:e=Mi,packing:n=ji}=t;Object.keys(Ni).includes(e)&&(this.directionChanged=this.direction&&this.direction!==e,this.direction=e),Ui.includes(n)&&(this.packingChanged=this.packing&&this.packing!==n,this.packing=n),this.shouldUpdate=this.directionChanged||this.packingChanged}update(t=!1){if(this.shouldUpdate||t){const{nodes:e,rels:n}=this.state,{directionChanged:r,packingChanged:i}=this,o=Object.values(e.channels[Fi].adds).length>0,a=Object.values(n.channels[Fi].adds).length>0,s=Object.values(e.channels[Fi].removes).length>0,u=Object.values(n.channels[Fi].removes).length>0,l=((t=[])=>Boolean(t.find((t=>"size"in t))))(Object.values(e.channels[Fi].updates));(t||o||a||s||u||r||i||l)&&this.layout(e.items,e.idToItem,e.idToPosition,n.items),e.clearChannel(Fi),n.clearChannel(Fi),this.directionChanged=!1,this.packingChanged=!1}super.update(),this.shouldUpdate=!1,this.oldComputing=this.computing}getShouldUpdate(){return this.shouldUpdate||this.shouldUpdateAnimator}getComputing(){return this.computing}layout(t,e,n,r){const i=zi(t).map((({html:t,...e})=>e)),o=zi(e),a={};Object.keys(o).forEach((t=>{const{html:e,...n}=o[t];a[t]=n}));const s=zi(r).map((({captionHtml:t,...e})=>e)),u=zi(n),{direction:l,packing:c}=this,h=window.devicePixelRatio,f={nodes:i,nodeIds:a,idToPosition:u,rels:s,direction:l,packing:c,pixelRatio:h,forcedDelay:0};this.computing?this.pendingLayoutData=f:(this.worker.port.onmessage=({data:{positions:t,parents:e,waypoints:n}})=>{this.computing&&(this.positions=t),this.parents=e,this.state.setWaypoints(n),null!==this.pendingLayoutData?(this.worker.port.postMessage(this.pendingLayoutData),this.pendingLayoutData=null):this.computing=!1,this.shouldUpdate=!0,this.startAnimation()},this.computing=!0,this.worker.port.postMessage(f))}terminateUpdate(){this.computing=!1,this.shouldUpdate=!1,this.state.nodes?.clearChannel(Fi),this.state.rels?.clearChannel(Fi)}destroy(){this.stateDisposers.forEach((t=>{t()})),this.state.nodes.removeChannel(Fi),this.state.rels.removeChannel(Fi),this.worker.port.close()}}var Vi=r(804),Gi=r.n(Vi);const Wi=(t=[],e=0)=>{const n={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(let e=0;e<t.length;e++)n.minX>t[e].x&&(n.minX=t[e].x),n.minY>t[e].y&&(n.minY=t[e].y),n.maxX<t[e].x&&(n.maxX=t[e].x),n.maxY<t[e].y&&(n.maxY=t[e].y);return{centerX:(n.minX+n.maxX)/2,centerY:(n.minY+n.maxY)/2,nodesWidth:n.maxX-n.minX+e,nodesHeight:n.maxY-n.minY+e}},Xi=(t,e,n,r)=>{let i=1/0,o=1/0;return t>1&&(i=n/t),e>1&&(o=r/e),{zoomX:i,zoomY:o}},$i=(t,e,n=0,r=1/0)=>{const i=.9*Math.min(t,e);return Math.min(r,Math.max(n,i))},Hi=(t,e,n,r)=>Math.max(Math.min(e,n),Math.min(t,r)),Yi=(t,e,n,r,i,o)=>{let a=e;return((t,e,n)=>t<e&&t<n)(i,o,e)&&t.length>1?(a=((t,e,n)=>{const r=(t=>{const e=new Array(4).fill(t[0]);return t.forEach((t=>{e[0]=t.x<e[0].x?e[0]:{...t},e[1]=t.y<e[1].y?e[1]:{...t},e[2]=t.x<e[2].x?{...t}:e[2],e[3]=t.y<e[3].y?{...t}:e[3]})),e})(t),i=((t=[])=>{let e=0,n=0;for(let r=0;r<t.length;r++)for(let i=r+1;i<t.length;i++)e=Math.hypot(Math.abs(t[r].x-t[i].x),Math.abs(t[r].y-t[i].y)),n=Math.max(n,e);return n})(r),o=e.height<=e.width?e.height-n:e.width-n;return i>o?.9*o/i:.9*i/o})(t,r,25),Hi(i,o,Math.min(e,a),n)):Hi(i,o,e,n)};function qi(t){this.channels[t]={adds:{},updates:{},removes:{}}}function Zi(t){delete this.channels[t]}function Ki(t){this.channels[t].adds={},this.channels[t].updates={},this.channels[t].removes={}}const Ji=t=>"html"in t?t.html:"captionHtml"in t?t.captionHtml:void 0;function Qi(e,n){let r=!1;for(let n of e){const{id:e}=n;if(void 0===this.idToItem[e]){if(n=(0,t.cloneDeep)(n),this.items.push(n),this.idToItem[e]=n,this.idToPosition[e]={id:e,x:0,y:0},"x"in n&&"y"in n){const{x:t,y:r}=n;isNaN(t)||isNaN(r)||(this.idToPosition[e].x=t,this.idToPosition[e].y=r)}const i=Ji(n);if(i instanceof HTMLElement){const t=document.createElement("div");Object.assign(t.style,{position:"absolute"}),t.appendChild(i),this.idToHtmlOverlay[e]=t}const o=Object.values(this.channels);for(const t of o)void 0===t.removes[e]?t.adds[e]=n:(delete t.removes[e],t.updates[e]=n);r=!0}}r&&(this.version+=1,void 0!==n&&(n.added=!0))}function to(t,e){let n=!1;for(const r of t){const{id:t}=r,i=this.idToItem[t];if(void 0!==i){Object.assign(i,r);const n=Ji(r);if(n instanceof HTMLElement){this.idToHtmlOverlay[t]?.remove(),delete this.idToHtmlOverlay[t];const e=document.createElement("div");Object.assign(e.style,{position:"absolute"}),e.appendChild(n),this.idToHtmlOverlay[t]=e}const o=Object.values(this.channels);for(const e of o){if(void 0!==e.adds[t])continue;let n=e.updates[t];void 0===n&&(n={id:t},e.updates[t]=n),Object.assign(n,r)}void 0!==e&&(e.updated=!0)}n=!0}n&&(this.version+=1)}function eo(t,e){let n=!1;for(const e of t){const t=this.idToItem[e];if(void 0!==t){n=!0,delete this.idToItem[t.id],delete this.idToPosition[t.id],this.idToHtmlOverlay[t.id]?.remove(),delete this.idToHtmlOverlay[t.id],this.items.splice(this.items.indexOf(t),1);const r=Object.values(this.channels);for(const n of r)void 0!==n.adds[e]?delete n.adds[e]:(delete n.updates[e],n.removes[e]=t)}}n&&(void 0!==e&&(e.removed=!0),this.version+=1)}function no(t){for(const e of t)if(void 0!==this.idToPosition[e.id]){const t=this.idToPosition[e.id];Object.assign(t,e)}else this.idToPosition[e.id]={id:e.id,x:e.x,y:e.y,pinned:e.pinned}}function ro(t){for(const e in this.idToHtmlOverlay){const n=this.idToHtmlOverlay[e];t.appendChild(n)}}const io=()=>({idToItem:Nt.shallow({}),items:Nt.shallow([]),channels:Nt.shallow({}),idToPosition:Nt.shallow({}),idToHtmlOverlay:Nt.shallow({}),version:0,addChannel:Q(qi),removeChannel:Q(Zi),clearChannel:Q(Ki),add:Q(Qi),update:Q(to),remove:Q(eo),updatePositions:Q(no),updateHtmlOverlay:Q(ro)}),oo={rings:[{widthFactor:.05,color:"#fff"},{widthFactor:.1,color:"#45bff8"}],shadow:{width:10,opacity:1,color:"#bbb"}},ao={rings:[]},so=.75,uo="forceDirected",lo="hierarchical",co="grid",ho="free",fo="d3Force",po=e=>{const{minZoom:n,maxZoom:r,allowDynamicMinZoom:i=!0,layout:o,layoutOptions:a,nodeDefaultBorderColor:s,nodeSelectedBorderColor:u,panX:l=0,panY:c=0,initialZoom:h,useWebGL:f=!0,disableWebGL:d=!1}=e;W(!0),pn.isolateGlobalState();const p=void 0!==n?n:.075,v=void 0!==r?r:10,g={...ao};void 0!==s&&("string"==typeof s&&null!==Gi().get.rgb(s)?g.rings=[{color:s,widthFactor:.05}]:jr.warn("Invalid color string for nodeDefaultBorderColor:",s));const y={...oo};void 0!==u&&("string"==typeof s&&null!==Gi().get.rgb(u)?y.rings[1].color=u:jr.warn("Invalid color string for nodeSelectedBorderColor:",u));const m=Nt({zoom:h||so,minimapZoom:so,defaultZoomLevel:so,panX:l,panY:c,minimapPanX:0,minimapPanY:0,fitNodeIds:[],resetZoom:!1,zoomOptions:{},forceWebGL:!1,useWebGL:f,disableWebGL:d,fitMovement:0,layout:o,layoutOptions:a,maxDistance:0,maxNodeRadius:50,nodeBorderStyles:{default:g,selected:y},get minZoom(){return p},get maxZoom(){return v},get minMinimapZoom(){return 0},get maxMinimapZoom(){return.2},get webGLVisible(){const t=this.fitMovement>50;return this.useWebGL||t},nodes:io(),rels:io(),graphUpdates:0,waypoints:{data:Nt.shallow({}),counter:0},setGraphUpdated:Q((function(){this.graphUpdates++})),setUseWebGLRenderer:Q((function(t){Q((function(){this.graphUpdates++})),this.useWebGL=t})),setWaypoints:Q((function(t){this.waypoints.data=t,this.waypoints.counter+=1})),setZoomPan:Q((function(t,e,n,r){if(i){const i=Object.values(this.nodes.idToPosition),o=Yi(i,p,v,r,t,this.zoom);o!==this.zoom&&(this.zoom=o,t===o&&(this.panX=e,this.panY=n))}else{const r=Hi(t,this.zoom,p,v);r!==this.zoom&&(this.zoom=r,this.panX=e,this.panY=n)}this.fitNodeIds=[],this.resetZoom=!1,this.forceWebGL=!1})),setZoom:Q((function(t,e){if(i){const n=Object.values(this.nodes.idToPosition);this.zoom=Yi(n,p,v,e,t,this.zoom)}else this.zoom=Hi(t,this.zoom,p,v);this.fitNodeIds=[],this.fitMovement=0,this.resetZoom=!1,this.forceWebGL=!1})),setPan:Q((function(t,e){this.panX=t,this.panY=e,this.fitNodeIds=[],this.resetZoom=!1,this.forceWebGL=!1})),setLayout:Q((function(t){this.layout=t})),setLayoutOptions:Q((function(t){this.layoutOptions=t})),fitNodes:Q((function(e,n){this.fitNodeIds=(0,t.intersection)(e,(0,t.map)(this.nodes.items,"id")),this.zoomOptions=n??{}})),setZoomReset:Q((function(){this.resetZoom=!0})),clearFit:Q((function(){this.fitNodeIds=[],this.forceWebGL=!1,this.fitMovement=0})),clearReset:Q((function(){this.resetZoom=!1,this.fitMovement=0})),updateZoomToFit:Q((function(t,e,n,r){let o;if(this.fitMovement=Math.abs(t-this.zoom)+Math.abs(e-this.panX)+Math.abs(n-this.panY),i){const e=Object.values(this.nodes.idToPosition);o=Yi(e,p,v,r,t,this.zoom)}else o=Hi(t,this.zoom,p,v);this.zoom=o,this.panX=e,this.panY=n})),updateMinimapZoomToFit:Q((function(t,e,n){this.minimapZoom=t,this.minimapPanX=e,this.minimapPanY=n})),autorun:ct,reaction:ht});return m};class vo{elementId;currentValue;startValue;currentTime;duration;status;endValue;startTime;endTime;hasNextAnimation;constructor(t,e){this.elementId=t,this.startValue=e,this.status=0,this.currentValue=e,this.duration=0}setDuration(t){this.duration=t,this.setEndTime(this.startTime+this.duration)}getStatus(){return this.status}advance(){if(1!==this.status)return!1;this.currentTime=(new Date).getTime();const t=this.endTime-this.startTime;let e;return e=t>0?(this.currentTime-this.startTime)/t:1,e>=1?(this.currentValue=this.endValue,this.status=2):(this.currentValue=this.startValue+e*(this.endValue-this.startValue),this.hasNextAnimation=!0),this.hasNextAnimation}setEndValue(t){this.endValue!==t&&(t-this.currentValue!=0?(this.currentTime=(new Date).getTime(),this.status=1,this.startValue=this.currentValue,this.endValue=t,this.startTime=this.currentTime,this.setEndTime(this.startTime+this.duration)):this.endValue=t)}setEndTime(t){this.endTime=Math.max(t,this.startTime)}}class go{animations;durations;defaultDuration;hasNextAnimation;ignoreAnimationsFlag;constructor(){this.animations=new Map,this.durations=[],this.durations[0]=0,this.durations[1]=0,this.defaultDuration=150,this.hasNextAnimation=!1,this.ignoreAnimationsFlag=!1}advance(){return this.hasNextAnimation=!1,this.animations.forEach((t=>{Object.values(t).forEach((t=>{t.advance()&&(this.hasNextAnimation=!0)}))})),this.hasNextAnimation}ignoreAnimations(t){this.ignoreAnimationsFlag=t}setOptions(t){void 0!==t.fadeDuration&&(this.durations[0]=t.fadeDuration),void 0!==t.sizeDuration&&(this.durations[1]=t.sizeDuration)}needsToRun(){return this.hasNextAnimation}getValueForAnimationName(t,e,n,r=1){if(this.ignoreAnimationsFlag)return n;let i;const o=this.getById(t)??{};if(void 0===o[e]){const o=1===r?this.createSizeAnimation(0,t,e):this.createFadeAnimation(0,t,e);o.setEndValue(n),i=o.currentValue}else{const t=o[e];if(t.currentValue===n)return n;t.setEndValue(n),i=t.currentValue}return this.hasNextAnimation=!0,i}createAnimation(t,e,n){const r=new vo(e,t),i=this.animations.get(e)??{};return this.animations.set(e,{...i,[n]:r}),r}getById(t){return this.animations.get(t)}createFadeAnimation(t,e,n){const r=this.createAnimation(t,e,n);return r.setDuration(this.durations[0]||this.defaultDuration),r}createSizeAnimation(t,e,n){const r=this.createAnimation(t,e,n);return r.setDuration(this.durations[1]||this.defaultDuration),r}}const yo=64;class mo{key;rels;waypointPath;selfReferring;fromId;toId;angles;labelInfo;constructor(t,e,n){this.key=t,this.rels=[],this.selfReferring=e===n,this.fromId=e,this.toId=n,this.labelInfo={},this.angles=[]}insert(t){this.rels.push({rel:t})}setLabelInfo(t,e){this.labelInfo[t]=e}remove({id:t}){const{rels:e}=this,n=e.findIndex((e=>e.rel.id===t));if(-1!==n&&(e.splice(n,1),0===n&&e.length>0)){const{rel:{from:t,to:n}}=e[0];this.fromId=t,this.toId=n}}size(){return this.rels.length}maxFontSize(){return Math.max(...this.rels.map((({rel:e})=>(0,t.isNumber)(e.captionSize)?e.captionSize:1)))}relIsOppositeDirection({from:t,to:e}){const{fromId:n,toId:r}=this;return t!==n&&e!==r||t===r&&e===n}indexOf({id:t}){return this.rels.findIndex((({rel:e})=>e.id===t))}getRel(t){const{rels:e}=this;return t<0||t>=e.length?null:e[t].rel}setWaypoints(t){this.waypointPath=t}setAngles(t){this.angles=t}}const _o="#848484",bo=2*Math.PI/50,xo=.1*Math.PI,wo="white",To="#45bff8",So="#bbb",Ao=dr,Eo=t=>{const e=[];if(0===t.length)e.push({size:2*Math.PI,start:0});else{for(let n=t.length-1;n>=0;n--){let r,i;0===n?(i=t[t.length-1],r=t[n]-t[t.length-1]+2*Math.PI):(i=t[n-1],r=t[n]-t[n-1]),e.push({size:r,start:i})}e.sort(((t,e)=>e.size-t.size))}return e},Co=(t,e)=>{for(;e>t.length||t[0].size>2*t[e-1].size;)t.push({size:t[0].size/2,start:t[0].start}),t.push({size:t[0].size/2,start:t[0].start+t[0].size/2}),t.shift(),t.sort(((t,e)=>e.size-t.size));return t};class Ro{bundles;nodeToBundles;constructor(t,e){this.bundles={},this.nodeToBundles={};const n=t.reduce(((t,e)=>(t[e.id]=e,t)),{});this.updateData(n,{},e)}getBundle(t){const{bundles:e,nodeToBundles:n}=this,r=this.generatePairId(t.from,t.to);let i=e[r];return void 0===i&&(i=new mo(r,t.from,t.to),e[r]=i,void 0===n[t.from]&&(n[t.from]=[]),void 0===n[t.to]&&(n[t.to]=[]),n[t.from].push(i),n[t.to].push(i)),i}updateData(t,e,n){const{bundles:r,nodeToBundles:i}=this,o=(t,e)=>{const n=i[e].findIndex((e=>e===t));-1!==n&&i[e].splice(n,1)},a=Object.values(t),s=Object.values(e);for(const t of a)this.getBundle(t).insert(t);for(const t of s){const e=this.getBundle(t);e.remove(t),0===e.size()&&(delete r[e.key],o(e,t.from),o(e,t.to))}const u=Object.keys(r);for(const t of u){const e=r[t];e.setWaypoints(n[`${e.fromId}-${e.toId}`])}}updatePositions(t){const{nodeToBundles:e}=this,n=Object.keys(t);for(const r of n){const n=e[r]??[];if(0===n.length)continue;const i=n.find((t=>t.selfReferring)),o=n.filter((t=>!t.selfReferring));if(void 0===i)continue;const a=[];for(const e of o){const n=t[e.fromId],i=t[e.toId],o=bo*e.size(),s=n.id===r?Math.atan2(i.y-n.y,i.x-n.x):Math.atan2(n.y-i.y,n.x-i.x);for(let t=0;t<e.size();t++)a.push(s+o/2-t*bo)}const s=a.map((t=>(t+2*Math.PI)%(2*Math.PI))).sort(),u=Eo(s);Co(u,i.size());const l=u.map((t=>t.start+t.size/2)).slice(0,i.size());i.setAngles(l)}}generatePairId(t,e){return[t.toString(),e.toString()].sort(((t,e)=>t.localeCompare(e))).join("-")}}const Po=(e,n)=>(0,t.isFinite)(e.x)&&(0,t.isFinite)(e.y)&&(0,t.isFinite)(n.x)&&(0,t.isFinite)(n.y),Do=(t,e)=>{if(!t||!e||!Po(t,e))return!1;const n=e.x-t.x,r=e.y-t.y,i=vr();return n*n+r*r<100*i*i};class Oo{p1;p2;unit;norm;length;vector;constructor(t,e){this.p1=t,this.p2=e,this.vector=this.getVector(),this.length=this.getLength(),this.unit=this.getUnitVector(),this.norm=this.getUnitNormalVector()}getVector(){return{x:this.p2.x-this.p1.x,y:this.p2.y-this.p1.y}}getLength(){const{x:t,y:e}=this.vector;return Math.sqrt(t*t+e*e)}getUnitVector(){const{vector:t,length:e}=this;return{x:t.x/e,y:t.y/e}}getUnitNormalVector(){return{x:this.unit.y,y:-this.unit.x}}}const ko=(e,n,r)=>{const i={x:n.x-e.x,y:n.y-e.y},o=((e,n)=>{const r=(e.x*n.x+e.y*n.y)/(n.x*n.x+n.y*n.y);return(0,t.clamp)(r,0,1)})({x:r.x-e.x,y:r.y-e.y},i),a=e.x+o*i.x,s=e.y+o*i.y,u=a-r.x,l=s-r.y;return Math.sqrt(u*u+l*l)},Io=(t,e,n,r)=>{if(e.x===n.x&&e.y===n.y)return e;const i=e.y-t.y,o=t.x-e.x,a=i*t.x+o*t.y,s=r.y-n.y,u=n.x-r.x,l=s*n.x+u*n.y,c=i*u-s*o;return 0===c?null:{x:(u*a-o*l)/c,y:(i*l-s*a)/c}},Lo=(t,e,n,r)=>{let i,o,a,s=1e9;const u={...t},l={x:0,y:0};for(o=1;o<10;o++)a=.1*o,l.x=Math.pow(1-a,2)*t.x+2*a*(1-a)*n.x+Math.pow(a,2)*e.x,l.y=Math.pow(1-a,2)*t.y+2*a*(1-a)*n.y+Math.pow(a,2)*e.y,o>0&&(i=ko(u,l,r),s=i<s?i:s),u.x=l.x,u.y=l.y;return s},Mo=[[.04,1],[100,2]],No=[[.8,1.1],[3,1.6],[8,2.5]],jo=[[No[0][0],1],[100,1.25]],Uo=(t,e)=>{if(t.includes("rgba"))return t;if(t.includes("rgb")){const n=t.substr(t.indexOf("(")+1).replace(")","").split(",");return`rgba(${n[0]},${n[1]},${n[2]},${e})`}const n=Gi().get.rgb(t);return null===n?t:`rgba(${n[0]},${n[1]},${n[2]},${e})`},Fo=(t,e,n,r,i=!0,o=!1)=>{const{headPosition:a,headAngle:s,headHeight:u,headChinHeight:l,headWidth:c}=r;t.save(),t.lineWidth=e,t.strokeStyle=n,t.fillStyle=n,t.translate(a.x,a.y),t.rotate(s),((t,e,n,r)=>{if(t.beginPath(),e.length>0){const n=e[0];t.moveTo(n.x,n.y)}for(let n=1;n<e.length;n++){const r=e[n];t.lineTo(r.x,r.y)}t.closePath(),n&&t.fill(),r&&t.stroke()})(t,[{x:l-u,y:0},{x:-u,y:c/2},{x:0,y:0},{x:-u,y:-c/2}],i,o),t.restore()},zo=(t,e,n,r,i)=>{let o=r;i.forEach((({width:r,color:i})=>{const a=o+r;t.beginPath(),t.fillStyle=i,t.arc(e,n,a,0,2*Math.PI,!1),t.arc(e,n,o,2*Math.PI,0,!0),t.fill(),t.closePath(),o=a}))},Bo=(t,e,n,r)=>{t.beginPath(),t.arc(e,n,r,0,2*Math.PI,!1),t.closePath()},Vo=(t,e,n,r,i)=>{t.beginPath(),t.fillStyle=r,Bo(t,e,n,i),t.fill(),t.closePath()};function Go(t,e){const n=e.find((e=>t<e[0]));return void 0!==n?n[1]:e[e.length-1][1]}const Wo=(t,e,n,r,i,o,a,s,u)=>{let l=r,c=0,h=0;const f=t.measureText("...")?.width;e.forEach((e=>{t.font=`normal ${i}px ${o}`;const r=t.measureText(e.text)?.width,d=-r/2,p=e.text?[...e.text]:[];e.hasHyphenChar||e.hasEllipsisChar||p.push(" "),p.forEach((r=>{n[h]?.includes("italic")&&n[h]?.includes("bold")?t.font=`italic 600 ${i}px ${o}`:n[h]?.includes("italic")?t.font=`italic 400 ${i}px ${o}`:n[h]?.includes("bold")?t.font=`bold ${i}px ${o}`:t.font=`normal ${i}px ${o}`,n[h]?.includes("underline")&&t.fillRect(s+d+c,u+l+.2,t.measureText(r)?.width,.2),e.hasEllipsisChar?t.fillText(r,s+d+c-f/2,u+l):t.fillText(r,s+d+c,u+l),c+=t.measureText(r).width,h+=1})),t.font=`normal ${i}px ${o}`,e.hasHyphenChar&&t.fillText("-",s+d+c,u+l),e.hasEllipsisChar&&t.fillText("...",s+d+c-f/2,u+l),c=0,l+=a}))},Xo=(t,e)=>({x:t.x+e.x,y:t.y+e.y}),$o=(t,e)=>({x:t.x-e.x,y:t.y-e.y}),Ho=(t,e)=>({x:t.x*e,y:t.y*e}),Yo=(t,e)=>(t=>Math.sqrt(t.x*t.x+t.y*t.y))($o(t,e)),qo=(t,e)=>({x:Math.cos(t)*e,y:Math.sin(t)*e}),Zo=t=>!(!t||!isNaN(Number(t))||t.toLowerCase()===t.toUpperCase())&&t===t.toUpperCase(),Ko=t=>{const e=t[t.length-1],n=t[t.length-2];return!(!e||!isNaN(Number(e))||e.toLowerCase()===e.toUpperCase())&&!(!n||!isNaN(Number(n))||n.toLowerCase()===n.toUpperCase())&&Zo(e)&&!Zo(n)},Jo=t=>{const e=t.length,n=Math.min(e-1,3);if(1===e)return{hyphen:!1,cnt:0};for(let e=0;e<n;e++){const n=t[t.length-(e+1)];if(" "===n||n.toLowerCase()===n.toUpperCase())return{hyphen:!1,cnt:e+1};const r=t.slice(0,t.length-e);if(Ko(r))return{hyphen:!1,cnt:e+1}}return{hyphen:!0,cnt:1}},Qo=t=>" \t\n\r\v".includes(t),ta=(t,e,n,r,i=!1)=>{const o=[],a=[];let s,u=0,l=0,c=!1,h=!1;for(let t=0;t<r;t++)o[t]=n(t,r);for(let n=1;n<=t.length;n++){s=t.slice(u,n);let d=e(s);const p=o[l];if(d>p||(f=t[n-1],"\n\r\v".includes(f))){if(!(l<r-1)){if(i)return[];let r=n;const o=()=>t[r-1];for(;d>p;){for(r-=1;Qo(o());)r-=1;if(!(r-u>1)){s="",h=!0,c=!1;break}s=t.slice(u,r),d=e(s),h=!0,c=!1}return a[l]={text:s,hasEllipsisChar:h,hasHyphenChar:c},a}{c=!1,h=!1;const r=Jo(s);let i=n-r.cnt;if(r.hyphen)for(s=t.slice(u,i),d=e(s),c=!0;d>p;){if(!(i-u>1)){s=t[u],i=u+1,d=e(s),c=!1;break}i--,s=t.slice(u,i),d=e(s),c=!0}else s=t.slice(u,i),s=s.trim();a[l]={text:s,hasEllipsisChar:h,hasHyphenChar:c},u=i,l+=1}}}var f;return s=t.slice(u,t.length),a[l]={text:s,hasEllipsisChar:h,hasHyphenChar:!1},a},ea=(t,e,n,r)=>{const i=t.split(/\s/g).filter((t=>t.length>0)),o=[];let a=null;const s=t=>e(t)>n(o.length,r);for(const t of i){const i=a?`${a} ${t}`:t;if(e(i)<n(o.length,r))a=i;else{if(null!==a){const t=s(a);o.push({text:a,overflowed:t})}if(a=t,o.length>r)return[]}}if(a){const t=s(a);o.push({text:a,overflowed:t})}return o.length<=r?o:[]},na=(t,e,n,r,i,o,a,s)=>{t.font=`bold ${r}px ${n}`.replace(/"/g,"");const u=e=>t.measureText(e)?.width;let l=2;a===No[1][1]?l=3:a===No[2][1]&&(l=4);const c=a<No[2][1]?["",""]:[""],h=o?c.length:0,f=(t,e)=>((t,e,n,r)=>{const i=.98*n,o=.89*n,a=.95*n;return 1===e?i:2===e?a:3!==e?4!==e?5!==e?i:0===t||4===t?.65*n:1===t||3===t?o:a:0===t||3===t?.78*n:a:0===t||2===t?o:i})(t+h,e+h,i);let d=1,p=[];for(;0===p.length;){if(p=ea(e,u,f,d),0===p.length)p=ta(e,u,f,d,l>d);else if(p.some((t=>t.overflowed))){const t=d;p=p.reduce(((e,n)=>{const r=l-e.length;if(0===r){const n=e[e.length-1];return n.text.endsWith("…")||(u(n.text)+u("…")>f(e.length,t)?(e[e.length-1].text=n.text.slice(0,-2),e[e.length-1].hasEllipsisChar=!0):(e[e.length-1].text=n.text,e[e.length-1].hasEllipsisChar=!0)),e}if(n.overflowed){const t=ta(n.text,u,f,r);e=e.concat(t)}else e.push({text:n.text,hasEllipsisChar:!1,hasHyphenChar:!1});return e}),[])}else p=p.map((t=>({...t,hasEllipsisChar:!1,hasHyphenChar:!1})));d+=1}return Array.from(p)},ra=(t=[])=>{const e=t.reduce(((t,e,n)=>{const{value:r}=e;if(r){const i=`${n>0&&t.length?", ":""}${r}`;return[...t,{...e,value:i,chars:i.split("").map(((r,i)=>0!==n&&t.length&&i<2?null:[...e.styles??[]]))}]}return[]}),[]);return{stylesPerChar:e.reduce(((t,e)=>[...t,...e.chars]),[]),fullCaption:e.map((t=>t.value)).join("")}},ia=(t,e,n,r,i,o)=>{const a={x:(t.x+e.x)/2,y:(t.y+e.y)/2},s={x:t.x,y:t.y},u={x:e.x,y:e.y},l=new Oo(u,s),c=((t,e)=>{let n=0;return t&&(n+=t),e&&(n-=e),n})(r,n);a.x+=c/2*l.unit.x,a.y+=c/2*l.unit.y;const h=o.size()/2-o.indexOf(i);return a.x+=h*l.unit.x,a.y+=h*l.unit.y,a},oa=t=>{const e=vr(),n=t.selected?4:0;return((t.size||fr)+4+n)*e},aa=t=>{const e=vr();t.shadowColor=So,t.shadowBlur=18*e,t.shadowOffsetX=0*e,t.shadowOffsetY=0*e},sa=t=>{t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0},ua=(t,e,n,r,i,o=!1)=>{const a=(t,e=!1)=>{const n=t.norm.x,r=t.norm.y;return e?{x:-n,y:-r}:t.norm},s=vr(),u=e.indexOf(t),l=(e.size()-1)/2,c=u>l,h=Math.abs(u-l),f=i?17*e.maxFontSize():8,d=(e.size()-1)*f*s,p=((t,e,n,r,i,o,a,s=!1)=>{const u=vr(),l=t.size(),c=l>1,h=t.relIsOppositeDirection(o),f=h?n:e,d=h?e:n,{waypointPath:p}=t,v=p?.points,g=p?.from,y=p?.to,m=Do(f,g)&&Do(d,y)||Do(d,g)&&Do(f,y),_=m?v[1]:null,b=m?v[v.length-2]:null,x=oa(f),w=oa(d),T=(t,e)=>Math.atan2(t.y-e.y,t.x-e.x),S=Math.max(Math.PI,2*Math.PI/(l/2)),A=c?r*S*(a?1:-1)/(f.size||fr):0,E=T(m?_:d,f),C=m?T(d,b):E,R=(t,e,n,r)=>({x:t.x+Math.cos(e)*n*(r?-1:1),y:t.y+Math.sin(e)*n*(r?-1:1)}),P=(t,e)=>R(f,E+t,e,!1),D=(t,e)=>R(d,C-t,e,!0),O=(t,e)=>({x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}),k=(t,e)=>Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))*u,I=P(A,x),L=D(A,w),M=c?P(0,x):null,N=c?D(0,w):null,j=200*u,U=[];if(m){const t=k(I,_)<j;if(c&&!t){const t=O(M,_);U.push(new Oo(I,t)),U.push(new Oo(t,_))}else U.push(new Oo(I,_));for(let t=2;t<v.length-1;t++)U.push(new Oo(v[t-1],v[t]));const e=k(L,b)<j;if(c&&!e){const t=O(N,b);U.push(new Oo(b,t)),U.push(new Oo(t,L))}else U.push(new Oo(b,L))}else{const e=c?k(M,N):0;if(c&&e>2*(30*u+Math.min(x,w)))if(s){const e=ia(f,d,x,w,o,t);U.push(new Oo(I,e)),U.push(new Oo(e,L))}else{const t=r*i,e=30+x,n=Math.sqrt(e*e+t*t),o=30+w,a=Math.sqrt(o*o+t*t),s=P(0,n),u=D(0,a);U.push(new Oo(I,s)),U.push(new Oo(s,u)),U.push(new Oo(u,L))}else if(e>(x+w)/2){const e=ia(f,d,x,w,o,t);U.push(new Oo(I,e)),U.push(new Oo(e,L))}else U.push(new Oo(I,L))}return U})(e,n,r,h,f,t,c,o),v=[],g=p[0],y=a(g,c);v.push({x:g.p1.x+y.x,y:g.p1.y+y.y});for(let t=1;t<p.length;t++)if(1===e.size())v.push(p[t-1].p2);else{const e=p[t-1],n=p[t],r=a(e,c),i=a(n,c),o=Xo(e.p1,Ho(r,d/2)),s=Xo(e.p2,Ho(r,d/2)),u=Xo(n.p1,Ho(i,d/2)),f=Xo(n.p2,Ho(i,d/2));let g=null;_=i,(m=r).x*_.x+m.y*_.y<.99&&(g=Io(o,s,u,f));const y=null!==g?$o(g,e.p2):Ho(r,d/2);v.push(Xo(e.p2,Ho(y,h/l)))}var m,_;const b=p[p.length-1],x=a(b,c);return v.push({x:b.p2.x+x.x,y:b.p2.y+x.y}),e.relIsOppositeDirection(t)?v.reverse():v},la=(t,e,n,r,i,o,a=!1)=>{const s=vr(),{selected:u,captions:l=[],caption:c="",width:h,disabled:f,captionAlign:d="top",captionSize:p=1}=i,v=l.length>0?ra(l)?.fullCaption:c;if(void 0===v)return;const g=f?"#DDDDDD":"#848484",y=6*p*s,m=u?"bold":"normal";let _=v;t.fillStyle=g,t.font=`${m} ${y}px "Open Sans", sans-serif`;const b=e=>t.measureText(e).width,x=(h||1)*(u?1.5:1);let w=b(_);if(w>r){const t=ta(_,b,(()=>r),1,!1)[0];_=t.hasEllipsisChar?`${t.text}...`:_,w=r}t.save(),t.translate(e.x,e.y),a?(t.rotate(n-Math.PI/2),t.translate(2*y,0),t.rotate(-Math.PI/2)):t.rotate(n);const T=(1+p)*s,S="bottom"===d?y/2+x+T:-(x+T);t.fillText(_,-w/2,S),t.restore();const A=2*S*Math.sin(n),E=2*S*Math.cos(n),C={position:{x:e.x-A,y:e.y+E},rotation:a?n-Math.PI:n,width:r/s,height:(y+T)/s};o.setLabelInfo(i.id,C)},ca=(t,e,n,r,i)=>{if(t.beginPath(),t.moveTo(e[0].x,e[0].y),i&&e.length>2){let n=1;for(;n<e.length-2;){const r=(e[n].x+e[n+1].x)/2,i=(e[n].y+e[n+1].y)/2;t.quadraticCurveTo(e[n].x,e[n].y,r,i),n+=1}t.quadraticCurveTo(e[n].x,e[n].y,e[n+1].x,e[n+1].y)}else for(let n=1;n<e.length;n++)t.lineTo(e[n].x,e[n].y);t.lineWidth=n,t.strokeStyle=r,t.lineCap="round",t.stroke()},ha=(t,e,n)=>{const r=n.indexOf(t),i=n.angles[r]??0,o=i-xo/2,a=i+xo/2,s=t.width||1,u=vr(),l=oa(e),c={x:e.x+Math.cos(o)*(l+s/2),y:e.y+Math.sin(o)*(l+s/2)},h={x:e.x+Math.cos(a)*(l+s/2),y:e.y+Math.sin(a)*(l+s/2)},f={x:e.x+Math.cos(i)*(l+35*u),y:e.y+Math.sin(i)*(l+35*u)};return{startAngle:o,endAngle:a,startPoint:c,endPoint:h,apexPoint:f,control1Point:{x:f.x+25*Math.cos(i-Math.PI/2)*u/2,y:f.y+25*Math.sin(i-Math.PI/2)*u/2},control2Point:{x:f.x+25*Math.cos(i+Math.PI/2)*u/2,y:f.y+25*Math.sin(i+Math.PI/2)*u/2}}},fa=(t,e,n,r,i,o)=>{t.beginPath(),t.moveTo(e.x,e.y),t.quadraticCurveTo(i.x,i.y,r.x,r.y),t.quadraticCurveTo(o.x,o.y,n.x,n.y),t.stroke()},da=(t,e,n,r,i,o,a=!0)=>{Po(n,r)&&(n.id===r.id?((t,e,n,r,i)=>{const{startPoint:o,endPoint:a,apexPoint:s,control1Point:u,control2Point:l}=ha(e,n,r),c=vr(),h=(e.width||1)*c,f=h>1?h/2:1,d=2*c,p=9*f,v=2*f,g=7*f,y=Math.atan2(a.y-l.y,a.x-l.x),m=e.selected?d*Math.sqrt(1+2*p/g*(2*p/g)):0,_={x:a.x-Math.cos(y)*(.5*p-v+m),y:a.y-Math.sin(y)*(.5*p-v+m)},b={headPosition:{x:a.x+Math.cos(y)*(.5*p-v-m),y:a.y+Math.sin(y)*(.5*p-v-m)},headAngle:y,headHeight:p,headChinHeight:v,headWidth:g};t.save(),t.lineCap="round",e.selected&&(aa(t),t.lineWidth=h+2*d,t.strokeStyle=To,fa(t,o,_,s,u,l),Fo(t,2*d,To,b,!1,!0),sa(t),t.lineWidth=h+d,t.strokeStyle=wo,fa(t,o,_,s,u,l),Fo(t,d,wo,b,!1,!0)),t.lineWidth=h,e.hovered&&!e.selected&&!e.disabled&&(aa(t),t.strokeStyle=So,t.fillStyle=So,fa(t,o,_,s,u,l),Fo(t,h,So,b),sa(t));const x=e.disabled?Ao:e.color||_o;if(t.fillStyle=x,t.strokeStyle=x,fa(t,o,_,s,u,l),Fo(t,h,x,b),i){const n=r.indexOf(e),i=r.angles[n]??0,o=(i+Math.PI/2)%(2*Math.PI),a=(i+2*Math.PI)%(2*Math.PI)<Math.PI,u=s.x-Math.cos(y)*(m/4),l=s.y-Math.sin(y)*(m/4);la(t,{x:u,y:l},o,40*c,e,r,a)}t.restore()})(t,e,n,i,o):((t,e,n,r,i,o,a)=>{const s=ua(e,i,n,r,o,a),u=vr(),l=(t=>{const e=t.selected?1.5:1;return(t.width||1)*e*vr()})(e),c=e.disabled?Ao:e.color||_o,h=2*u,f=u*(e.width>1?e.width/2:1),d=9*f,p=2*f,v=7*f,g=Yo(s[s.length-2],s[s.length-1]);let y=e.selected?h*Math.sqrt(1+2*d/v*(2*d/v)):0,m=2-y,_=Math.floor(s.length/2);s.length>2&&e.selected&&g<d+y-p&&(m+=g,y-=g/2+p,s.pop(),_=Math.floor(s.length/2));const b=s[s.length-2],x=s[s.length-1],w=(T=b,S=x,Math.atan2(S.y-T.y,S.x-T.x));var T,S;s[s.length-1]={x:x.x-Math.cos(w)*(d/2+y),y:x.y-Math.sin(w)*(d/2+y)};const A={headPosition:{x:x.x+Math.cos(w)*m,y:x.y+Math.sin(w)*m},headAngle:w,headHeight:d,headChinHeight:p,headWidth:v};for(const t of s)t.x=Math.round(t.x),t.y=Math.round(t.y);if(t.save(),e.selected){const e=Math.atan2(s[1].y-s[0].y,s[1].x-s[0].x),n=qo(e,1.5*h);s[0]=Xo(s[0],n),aa(t);const r=2*h;ca(t,s,l+r,To,a),Fo(t,r,To,A,!1,!0),sa(t),ca(t,s,l+h,wo,a),Fo(t,h,wo,A,!1,!0)}if(e.hovered&&!e.selected&&!e.disabled&&(aa(t),ca(t,s,l,So,a),Fo(t,l,So,A),sa(t)),ca(t,s,l,c,a),Fo(t,l,c,A),o){const o=n.x>r.x;let u,l,c,f,d;const p=s[_];1==(1&s.length)?(f=s[o?_+1:_-1],d=s[o?_-1:_+1],a?(u=(p.x+(f.x+d.x)/2)/2,l=(p.y+(f.y+d.y)/2)/2,c=o?Math.atan2(n.y-r.y,n.x-r.x):Math.atan2(r.y-n.y,r.x-n.x)):(Yo(p,f)>Yo(p,d)?d=p:f=p,u=(f.x+d.x)/2,l=(f.y+d.y)/2,c=Math.atan2(d.y-f.y,d.x-f.x))):(f=s[o?_:_-1],d=s[o?_-1:_],u=(f.x+d.x)/2,l=(f.y+d.y)/2,c=Math.atan2(d.y-f.y,d.x-f.x));const v=Yo(f,d);if(e.selected){const t=qo(c+Math.PI/2,1.5*h),n="bottom"===e.captionAlign?1:-1;u+=n*t.x,l+=n*t.y}la(t,{x:u,y:l},c,v,e,i)}t.restore()})(t,e,n,r,i,o,a))},pa=(t,e,n,r,i,o,a=!1)=>{if(!Po(n,r))return 1/0;const s=n===r?((t,e,n,r)=>{const{startPoint:i,endPoint:o,apexPoint:a,control1Point:s,control2Point:u}=ha(e,n,r),l=Lo(i,a,s,t),c=Lo(a,o,u,t);return Math.min(l,c)})(t,e,n,i):((t,e,n,r,i,o,a)=>{const s=ua(e,n,r,i,o,a);let u=1/0;if(a&&3===s.length)u=Lo(s[0],s[2],s[1],t);else for(let e=1;e<s.length;e++){const n=s[e-1],r=s[e],i=ko(n,r,t);u=i<u?i:u}return u})(t,e,i,n,r,o,a);return s},va=(t,e,n,r,i=!1,o=!1)=>Po(n,r)?n.id===r.id?((t,e,n)=>{const r=ha(t,e,n),i={left:1/0,top:1/0,right:-1/0,bottom:-1/0},o=["startPoint","endPoint","apexPoint","control1Point","control2Point"];for(let t=0;t<o.length;t++){const{x:e,y:n}=r[o[t]];e<i.left&&(i.left=e),e>i.right&&(i.right=e),n<i.top&&(i.top=n),n>i.bottom&&(i.bottom=n)}return i})(t,n,e):((t,e,n,r,i,o)=>{const a=ua(t,e,n,r,i,o),s={left:1/0,top:1/0,right:-1/0,bottom:-1/0};for(const t of a){const{x:e,y:n}=t;e<s.left&&(s.left=e),e>s.right&&(s.right=e),n<s.top&&(s.top=n),n>s.bottom&&(s.bottom=n)}return s})(t,e,n,r,i,o):null;var ga=r(346),ya=r.n(ga);const ma=t=>t&&"light"===ya()(t)?"#000":"#fff",_a=({x:t=0,y:e=0,size:n=fr})=>({top:e-n,left:t-n,right:t+n,bottom:e+n}),ba=(t,e,n,r,i,o=1)=>{const{x:a=0,y:s=0,size:u=fr,caption:l="",captions:c=[],captionAlign:h="center",captionSize:f=1,disabled:d,activated:p,selected:v,hovered:g,id:y,icon:m}=e,_=i.selected,b=vr(),x=((t,e,n)=>{const r=t.selected?n.selected.rings:n.default.rings;if(!r.length){const n=e.getById(t.id);return void 0!==n&&Object.entries(n).forEach((([t,e])=>{t.startsWith("ring-")&&e.setEndValue(0)})),[{width:0,color:""}]}return r.map((({widthFactor:n,color:r},i)=>{const o=(t.size||fr)*n*vr();return{width:e.getValueForAnimationName(t.id,`ring-${i}`,o),color:r}}))})(e,r,i),w=x.reduce(((t,e)=>t+e.width),0),T=_.shadow.width*b,S=_.shadow.opacity,A=_.shadow.color,E=u*b,C=2*E,{nodeInfoLevel:R,fontInfoLevel:P,iconInfoLevel:D}=function(t,e){if(!t||!e)return{nodeInfoLevel:0,fontInfoLevel:1.25,iconInfoLevel:1};const n=vr(),r=1600*n*(1200*n),i=Math.pow(t,2)*Math.PI*Math.pow(e,2)/(r/100);return{nodeInfoLevel:Go(i,Mo),fontInfoLevel:Go(i,No),iconInfoLevel:Go(i,jo)}}(E,o);let O=e.color||"#478BFF";const k=((t,e=fr,n=1,r=!1)=>e/({1:3.5,2:2.75,3:2}[n]+(r?1:0))/t)(P,E,f,Boolean(m));let I=ma(O),L=E;const M=L,N=Boolean(l.length),j=Boolean(c.length),U=Boolean(m);if(w>0&&(L=E+w),d)O="#EDEDED",I="#DDDDDD";else{if(p){const e=Date.now()%1e3/1e3,n=e<.7?e/.7:0,r=Uo(O,.4-.4*n);Vo(t,a,s,r,E+.88*E*n)}const e=v||g?T:0,n=r.getValueForAnimationName(y,"shadowWidth",e);n>0&&((t,e,n,r,i,o,a=1)=>{const s=i+o,u=t.createRadialGradient(e,n,i,e,n,s);u.addColorStop(0,"transparent"),u.addColorStop(.01,Uo(r,.5*a)),u.addColorStop(.05,Uo(r,.5*a)),u.addColorStop(.5,Uo(r,.12*a)),u.addColorStop(.75,Uo(r,.03*a)),u.addColorStop(1,Uo(r,0)),t.fillStyle=u,Bo(t,e,n,s),t.fill()})(t,a,s,A,L,n,S)}if(Vo(t,a,s,O,E),U){const e=R<2||!(N||j),i=R>0?1:0;let o,u=e?1*E:.75*E;u/=D,o=1===D?"center"===h?1.3:"bottom"===h||e?1.1:0:"center"===h?1.35:"bottom"===h||e?1.1:0;let l=e?.5*u:u*o,c=u/2;u=r.getValueForAnimationName(y,"iconSize",u),c=r.getValueForAnimationName(y,"iconXPos",c),l=r.getValueForAnimationName(y,"iconYPos",l),t.save();const f=d?.1:i;t.globalAlpha=r.getValueForAnimationName(y,"iconOpacity",f);const p="#fff"===I,v=n.getImage(m,p);t.drawImage(v,a-c,s-l,Math.floor(u),Math.floor(u)),t.restore()}const F=R<2?0:1,z=r.getValueForAnimationName(y,"textOpacity",F,0),B=Uo(I,z),V='"Open Sans", sans-serif';if(N&&z>0){const n=na(t,l,V,k,.7*C,U,P,e?.captionAlign);t.fillStyle=B,t.font=`normal ${k}px ${V}`;const r=1+k,i=-(n.length-2)*r/2,o=l.split("").map((t=>[]));Wo(t,n,o,i,k,V,r,a,s)}if(j){const n=R<2?0:1,i=r.getValueForAnimationName(y,"textOpacity",n,0),o=Uo(I,i),u='"Open Sans", sans-serif',l=Boolean(m);if(i>0){const{stylesPerChar:n,fullCaption:r}=ra(c),i="center"===h?.7*C:2*Math.sqrt(Math.pow(C/2,2)-Math.pow(C/3,2)),f=na(t,r,u,k,i,l,P,e?.captionAlign);t.fillStyle=o;const d=k,p=-(f.length-2)*d/2;let v=0;v=h&&"center"!==h?"bottom"===h?p+E/Math.PI:p-E/Math.PI:p,Wo(t,f,n,v,k,u,d,a,s)}}w>0&&zo(t,a,s,M,x),t.save(),t.restore()},xa="canvasRenderer";class wa{arrowBundler;activeNodes;canvas;context;state;stateDisposers;relationshipThreshold;animationHandler;imageCache;needsRun;nodeVersion;relVersion;waypointVersion;constructor(t,e,n,{relationshipThreshold:r=2.5}={}){this.activeNodes=new Set,this.canvas=t,this.context=e,this.state=n,this.stateDisposers=[],this.stateDisposers.push(n.autorun((()=>{void 0!==n.zoom&&(this.needsRun=!0),void 0!==n.panX&&(this.needsRun=!0),void 0!==n.panY&&(this.needsRun=!0),void 0!==n.nodes.version&&(this.needsRun=!0),void 0!==n.rels.version&&(this.needsRun=!0),n.waypoints.counter>0&&(this.needsRun=!0),void 0!==n.layout&&(this.needsRun=!0)}))),n.nodes.addChannel(xa),n.rels.addChannel(xa),this.relationshipThreshold=r,this.nodeVersion=n.nodes.version,this.relVersion=n.rels.version,this.waypointVersion=n.waypoints.counter,this.animationHandler=new go,this.animationHandler.setOptions({fadeDuration:150,sizeDuration:150}),this.arrowBundler=new Ro(n.rels.items,n.waypoints.data),this.imageCache=new class{cache;constructor(){this.cache={}}getOrCreateEntry(t){let e=this.cache[t];return void 0===e&&(e={},this.cache[t]=e),e}invertCanvas(t){const e=t.getImageData(0,0,yo,yo),n=e.data;for(let t=0;t<4096;t++)n[4*t+0]=255-n[4*t+0],n[4*t+1]=255-n[4*t+1],n[4*t+2]=255-n[4*t+2],n[4*t+3]=n[4*t+3];t.putImageData(e,0,0)}loadImage(t){const e=document.createElement("canvas");e.width=yo,e.height=yo;const n=document.createElement("img");return n.src=t,{canvas:e,image:n,drawn:!1}}drawIfNeeded(t,e){const{image:n,canvas:r,drawn:i}=t;if(!i&&n.complete){const i=r.getContext("2d");i.drawImage(n,0,0,yo,yo),e&&this.invertCanvas(i),t.drawn=!0}}getImage(t,e){const n=this.getOrCreateEntry(t),r=e?"inverted":"image";let i=n[r];return void 0===i&&(i=this.loadImage(t),n[r]=i),this.drawIfNeeded(i,e),i.canvas}},this.needsRun=!0}needsToRun(){return this.needsRun||this.animationHandler.needsToRun()||this.activeNodes.size>0}processUpdates(){const{state:t}=this;let e=!1,n=!1;const r=t.nodes.channels[xa],i=t.rels.channels[xa],{adds:o,removes:a}=r,{adds:s,removes:u}=i;this.nodeVersion<t.nodes.version&&(Object.keys(o).length>0||Object.keys(a).length>0,this.handleChannelUpdate(r,t.nodes,!0),this.nodeVersion=t.nodes.version,t.nodes.clearChannel(xa)),this.relVersion<t.rels.version&&(n=Object.keys(s).length>0||Object.keys(u).length>0,t.rels.clearChannel(xa),this.relVersion=t.rels.version),(n||this.waypointVersion<t.waypoints.counter)&&(this.arrowBundler.updateData(s,u,t.waypoints.data),this.waypointVersion=t.waypoints.counter)}render(t,e={}){const{state:n,animationHandler:r,arrowBundler:i,relationshipThreshold:o}=this,{zoom:a,layout:s,nodes:{idToItem:u,idToPosition:l},rels:{items:c}}=n,h=e.canvas??this.canvas,f=e.context??this.context,d=vr(),p=h.clientWidth*d,v=h.clientHeight*d;f.save(),e.backgroundColor?(f.fillStyle=e.backgroundColor,f.fillRect(0,0,p,v)):f.clearRect(0,0,p,v),this.zoomAndPan(f,h),r.ignoreAnimations(Boolean(e.ignoreAnimations)),e.ignoreAnimations||r.advance(),i.updatePositions(l);const g=[],y=[],m=[];for(const t of c){const n=i.getBundle(t),r={...l[t.from],...u[t.from]},c={...l[t.to],...u[t.to]},h=e.showCaptions||a>o||void 0!==t.captionHtml;if(!r||!c)continue;const f=va(t,n,r,c,h,s!==lo);if(null!==f){const e=this.isBoundingBoxOffScreen(f,p,v),n=Yo({x:r.x||0,y:r.y||0},{x:c.x||0,y:c.y||0}),i=((r.size||fr)+(c.size||fr))*devicePixelRatio,o=r.id!==c.id&&i>n;e||o||(t.disabled?y.push({...t,fromNode:r,toNode:c,showLabel:h}):t.selected?g.push({...t,fromNode:r,toNode:c,showLabel:h}):m.push({...t,fromNode:r,toNode:c,showLabel:h}))}}for(const t of[...y,...m,...g]){const{fromNode:e,toNode:n,showLabel:r}=t,o=i.getBundle(t);da(f,t,e,n,o,r,s!==lo)}const _=[],b=[],x=[];for(const e of t)u[e.id]?.disabled?_.push({...e}):u[e.id]?.selected?b.push({...e}):x.push({...e});for(const t of[..._,...x,...b]){const e=_a(t);!this.isBoundingBoxOffScreen(e,p,v)&&ba(f,{...u[t.id],...t},this.imageCache,this.animationHandler,this.state.nodeBorderStyles,a)}f.restore(),this.needsRun=!1}getNodesAt(t,e=0){const n=[],{items:r,idToPosition:i}=this.state.nodes,o=vr();for(const a of r){const{id:r,size:s=fr}=a,{x:u,y:l}=i[r],c=Math.sqrt(Math.pow(t.x-u,2)+Math.pow(t.y-l,2));if(c<=(s+e)*o){const e=n.findIndex((t=>t.distance>c));n.splice(-1!==e?e:n.length,0,{data:a,targetCoordinates:{x:u,y:l},pointerCoordinates:t,distanceVector:{x:t.x-u,y:t.y-l},insideNode:c<=s*o,distance:c})}}return n}getRelsAt(t){const e=[],{state:n,arrowBundler:r,relationshipThreshold:i}=this,{zoom:o,rels:{items:a},nodes:{idToPosition:s},layout:u}=n,l=o>i;for(const n of a){const i=r.getBundle(n),o=s[n.from],a=s[n.to];if(void 0!==o&&void 0!==a&&-1!==i.indexOf(n)){const r=pa(t,n,o,a,i,l,u!==lo);if(r<10){const i=e.findIndex((t=>t.distance>r));e.splice(-1!==i?i:e.length,0,{data:n,fromTargetCoordinates:o,toTargetCoordinates:a,pointerCoordinates:t,distance:r})}}}return e}destroy(){this.stateDisposers.forEach((t=>{t()})),this.state.nodes.removeChannel(xa),this.state.rels.removeChannel(xa)}isBoundingBoxOffScreen(t,e,n){const{zoom:r,panX:i,panY:o}=this.state,a=e/r,s=n/r,u=i-a/2,l=o-s/2,c=t.right<u,h=t.bottom<l,f=t.left>u+a,d=t.top>l+s;return c||f||h||d}handleChannelUpdate(t,e,n){const r=Object.keys(t.adds);for(let e=0;e<r.length;e++){const n=r[e];t.adds[n].activated&&this.activeNodes.add(n)}const i=Object.keys(t.removes);for(let t=0;t<i.length;t++){const e=i[t];this.activeNodes.delete(e)}if(n){const n=Object.keys(t.updates);for(let t=0;t<n.length;t++){const r=n[t];e.idToItem[r].activated?this.activeNodes.add(r):this.activeNodes.delete(r)}}}zoomAndPan(t,e){const{width:n,height:r}=e,{zoom:i,panX:o,panY:a}=this.state;t.translate(-n/2*i,-r/2*i),t.translate(-o*i,-a*i),t.scale(i,i),t.translate(n/2/i,r/2/i),t.translate(n/2,r/2)}}const Ta=(e,n,r=1,i=0,o=0)=>{const{offsetX:a,offsetY:s}=((e,n)=>{if((0,t.isNil)(e)||(0,t.isNil)(n))return{offsetX:0,offsetY:0};const r=n.getBoundingClientRect(),i=window.devicePixelRatio||1;return{offsetX:i*(e.clientX-r.left-.5*r.width),offsetY:i*(e.clientY-r.top-.5*r.height)}})(e,n);return{x:i+a/r,y:o+s/r}},Sa="WebGLRenderer";class Aa{mainSceneRenderer;minimapRenderer;needsRun;minimapMouseDown;stateDisposers;state;constructor(t){if(void 0===t.state)throw new Error("Renderer missing options: state - state object");const{state:e,mainSceneRenderer:n,minimapRenderer:r}=t,{nodes:i,rels:o}=e;this.mainSceneRenderer=n,this.minimapRenderer=r,this.needsRun=!1,this.minimapMouseDown=!1,this.stateDisposers=[],this.stateDisposers.push(e.autorun((()=>{this.updateMainViewport(e.zoom,e.panX,e.panY)}))),this.stateDisposers.push(e.autorun((()=>{this.updateMinimapViewport(e.minimapZoom,e.minimapPanX,e.minimapPanY)}))),this.stateDisposers.push(e.autorun((()=>{void 0!==e.nodes.version&&(this.needsRun=!0),void 0!==e.rels.version&&(this.needsRun=!0)}))),i.addChannel(Sa),o.addChannel(Sa),this.state=e,this.setupMinimapInteractions()}needsToRun(){return this.needsRun||Object.keys(this.mainSceneRenderer.activeNodes).length>0}renderMainScene(t){const{nodes:e,rels:n}=this.state;this.checkForUpdates(e,n),this.mainSceneRenderer.render(t,e,n),this.needsRun=!1}renderMinimap(t){const{nodes:e,rels:n}=this.state;this.checkForUpdates(e,n),this.minimapRenderer.render(t,e,n),this.minimapRenderer.renderViewbox(),this.needsRun=!1}checkForUpdates(t,e){const n=Object.values(t.channels[Sa].adds).length>0,r=Object.values(e.channels[Sa].adds).length>0,i=Object.values(t.channels[Sa].removes).length>0,o=Object.values(e.channels[Sa].removes).length>0,a=Object.values(t.channels[Sa].updates),s=Object.values(e.channels[Sa].updates);n||r||i||o?(this.mainSceneRenderer.setData({nodes:t.items,rels:e.items}),this.minimapRenderer.setData({nodes:t.items,rels:e.items})):(a.length>0&&(this.mainSceneRenderer.updateNodes(a),this.minimapRenderer.updateNodes(a)),s.length>0&&(this.mainSceneRenderer.updateRelationships(e.items),this.minimapRenderer.updateRelationships(e.items))),t.clearChannel(Sa),e.clearChannel(Sa)}onResize(){const{zoom:t,panX:e,panY:n,minimapZoom:r,minimapPanX:i,minimapPanY:o}=this.state;this.updateMainViewport(t,e,n),this.updateMinimapViewport(r,i,o)}updateMainViewport(t,e,n){this.mainSceneRenderer.updateViewport(t,e,n);const r=this.mainSceneRenderer.canvas.clientWidth,i=this.mainSceneRenderer.canvas.clientHeight;this.minimapRenderer.updateViewportBox(t,e,n,r,i),this.needsRun=!0}updateMinimapViewport(t,e,n){this.minimapRenderer.updateViewport(t,e,n),this.needsRun=!0}handleMinimapDrag(t){const{state:e,minimapRenderer:n}=this,{x:r,y:i}=Ta(t,n.canvas,e.minimapZoom,e.minimapPanX,e.minimapPanY);e.setPan(r,i)}handleMinimapWheel(e){const{state:n,mainSceneRenderer:r}=this;n.setZoom(((e,n=1)=>(0,t.isNil)(e)||isNaN(e.deltaY)?n:n-e.deltaY/500*Math.min(1,n))(e,n.zoom),r.canvas),e.preventDefault()}setupMinimapInteractions(){const t=this.minimapRenderer.canvas;t.addEventListener("mousedown",(t=>{this.handleMinimapDrag(t),this.minimapMouseDown=!0})),t.addEventListener("mousemove",(t=>{this.minimapMouseDown&&this.handleMinimapDrag(t)})),t.addEventListener("mouseup",(()=>{this.minimapMouseDown=!1})),t.addEventListener("mouseleave",(()=>{this.minimapMouseDown=!1})),t.addEventListener("wheel",(t=>{this.handleMinimapWheel(t)}))}destroy(){this.stateDisposers.forEach((t=>{t()})),this.state.nodes.removeChannel(Sa),this.state.rels.removeChannel(Sa),this.mainSceneRenderer.destroy(),this.minimapRenderer.destroy()}}class Ea{mainSceneRenderer;minimapRenderer;needsRun;minimapMouseDown;stateDisposers;state;renderMainScene(t){}renderMinimap(t){}checkForUpdates(t,e){}onResize(){}updateMainViewport(t,e,n){}updateMinimapViewport(t,e,n){}handleMinimapDrag(t){}handleMinimapWheel(t){}setupMinimapInteractions(){}destroy(){}needsToRun(){return!1}}const Ca=24,Ra=t=>{const e=new ArrayBuffer(4),n=new Uint32Array(e),r=new Uint8Array(e),i=Gi().get.rgb(t);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=255*i[3],n[0]};class Pa{nodeShader;nodeAnimShader;relShader;relDataBuffer;viewportBoxShader;defaultRelColor;defaultNodeColor;disableRelColor;disableNodeColor;gl;activeNodes;canvas;projection;idToIndex;posBuffer;numRels;numNodes;nodeDataByte;relIdToIndex;relData;containerWidth;containerHeight;nodeDataInt;viewportBoxBuffer;relBuffer;nodeBuffer;posTexture;constructor(t,e,n,r){if(void 0===t.getExtension("OES_texture_float"))throw new Error("Renderer needs floating point texture support");this.nodeShader=new Kr(t,"uniform mat4 u_projection;\nuniform sampler2D u_positions;\nuniform mediump float u_zoom;\nuniform mediump float u_glAdjust;\nuniform lowp vec3 u_nodeBorderColor;\nuniform lowp vec3 u_selectedBorderColor;\nuniform lowp float u_drawDefaultBorder;\n\nattribute float a_size;\nattribute lowp vec2 a_index;\nattribute lowp vec4 a_color;\nattribute lowp float a_selected;\nattribute lowp float a_hovered;\n\nvarying lowp float window;\nvarying lowp vec4 color;\nvarying lowp float selected;\nvarying lowp float hovered;\nvarying lowp float varNodeSize;\nvarying lowp vec3 nodeBorderColor;\nvarying lowp vec3 selectedBorderColor;\nvarying lowp float drawDefaultBorder;\n\nlowp float MinNodeSize = 5.0;\n\nvoid main(void) {\n  vec4 data = texture2D(u_positions, a_index);\n  gl_Position = u_projection * vec4(data.xy, 0.0, 1.0);\n\n  lowp float nodeSize = a_size * u_zoom * u_glAdjust;\n  if (nodeSize < MinNodeSize) {\n   gl_PointSize = MinNodeSize;\n   varNodeSize = MinNodeSize;\n  } else {\n    gl_PointSize = nodeSize;\n    varNodeSize = nodeSize;\n  }\n\n  color = a_color;\n  selected = a_selected;\n  hovered = a_hovered;\n  nodeBorderColor = u_nodeBorderColor;\n  selectedBorderColor = u_selectedBorderColor;\n  drawDefaultBorder = u_drawDefaultBorder;\n}","uniform mediump float u_zoom;\nuniform mediump float u_glAdjust;\n\nvarying lowp vec4 color;\nvarying lowp float drawDefaultBorder;\nvarying lowp vec3 nodeBorderColor;\nvarying lowp vec3 selectedBorderColor;\nvarying lowp float selected;\nvarying lowp float hovered;\nvarying lowp float varNodeSize;\n\nmediump float circleSize = 0.40;\nmediump float ringSize = 0.43;\nmediump float ringSize2 = 0.47;\nmediump float shadowSize = 0.51;\nlowp vec3 shadowColor = vec3(0.73);\nlowp vec3 lineColor = vec3(1.0);\n\nlowp float getShadowAlpha(lowp float size, lowp float dist) {\n  return (1.0 - smoothstep(size, shadowSize, dist)) * 0.25;\n}\n\nlowp float getCircleAlpha(lowp float ringSize, lowp float nodeSize, lowp float dist) {\n  return color.w - smoothstep(ringSize - nodeSize, ringSize, dist);\n}\n\nvoid main() {\n  lowp float dist = distance(gl_PointCoord, vec2(0.5));\n\n  if (dist > 0.51) {\n    discard;\n  }\n  else {\n    lowp float nodeSize = 1.0 / varNodeSize;\n    lowp float nodeAlpha = getCircleAlpha(circleSize, nodeSize, dist);\n    lowp float ringAlpha = getCircleAlpha(ringSize, nodeSize, dist);\n    lowp vec3 finalColor = color.xyz;\n    lowp float finalAlpha = nodeAlpha;\n\n    if (selected > 0.0) {\n      lowp float shadowAlpha = getShadowAlpha(ringSize2, dist);\n      lowp float ringAlpha2 = getCircleAlpha(ringSize2, nodeSize, dist);\n\n      finalColor = mix(lineColor, finalColor, nodeAlpha);\n      finalColor = mix(selectedBorderColor, finalColor, ringAlpha);\n      finalColor = mix(shadowColor, finalColor, ringAlpha2);\n      finalAlpha = max(shadowAlpha, max(nodeAlpha, max(ringAlpha, ringAlpha2)));\n    } else if (hovered > 0.0) {\n      if (drawDefaultBorder > 0.0) {\n        lowp float shadowAlpha = getShadowAlpha(ringSize, dist);\n  \n        finalColor = mix(nodeBorderColor, finalColor, nodeAlpha);\n        finalColor = mix(shadowColor, finalColor, ringAlpha);\n        finalAlpha = max(shadowAlpha, max(nodeAlpha, ringAlpha));\n      } else {\n        lowp float shadowAlpha = getShadowAlpha(circleSize, dist);\n\n        finalColor = mix(shadowColor, finalColor, nodeAlpha);\n        finalAlpha = max(shadowAlpha, nodeAlpha);\n      }\n    } else {\n      if (drawDefaultBorder > 0.0) {\n        finalColor = mix(nodeBorderColor, finalColor, nodeAlpha);\n        finalAlpha = ringAlpha;\n      }\n    }\n    gl_FragColor = vec4(finalColor, 1.0) * finalAlpha;\n  }\n}\n"),this.nodeAnimShader=new Kr(t,"uniform mat4 u_projection;\nuniform sampler2D u_positions;\nuniform lowp float u_animPos;\nuniform mediump float u_zoom;\nuniform mediump float u_glAdjust;\n\nattribute float a_size;\nattribute lowp vec2 a_index;\nattribute lowp vec4 a_color;\nattribute lowp float a_active;\n\nvarying lowp float varNodeSize;\nvarying lowp vec4 color;\n\nvoid main(void) {\n  vec4 data = texture2D(u_positions, a_index);\n\n  gl_Position = u_projection * vec4(data.xy, 0.0, 1.0);\n\n  float nodeSize = a_size * u_zoom * u_glAdjust;\n  nodeSize = nodeSize * (0.4 / 0.5); // Remove extra space added for shadow and selection ring\n\n  gl_PointSize = a_active > 0.5\n    ? nodeSize + 0.88 * nodeSize * u_animPos\n    : 0.0;\n\n  color = a_color;\n  varNodeSize = a_size;\n}","uniform mediump float u_zoom;\nuniform lowp float u_animPos;\nuniform mediump float u_glAdjust;\n\nvarying lowp vec4 color;\nvarying lowp float varNodeSize;\nmediump float circleSize = 0.50;\n\nvoid main(void) {\n\n  lowp float dist = distance(gl_PointCoord, vec2(0.5));\n\n  if (dist > 0.51) {\n    discard;\n  }\n  else {\n    lowp float alpha = 1.0 - smoothstep(circleSize - (1.0 / (varNodeSize * 2.0 * u_zoom * u_glAdjust)), circleSize, dist);\n    lowp float pulseAlpha = 0.9 - 0.9 * u_animPos;\n    gl_FragColor = vec4(color.xyz, 1.0) * alpha * pulseAlpha;\n  }\n}\n"),this.relShader=new Kr(t,"uniform mat4 u_projection;\nuniform sampler2D u_positions;\nuniform mediump float u_glAdjust;\n\nattribute vec2 a_from;\nattribute vec2 a_to;\nattribute lowp vec4 a_color;\nattribute lowp float a_triside;\nattribute float a_width;\n\nvarying lowp vec4 color;\n\nvoid main(void) {\n  vec4 from = texture2D(u_positions, a_from);\n  vec4 to = texture2D(u_positions, a_to);\n  vec2 direction = normalize(to.xy - from.xy);\n  direction = vec2(-direction.y, direction.x);\n\n  float width = a_width * u_glAdjust * 0.5;\n\n  if (a_triside == 0.0) {\n    from.y += (width / 2.0) * direction.y;\n    from.x += (width / 2.0) * direction.x;\n  } else {\n    from.y -= (width / 2.0) * direction.y;\n    from.x -= (width / 2.0) * direction.x;\n  }\n\n  color = a_color;\n  gl_Position = u_projection * vec4(from.xy, 0.0, 1.0);\n}\n","varying lowp vec4 color;\n\nvoid main(void) {\n  gl_FragColor = vec4(color.xyz, 1.0) * color.w;\n}\n"),this.viewportBoxShader=new Kr(t,"attribute vec2 coordinates;\nuniform mat4 u_projection;\n\nvoid main(void) {\n  gl_Position = u_projection * vec4(coordinates, 0.0, 1.0);\n}\n","void main(void) {\n gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n}\n"),this.setShaderUniforms(r),t.clearColor(0,0,0,0),t.disable(t.DEPTH_TEST),this.defaultRelColor=4284900966,this.defaultNodeColor=4294937415,this.disableRelColor="#EDEDED",this.disableNodeColor="#EDEDED",t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this.gl=t,this.activeNodes={},this.canvas=t.canvas,this.projection=Wr(),this.setData({nodes:e.items,rels:n.items}),this.createPositionTexture(),this.setupViewportRendering()}setShaderUniforms(t){const e=Gi().get.rgb(t.nodeBorderStyles.default?.rings[0]?.color),n=Gi().get.rgb(t.nodeBorderStyles.selected?.rings[1]?.color);if(this.nodeShader.use(),e?.length){const t=e.slice(0,3).map((t=>t/255));this.nodeShader.setUniform("u_nodeBorderColor",t),this.nodeShader.setUniform("u_drawDefaultBorder",1)}else this.nodeShader.setUniform("u_drawDefaultBorder",0);const r=n.slice(0,3).map((t=>t/255));this.nodeShader.setUniform("u_selectedBorderColor",r)}setData(t){const e=mr(t.rels);this.setupNodeRendering(t.nodes),this.setupRelationshipRendering(e)}render(t,e,n){const{gl:r,idToIndex:i}=this;for(const e of t){const t=i[e.id];this.posBuffer[4*t+0]=e.x,this.posBuffer[4*t+1]=e.y}r.bindTexture(r.TEXTURE_2D,this.posTexture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,cr,cr,0,r.RGBA,r.FLOAT,this.posBuffer),r.enable(r.BLEND),r.bindFramebuffer(r.FRAMEBUFFER,null),r.clear(r.COLOR_BUFFER_BIT),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),this.renderAnimations(this.posTexture),this.numRels>0&&(this.relShader.use(),this.relShader.setUniform("u_positions",this.posTexture),r.bindBuffer(r.ARRAY_BUFFER,this.relBuffer),this.relShader.setAttributePointerByteNorm("a_color",4,0,16),this.relShader.setAttributePointerByteNorm("a_from",2,4,16),this.relShader.setAttributePointerByteNorm("a_to",2,6,16),this.relShader.setAttributePointerByteNorm("a_triside",1,8,16),this.relShader.setAttributePointerFloat("a_width",1,12,16),r.drawArrays(r.TRIANGLES,0,6*this.numRels)),this.numNodes>0&&(this.nodeShader.use(),this.nodeShader.setUniform("u_positions",this.posTexture),r.bindBuffer(r.ARRAY_BUFFER,this.nodeBuffer),this.nodeShader.setAttributePointerByteNorm("a_color",4,0,12),this.nodeShader.setAttributePointerByteNorm("a_selected",1,4,12),this.nodeShader.setAttributePointerByteNorm("a_index",2,5,12),this.nodeShader.setAttributePointerByte("a_size",4,8,12),this.nodeShader.setAttributePointerByteNorm("a_hovered",1,9,12),r.drawArrays(r.POINTS,0,this.numNodes))}renderViewbox(){const{gl:t,projection:e,viewportBoxBuffer:n}=this;this.viewportBoxShader.use(),this.viewportBoxShader.setUniform("u_projection",e),t.bindBuffer(t.ARRAY_BUFFER,n),this.viewportBoxShader.setAttributePointerFloat("coordinates",2,0,0),t.drawArrays(t.LINES,0,8)}updateNodes(t){const{gl:e,idToIndex:n,disableNodeColor:r,nodeBuffer:i,nodeDataByte:o}=this;let a=!1;for(const e of t){const t=n[e.id];if(e.color||e.disabled){const n=Gi().get.rgb(e.disabled?r:e.color);this.nodeDataByte[3*t*4+0]=n[0],this.nodeDataByte[3*t*4+1]=n[1],this.nodeDataByte[3*t*4+2]=n[2],this.nodeDataByte[3*t*4+3]=255*n[3],a=!0}if(void 0!==e.selected){const{selected:n}=e;this.nodeDataByte[3*t*4+4]=n?255:0,a=!0}if(void 0!==e.activated&&(this.nodeDataByte[3*t*4+7]=e.activated?255:0,a=!0,e.activated?this.activeNodes[e.id]=!0:delete this.activeNodes[e.id]),void 0!==e.hovered){const n=!e.disabled&&e.hovered;this.nodeDataByte[3*t*4+9]=n?255:0,a=!0}if(void 0!==e.size){const n=e.size;this.nodeDataByte[3*t*4+8]=n||fr,a=!0}}a&&(e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,o,e.DYNAMIC_DRAW))}updateRelationships(t){const e=mr(t),{gl:n}=this;let r=!1;for(const t of e){const{key:e,width:n,color:i,disabled:o}=t,a=this.relIdToIndex[e],s=void 0===i?this.defaultRelColor:Ra(o?this.disableRelColor:i);this.relData.positionsAndColors[a*Ca+0]=s,this.relData.positionsAndColors[a*Ca+4]=s,this.relData.positionsAndColors[a*Ca+8]=s,this.relData.positionsAndColors[a*Ca+12]=s,this.relData.positionsAndColors[a*Ca+16]=s,this.relData.positionsAndColors[a*Ca+20]=s,r=!0,void 0!==n&&(this.relData.widths[a*Ca+3]=n,this.relData.widths[a*Ca+7]=n,this.relData.widths[a*Ca+11]=n,this.relData.widths[a*Ca+15]=n,this.relData.widths[a*Ca+19]=n,this.relData.widths[a*Ca+23]=n,r=!0)}r&&(n.bindBuffer(n.ARRAY_BUFFER,this.relBuffer),n.bufferData(n.ARRAY_BUFFER,this.relDataBuffer,n.DYNAMIC_DRAW))}createPositionTexture(){const{gl:t}=this,e=t.createTexture(),n=new Float32Array(262144);t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,cr,cr,0,t.RGBA,t.FLOAT,n),this.posTexture=e,this.posBuffer=n}updateViewportBox(t,e,n,r,i){const{gl:o}=this,a=vr(),s=r*a,u=i*a,l=(.5*s+e*t)/t,c=(.5*u+n*t)/t,h=(.5*-s+e*t)/t,f=(.5*-u+n*t)/t,d=[l,c,h,c,h,c,h,f,h,f,l,f,l,f,l,c];o.bindBuffer(o.ARRAY_BUFFER,this.viewportBoxBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(d),o.DYNAMIC_DRAW)}updateViewport(t,e,n){const{gl:r,canvas:i,projection:o}=this;this.containerWidth=i.clientWidth,this.containerHeight=i.clientHeight;const a=1/t,s=e-r.drawingBufferWidth*a*.5,u=n-r.drawingBufferHeight*a*.5,l=r.drawingBufferWidth*a,c=r.drawingBufferHeight*a;this.projection=Wr(),Xr(o,s,s+l,u+c,u,0,1e6);const h=2.6315789473684212*(window.devicePixelRatio||1);this.nodeShader.use(),this.nodeShader.setUniform("u_zoom",t),this.nodeShader.setUniform("u_glAdjust",h),this.nodeShader.setUniform("u_projection",o),this.nodeAnimShader.use(),this.nodeAnimShader.setUniform("u_zoom",t),this.nodeAnimShader.setUniform("u_glAdjust",h),this.nodeAnimShader.setUniform("u_projection",o),this.relShader.use(),this.relShader.setUniform("u_glAdjust",h),this.relShader.setUniform("u_projection",o)}setupViewportRendering(){this.viewportBoxBuffer=this.gl.createBuffer()}setupNodeRendering(t){const{gl:e}=this,n=new ArrayBuffer(8),r=new Uint32Array(n),i=new Uint8Array(n);void 0===this.nodeBuffer&&(this.nodeBuffer=e.createBuffer()),this.numNodes=t.length;const o=new ArrayBuffer(3*t.length*8),a=new Uint32Array(o),s={};this.activeNodes={};for(let e=0;e<t.length;e++){const{selected:n,hovered:o,color:u,activated:l,size:c,id:h,disabled:f}=t[e],d=u?Ra(u):this.defaultNodeColor;a[3*e+0]=f?Ra(this.disableNodeColor):d,i[0]=n?255:0,i[1]=e%cr,i[2]=Math.floor(e/cr),i[3]=l?255:0,i[4]=!f&&o?255:0,l&&(this.activeNodes[h]=!0),a[3*e+1]=r[0],a[3*e+2]=c||fr,a[3*e+3]=r[1],s[h]=e}e.bindBuffer(e.ARRAY_BUFFER,this.nodeBuffer),e.bufferData(e.ARRAY_BUFFER,a,e.DYNAMIC_DRAW),this.numNodes=t.length,this.nodeDataInt=a,this.nodeDataByte=new Uint8Array(o),this.idToIndex=s}setupRelationshipRendering(t){const{gl:e}=this,n=new ArrayBuffer(4),r=new Uint32Array(n),i=new Uint8Array(n),o={};void 0===this.relBuffer&&(this.relBuffer=e.createBuffer());const a=new ArrayBuffer(t.length*Ca*4),s=new Uint32Array(a),u=new Float32Array(a);for(let e=0;e<t.length;e++){const{from:n,to:a,color:l,width:c,key:h,disabled:f}=t[e],d=this.idToIndex[n],p=this.idToIndex[a],v=d%cr,g=Math.floor(d/cr),y=p%cr,m=Math.floor(p/cr),_=[v,g,y,m],b=[y,m,v,g],x=l?Ra(l):this.defaultRelColor,w=f?Ra(this.disableRelColor):x,T=c||1;o[h]=e;let S=0;const A=(t,n,o,a)=>{s[e*Ca+S]=t,S++;for(let t=0;t<n.length;t++)i[t]=n[t];s[e*Ca+S]=r[0],S++,i[0]=o,s[e*Ca+S]=r[0],S++,u[e*Ca+S]=a,S++};A(w,_,255,T),A(w,b,0,T),A(w,_,0,T),A(w,b,0,T),A(w,_,0,T),A(w,b,255,T)}e.bindBuffer(e.ARRAY_BUFFER,this.relBuffer),e.bufferData(e.ARRAY_BUFFER,a,e.DYNAMIC_DRAW),this.numRels=t.length,this.relDataBuffer=a,this.relData={positionsAndColors:s,widths:u},this.relIdToIndex=o}renderAnimations(t){const{gl:e,nodeBuffer:n,numNodes:r}=this,i=Date.now()%1e3/1e3,o=i<.7?i/.7:0;this.nodeAnimShader.use(),this.nodeAnimShader.setUniform("u_positions",t),this.nodeAnimShader.setUniform("u_animPos",o),e.bindBuffer(e.ARRAY_BUFFER,n),this.nodeAnimShader.setAttributePointerByteNorm("a_color",4,0,12),this.nodeAnimShader.setAttributePointerByteNorm("a_active",1,7,12),this.nodeAnimShader.setAttributePointerByteNorm("a_index",2,5,12),this.nodeAnimShader.setAttributePointerByte("a_size",4,8,12),e.drawArrays(e.POINTS,0,r)}destroy(){this.gl.deleteBuffer(this.nodeBuffer),this.gl.deleteBuffer(this.relBuffer),this.nodeShader.remove(),this.nodeAnimShader.remove(),this.relShader.remove()}}let Da;const Oa=(t,e,n)=>{const r=vr();t.width=e*r,t.height=n*r,t.style.width=`${e}px`,t.style.height=`${n}px`},ka=t=>{jr.warn("Error: WebGL context lost - visualization will stop working!",t),void 0!==Da&&Da(t)},Ia=t=>{const{width:e,height:n}=t.parentElement.getBoundingClientRect();Oa(t,e,n)},La=(t,e)=>{const n=document.createElement("canvas");return document.body.appendChild(n),Oa(n,t,e),n},Ma=(t,e)=>{const n=document.createElement("canvas");return Object.assign(n.style,pr),void 0!==t&&(t.appendChild(n),Ia(n)),((t,e)=>{Da=e,t.addEventListener("webglcontextlost",ka)})(n,e),n},Na=t=>{t.width=0,t.height=0,t.remove()},ja=t=>t.getContext("2d"),Ua=t=>{const e={antialias:!0};let n=t.getContext("webgl",e);return void 0===n&&(n=t.getContext("experimental-webgl",e)),n},Fa=t=>{t.canvas.removeEventListener("webglcontextlost",ka),t.getExtension("WEBGL_lose_context")?.loseContext()},za=fr*vr();class Ba{callbacks;constructor(){this.callbacks={}}register(t,e){this.isCallbackRegistered(t)||(this.callbacks[t]=[]),this.callbacks[t].push(e)}isCallbackRegistered(t){return void 0!==this.callbacks[t]}callIfRegistered(){const t=arguments[0];this.isCallbackRegistered(t)&&this.callbacks[t].slice(0).forEach((t=>t.apply(null,Array.prototype.slice.call(arguments,1))))}}var Va=r(805),Ga=r.n(Va);const Wa=5e-5;class Xa{xCtrl;yCtrl;zoomCtrl;getNodePositions;firstUpdate;state;canvas;defaultZoomLevel;stateDisposers;constructor({state:t,getNodePositions:e,canvas:n,defaultZoomLevel:r}){let i;this.state=t,this.getNodePositions=e,this.canvas=n,this.xCtrl=new(Ga())(.35,Wa,.05,1),this.yCtrl=new(Ga())(.35,Wa,.05,1),this.zoomCtrl=new(Ga())(.3,1e-5,.01,1),this.defaultZoomLevel=r,this.stateDisposers=[],this.stateDisposers.push(t.autorun((()=>{null===t.fitNodeIds&&(this.xCtrl.reset(),this.yCtrl.reset(),this.zoomCtrl.reset())}))),this.stateDisposers.push(t.autorun((()=>{i!==t.fitNodeIds&&(i=t.fitNodeIds,this.firstUpdate=!0)}))),this.stateDisposers.push(t.autorun((()=>{t.resetZoom&&(this.firstUpdate=!0)})))}needsToRun(){const{fitNodeIds:t,resetZoom:e}=this.state;return t.length>0||e}update(t){const{fitNodeIds:e,resetZoom:n}=this.state;e.length>0?this.fitNodes(e,t):n&&this.reset(t)}destroy(){this.stateDisposers.forEach((t=>t()))}recalculateTarget(t,e,n,r){const{xCtrl:i,yCtrl:o,zoomCtrl:a,state:s,defaultZoomLevel:u}=this,l=[];for(let e=0;e<t.length;e++)l.push({id:t[e]});const{zoom:c,panX:h,panY:f,maxNodeRadius:d,nodes:p}=s,v=this.getNodePositions(l);p.updatePositions(v);const{centerX:g,centerY:y,nodesWidth:m,nodesHeight:_}=Wi(v,d);if(isNaN(g)||isNaN(y))return jr.info("fit() function couldn't calculate center point, not updating viewport"),!1;i.setTarget(e.noPan?h:g),o.setTarget(e.noPan?f:y);const{zoomX:b,zoomY:x}=Xi(m,_,n,r);if(b===1/0&&x===1/0)a.setTarget(u);else{const t=$i(b,x,e.minZoom,e.maxZoom);e.outOnly&&c<t?a.setTarget(c):a.setTarget(t)}return!0}allNodesAreVisible(t,e,n){const{zoomX:r,zoomY:i}=Xi(e,n,this.canvas.width,this.canvas.height);return t<r&&t<i}reset(t){const{zoom:e,panX:n,panY:r,nodes:i,maxNodeRadius:o,defaultZoomLevel:a}=this.state;if(this.firstUpdate||t){this.zoomCtrl.setTarget(a);const{centerX:t,centerY:s,nodesWidth:u,nodesHeight:l}=Wi(Object.values(i.idToPosition),o);this.allNodesAreVisible(e,u,l)?(this.xCtrl.setTarget(t),this.yCtrl.setTarget(s)):(this.xCtrl.setTarget(n),this.yCtrl.setTarget(r)),this.firstUpdate=!1}const s=e+this.zoomCtrl.update(e),u=n+this.xCtrl.update(n),l=r+this.yCtrl.update(r);this.state.updateZoomToFit(s,u,l,this.canvas),Math.abs(this.zoomCtrl.target-s)<.01&&(this.state.updateZoomToFit(a,u,l,this.canvas),this.state.clearReset())}fitNodes(t,e){const{zoomOptions:n={},zoom:r,panX:i,panY:o}=this.state;let a=!0;if(this.firstUpdate||e){const{width:e,height:r}=this.canvas;a=this.recalculateTarget(t,n,e,r),this.firstUpdate=!1}if(a){const t=i+this.xCtrl.update(i),n=o+this.yCtrl.update(o),a=r+this.zoomCtrl.update(r);this.state.updateZoomToFit(a,t,n,this.canvas);const s=Math.max(5,10/this.zoomCtrl.target);!e&&Math.abs(this.zoomCtrl.target-a)<.01&&Math.abs(this.xCtrl.target-t)<s&&Math.abs(this.yCtrl.target-n)<s&&this.state.clearFit()}}}function $a(t){return $a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$a(t)}function Ha(){Ha=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),s=new P(r||[]);return i(a,"_invoke",{value:A(t,n,s)}),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f="suspendedStart",d="executing",p="completed",v={};function g(){}function y(){}function m(){}var _={};l(_,a,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(D([])));x&&x!==n&&r.call(x,a)&&(_=x);var w=m.prototype=g.prototype=Object.create(_);function T(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(i,o,a,s){var u=h(t[i],t,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==$a(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(c).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function A(e,n,r){var i=f;return function(o,a){if(i===d)throw new Error("Generator is already running");if(i===p){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=E(s,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var l=h(e,n,r);if("normal"===l.type){if(i=r.done?p:"suspendedYield",l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=p,r.method="throw",r.arg=l.arg)}}}function E(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError($a(e)+" is not iterable")}return y.prototype=m,i(w,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:y,configurable:!0}),y.displayName=l(m,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},T(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new S(c(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(w),l(w,u,"Generator"),l(w,a,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=D,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Ya(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function qa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Za(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ka(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Za(Object(n),!0).forEach((function(e){Ja(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Za(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ja(t,e,n){return(e=es(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ts(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,es(r.key),r)}}function es(t){var e=function(t,e){if("object"!==$a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==$a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===$a(e)?e:String(e)}var ns="NvlController",rs={filename:"visualisation.png",backgroundColor:"rgba(0,0,0,0)"},is="onError",os="onLayoutDone",as={},ss=function(t,e){as[e]=t},us=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return null!==(t=as[e])&&void 0!==t?t:Object.values(as).pop()};window.__Nvl_dumpNodes=function(t){var e;return null===(e=us(t))||void 0===e?void 0:e.dumpNodes()},window.__Nvl_dumpRelationships=function(t){var e;return null===(e=us(t))||void 0===e?void 0:e.dumpRelationships()},window.__Nvl_registerDoneCallback=function(t,e){var n;return null===(n=us(e))||void 0===n?void 0:n.on(os,t)},window.__Nvl_getNodesOnScreen=function(t){var e;return null===(e=us(t))||void 0===e?void 0:e.getNodesOnScreen()};var ls=function(){function t(e){var n,r,i=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qa(this,t),this.destroyed=!1;var a=o.frame,s=o.minimapContainer,u=void 0===s?document.createElement("span"):s,l=o.layoutOptions,c=o.layout,h=o.instanceId,f=void 0===h?"default":h,d=e.nodes,p=e.rels,v=e.webGLVisible,g=e.disableWebGL;this._state=e,this._callbacks=new Ba,this.instanceId=f;var y=a;y.setAttribute("instanceId",f),y.setAttribute("data-testid","nvl-parent"),null!==(n=y.style.height)&&void 0!==n&&n.length||Object.assign(y.style,{height:"100%"}),null!==(r=y.style.outline)&&void 0!==r&&r.length||Object.assign(y.style,{outline:"none"});var m=Ma(y,this._onWebGLContextLost.bind(this)),_=Ma(u,this._onWebGLContextLost.bind(this));if(m.setAttribute("data-testid","nvl-gl-canvas"),g)this._glController=new Ea;else{var b=Ua(m),x=Ua(_);this._glController=new Aa({mainSceneRenderer:new Pa(b,d,p,this._state),minimapRenderer:new Pa(x,d,p,this._state),state:e}),this._webGLContext=b,this._webGLMinimapContext=x}var w=Ma(y,this._onWebGLContextLost.bind(this));w.setAttribute("data-testid","nvl-c2d-canvas");var T=w.getContext("2d"),S=document.createElement("div");Object.assign(S.style,Ka(Ka({},pr),{},{overflow:"hidden"})),y.appendChild(S),this._htmlOverlay=S,this._hasResized=!0,this._hierLayout=new Bi(Ka(Ka({},l),{},{state:this._state})),this._gridLayout=new Li({state:this._state}),this._freeLayout=new Si({state:this._state}),this._d3ForceLayout=new Mr({state:this._state}),this._forceLayout=g?this._d3ForceLayout:new wi(Ka(Ka({},l),{},{webGLContext:this._webGLContext,state:this._state})),this._state.setLayout(c),this._state.setLayoutOptions(l);var A=new wa(w,T,e,o);this._canvasRenderer=A,this._c2dContext=T,this._glCanvas=m,this._canvasRect=m.getBoundingClientRect(),this._glMinimapCanvas=_,this._c2dCanvas=w,this._glCanvas.style.opacity=v?1:0,this._c2dCanvas.style.opacity=v?0:1,this._isInRenderSwitchAnimation=!1,this._justSwitchedRenderer=!1,this._justSwitchedLayout=!1,this._hasResized=!1,this._layoutUpdating=!1,this._layoutComputing=!1,this.isRenderingDisabled=!1,d.addChannel(ns),p.addChannel(ns),this.setRenderSwitchAnimation=function(){i._isInRenderSwitchAnimation=!1},this.stateDisposers=[],this.stateDisposers.push(e.autorun((function(){i.callIfRegistered("zoom",e.zoom)}))),this.stateDisposers.push(e.autorun((function(){i.callIfRegistered("pan",{panX:e.panX,panY:e.panY})}))),this.stateDisposers.push(e.autorun((function(){i.setLayout(e.layout)}))),this.stateDisposers.push(e.autorun((function(){i.setLayoutOptions(e.layoutOptions)}))),this.stateDisposers.push(e.autorun((function(){var t=e.webGLVisible?1:0;t!==i._glCanvas.style.opacity&&(i._justSwitchedRenderer=!0,i._glCanvas.style.opacity=t,i._c2dCanvas.style.opacity=e.webGLVisible?0:1)}))),this._startMainloop(),this._zoomTransitionHandler=new Xa({state:e,getNodePositions:function(t){return i._currentLayout.getNodePositions(t)},canvas:m,minimapCanvas:_,defaultZoomLevel:so}),this.layoutTimeLimit=o.layoutTimeLimit||16,this.forceWebGLThreshold=o.forceWebGLThreshold||100,this.pixelRatio=vr(),this.removeResizeListener=bn()(y,(function(){Ia(m),Ia(w),i._canvasRect=m.getBoundingClientRect(),i._hasResized=!0})),this.removeMinimapResizeListener=bn()(u,(function(){Ia(_)})),ss(this,f),this.pendingZoomOperation=null}var e,n,r,i;return e=t,n=[{key:"_onWebGLContextLost",value:function(t){this.callIfRegistered("onWebGLContextLost",t)}},{key:"_updateMinimapZoom",value:function(){var t=this._state,e=t.nodes,n=t.maxNodeRadius,r=t.maxMinimapZoom,i=t.minMinimapZoom,o=Wi(Object.values(e.idToPosition),n),a=o.centerX,s=o.centerY,u=o.nodesWidth,l=o.nodesHeight,c=Xi(u,l,this._glMinimapCanvas.width,this._glMinimapCanvas.height),h=c.zoomX,f=c.zoomY,d=$i(h,f,i,r);this._state.updateMinimapZoomToFit(d,a,s)}},{key:"_startMainloop",value:function(){var t=this,e=this._state,n=e.nodes,r=e.rels;this._currentLayout.update();var i=this._currentLayout.getNodePositions(n.items);n.updatePositions(i),this.isRenderingDisabled||(this._glController.renderMainScene(i),this._glController.renderMinimap(i),this._canvasRenderer.processUpdates(),this._canvasRenderer.render(i)),this._layoutRunner=setInterval((function(){try{!function(){var e=t._currentLayout.getShouldUpdate(),n=e||t._justSwitchedLayout,r=n&&!t._layoutUpdating&&!t._justSwitchedLayout;if(n)for(var i=window.performance.now(),o=r?0:50,a=0;a<o;a++){t._currentLayout.update(t._justSwitchedLayout),t._justSwitchedLayout=!1;var s=window.performance.now();if(!e||s-i>t.layoutTimeLimit)break}}()}catch(e){if(!t._callbacks.isCallbackRegistered(is))throw e;t.callIfRegistered(is,e)}}),13),this.animationRequestId=window.requestAnimationFrame((function e(){try{!function(e){if(t.destroyed)jr.info("STEP IN A DESTROYED STRIP");else{var i=vr();if(i!==t.pixelRatio)return t.pixelRatio=i,void t.callIfRegistered("restart");var o=t._currentLayout.getShouldUpdate(),a=o||t._justSwitchedLayout,s=t._currentLayout.getComputing(),u=t._zoomTransitionHandler.needsToRun(),l=a&&!t._layoutUpdating&&!t._justSwitchedLayout,c=t._layoutComputing&&!s,h=t._state.webGLVisible&&t._glController.needsToRun(),f=!t._state.webGLVisible&&t._canvasRenderer.needsToRun(),d=t._isInRenderSwitchAnimation||t._justSwitchedRenderer,p=t._hasResized,v=null!==t.pendingZoomOperation,g=t._glController.minimapMouseDown;if(n.clearChannel(ns),r.clearChannel(ns),u||a||c||d||h||f||g||p||v){!t.pendingZoomOperation||l||t._currentLayout.getComputing()||(t.pendingZoomOperation(),t.pendingZoomOperation=null),t._zoomTransitionHandler.update(o||s||c),p&&t._glController.onResize();var y=t._currentLayout.getNodePositions(n.items);if(n.updatePositions(y),t.callIfRegistered("onLayoutStep",t.dumpNodes()),t._updateMinimapZoom(),t._glController.renderMinimap(y),!t.isRenderingDisabled){if((t._state.webGLVisible||d)&&t._glController.renderMainScene(y),!t._state.webGLVisible||d){t._canvasRenderer.processUpdates(d),t._canvasRenderer.render(y);for(var m=0;m<r.items.length;m++){var _,b=r.items[m].id,x=null!==(_=t._canvasRenderer.arrowBundler.getBundle(r.items[m]))&&void 0!==_?_:{},w=r.idToHtmlOverlay[b],T=x.labelInfo[b];if(w&&T){var S=T.rotation,A=T.position,E=T.width,C=T.height,R=t.mapCanvasSpaceToRelativePosition(A.x,A.y),P=R.x,D=R.y,O=E>5&&!t._state.webGLVisible;Object.assign(w.style,{top:"".concat(D,"px"),left:"".concat(P,"px"),width:"".concat(E,"px"),height:"".concat(C,"px"),display:O?"block":"none",transform:"translate(-50%, -50%) scale(".concat(Number(t._state.zoom),") rotate(").concat(S,"rad")})}}}for(var k=0;k<n.items.length;k++){var I=n.items[k],L=I.id,M=I.size,N=n.idToHtmlOverlay[L];if(N){var j=t._state.nodes.idToPosition[L],U=t.mapCanvasSpaceToRelativePosition(j.x,j.y),F=U.x,z=U.y,B="".concat(2*(null!=M?M:fr),"px");Object.assign(N.style,{top:"".concat(z,"px"),left:"".concat(F,"px"),width:B,height:B,transform:"translate(-50%, -50%) scale(".concat(Number(t._state.zoom),")")})}}}}var V=!a&&t._layoutUpdating,G=s!==t._layoutComputing;t._layoutComputing=s,t._layoutUpdating=a,V&&t.callIfRegistered(os),G&&t.callIfRegistered("onLayoutComputing",s),t._justSwitchedRenderer=!1,t._hasResized=!1,e&&e()}}((function(){t.animationRequestId=window.requestAnimationFrame(e)}))}catch(e){if(!t._callbacks.isCallbackRegistered(is))throw e;t.callIfRegistered(is,e)}}))}},{key:"updateHtmlOverlay",value:function(){this._state.nodes.updateHtmlOverlay(this._htmlOverlay),this._state.rels.updateHtmlOverlay(this._htmlOverlay)}},{key:"dumpNodes",value:function(){var t,e=this._state.nodes.items,n=this._state.nodes.idToPosition,r=[],i=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return qa(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qa(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=n[o.id],s=this.mapCanvasSpaceToRelativePosition(a.x,a.y);r.push(Ka(Ka({},o),{},{x:s.x,y:s.y}))}}catch(t){i.e(t)}finally{i.f()}return r}},{key:"dumpRelationships",value:function(){return dn(this._state.rels.items)}},{key:"mapCanvasSpaceToRelativePosition",value:function(t,e){var n=this._canvasRect,r=window.devicePixelRatio||1,i=(t-this._state.panX)*this._state.zoom/r,o=(e-this._state.panY)*this._state.zoom/r;return{x:i+.5*n.width,y:o+.5*n.height}}},{key:"mapRelativePositionToCanvasSpace",value:function(t,e){var n=this._glCanvas.getBoundingClientRect(),r=window.devicePixelRatio||1,i=r*(t-.5*n.width),o=r*(e-.5*n.height);return{x:this._state.panX+i/this._state.zoom,y:this._state.panY+o/this._state.zoom}}},{key:"getNodePositions",value:function(){return Object.values(dn(this._state.nodes.idToPosition))}},{key:"setNodePositions",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._state.nodes.updatePositions(t),this._currentLayout.updateNodes(t),!e&&this._currentLayout.terminateUpdate(),this._hasResized=!0;var n=this.getNodesOnScreen(),r=n.nodes;0===r.length&&this._state.setPan(0,0),this._state.clearFit()}},{key:"isLayoutMoving",value:function(){return this._layoutUpdating}},{key:"getNodesOnScreen",value:function(){var t=this._glCanvas.getBoundingClientRect(),e=this.mapRelativePositionToCanvasSpace(0,0),n=e.x,r=e.y,i=this.mapRelativePositionToCanvasSpace(t.width,t.height);return((t,e,n,r,i,o=["node"])=>{const{nodes:a,rels:s}=i,u=Math.min(t,n),l=Math.max(t,n),c=Math.min(e,r),h=Math.max(e,r),f=[],d=[];if(o.includes("node"))for(const t of Object.values(a.idToPosition)){const{x:e,y:n}=t;void 0!==e&&void 0!==n&&e>u&&e<l&&n>c&&n<h&&f.push(t)}if(o.includes("relationship"))for(const t of s.items){const{from:e,to:n}=t,r=a.idToPosition[e],i=a.idToPosition[n];if(void 0===r.x||void 0===r.y)continue;if(void 0===i.x||void 0===i.y)continue;const o=r.x>u&&r.x<l&&r.y>c&&r.y<h,s=i.x>u&&i.x<l&&i.y>c&&i.y<h;o&&s&&d.push(t)}return{nodes:f,rels:d}})(n,r,i.x,i.y,this._state,["node"])}},{key:"registerDoneCallback",value:function(t){this._layoutDoneCallback=t}},{key:"registerComputingCallback",value:function(t){this._layoutComputingCallback=t}},{key:"getPosition",value:function(t){return this._layout.getNodePositions([{id:t}])[0]}},{key:"addCanvasOptions",value:function(t){this._canvasRenderer.addOptions(t)}},{key:"setNodeInformationLevel",value:function(t){this._canvasRenderer.setNodeInformationLevel(t)}},{key:"setEdgeInformationLevel",value:function(t){this._canvasRenderer.setEdgeInformationLevel(t)}},{key:"getScale",value:function(){return this._state.zoom}},{key:"getPan",value:function(){return{x:this._state.panX,y:this._state.panY}}},{key:"setZoomLevel",value:function(t){var e=this;this.pendingZoomOperation=function(){return e._state.setZoom(t,e._glCanvas)}}},{key:"setPanCoordinates",value:function(t,e){this._state.setPan(t,e)}},{key:"setZoomAndPan",value:function(t,e,n){var r=this;this.pendingZoomOperation=function(){return r._state.setZoomPan(t,e,n,r._glCanvas)}}},{key:"fit",value:function(t,e){var n=this;this.pendingZoomOperation=function(){return n._state.fitNodes(t,e)}}},{key:"resetZoom",value:function(){var t=this;this.pendingZoomOperation=function(){return t._state.setZoomReset()}}},{key:"setUseWebGLRenderer",value:function(t){this._state.setUseWebGLRenderer(t)}},{key:"on",value:function(t,e){this._callbacks.register(t,e)}},{key:"destroy",value:function(){var t;this.destroyed||(this.animationRequestId&&window.cancelAnimationFrame(this.animationRequestId),this._layoutRunner&&window.clearInterval(this._layoutRunner),this._glController.destroy(),this._glCanvas.removeEventListener("transitionend",this.setRenderSwitchAnimation),this._webGLContext&&Fa(this._webGLContext),this._webGLMinimapContext&&Fa(this._webGLMinimapContext),Na(this._glCanvas),Na(this._glMinimapCanvas),this._canvasRenderer.destroy(),Na(this._c2dCanvas),this.removeResizeListener(),this.removeMinimapResizeListener(),this._forceLayout.destroy(),this._hierLayout.destroy(),this._gridLayout.destroy(),this._freeLayout.destroy(),this._htmlOverlay.remove(),this._zoomTransitionHandler.destroy(),this.stateDisposers.forEach((function(t){t()})),t=this.instanceId,delete as[t],this.destroyed=!0)}},{key:"callIfRegistered",value:function(){this._callbacks.callIfRegistered.apply(this._callbacks,arguments)}},{key:"getCanvasRelsAt",value:function(t){return this._canvasRenderer.getRelsAt(t)}},{key:"getCanvasNodesAt",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._canvasRenderer.getNodesAt(t,e)}},{key:"_getLayout",value:function(t){var e=this._forceLayout;return t===lo?e=this._hierLayout:t===uo?e=this._forceLayout:t===co?e=this._gridLayout:t===ho?e=this._freeLayout:t===fo&&(e=this._d3ForceLayout),e}},{key:"setLayout",value:function(t){jr.info("Switching to layout: ".concat(t));var e=this._currentLayoutType,n=this._getLayout(t);"free"===t&&n.setNodePositions(this._state.nodes.idToPosition),this._currentLayout=n,this._currentLayoutType=t,e&&e!==this._currentLayoutType&&(this._justSwitchedLayout=!0)}},{key:"setLayoutOptions",value:function(t){this._getLayout(this._state.layout).setOptions(t)}},{key:"createDownloadLink",value:function(t,e){var n=document.createElement("a");n.style.display="none",n.setAttribute("download",t);var r=e.toDataURL("image/png").replace(/^data:image\/png/,"data:application/octet-stream");return n.setAttribute("href",r),n}},{key:"saveToFile",value:function(t){var e=Ka(Ka({},rs),t),n=e.filename,r=e.backgroundColor,i=this._state.nodes.items;this._currentLayout.update(this._justSwitchedLayout),this._justSwitchedLayout=!1;var o=this._currentLayout.getNodePositions(i);this._state.nodes.updatePositions(o);var a=La(this._c2dCanvas.width,this._c2dCanvas.height),s=ja(a);this._canvasRenderer.processUpdates(),this._canvasRenderer.render(o,{canvas:a,context:s,backgroundColor:r,ignoreAnimations:!0}),this.createDownloadLink(n,a).click(),Na(a),a=null,s=null}},{key:"prepareLargeFileForDownload",value:function(t){var e=this,n=this._state.nodes.items,r=t.filename,i=t.backgroundColor,o=this._currentLayout.getNodePositions(n),a=Wi(o,100),s=a.nodesWidth,u=a.nodesHeight,l=a.centerX,c=a.centerY,h=Math.max(Math.min(s+100,15e3),5e3),f=Math.max(Math.min(u+100,15e3),5e3);return this.isRenderingDisabled=!0,new Promise((function(t,n){try{e.setPanCoordinates(l,c);var a=Math.max((h/s).toFixed(2)-.02,e._zoomTransitionHandler._minZoom),d=Math.max((f/u).toFixed(2)-.02,e._zoomTransitionHandler._minZoom);e.setZoomLevel(Math.min(a,d))}catch(t){return console.error("An error occured while downloading the file"),void n(t)}setTimeout((function(){try{e._currentLayout.update(e._justSwitchedLayout),e._justSwitchedLayout=!1,e._state.nodes.updatePositions(o);var a=La(h,f),s=ja(a);e._canvasRenderer.processUpdates(),e._canvasRenderer.render(o,{canvas:a,context:s,backgroundColor:i,ignoreAnimations:!0,showCaptions:!0}),e.createDownloadLink(r,a).click(),Na(a),a=null,s=null,t()}catch(t){n(t)}}),500)}))}},{key:"saveFullGraphToLargeFile",value:(r=Ha().mark((function t(e){var n,r,i,o;return Ha().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Ka(Ka({},rs),e),r=this._state.zoom,i=this._state.panX,o=this._state.panY,t.prev=4,t.next=7,this.prepareLargeFileForDownload(n);case 7:t.next=17;break;case 9:if(t.prev=9,t.t0=t.catch(4),console.error("An error occured while downloading the image"),!this._callbacks.isCallbackRegistered(is)){t.next=16;break}this.callIfRegistered(is,t.t0),t.next=17;break;case 16:throw t.t0;case 17:return t.prev=17,this.isRenderingDisabled=!1,this.setZoomLevel(r),this.setPanCoordinates(i,o),t.finish(17);case 22:case"end":return t.stop()}}),t,this,[[4,9,17,22]])})),i=function(){var t=this,e=arguments;return new Promise((function(n,i){var o=r.apply(t,e);function a(t){Ya(o,n,i,a,s,"next",t)}function s(t){Ya(o,n,i,a,s,"throw",t)}a(void 0)}))},function(t){return i.apply(this,arguments)})}],n&&ts(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function cs(t){return cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cs(t)}function hs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==cs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==cs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===cs(i)?i:String(i)),r)}var i}function ds(t,e,n){return e&&fs(t.prototype,e),n&&fs(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var ps=function(){function t(e,n){if(hs(this,t),!e)throw new Error("Tried to create a node with no data");this.data=e,this.parent=n,this.children=[]}return ds(t,[{key:"addChild",value:function(t){this.children.push(t)}},{key:"isRoot",value:function(){return null===this.parent}},{key:"print",value:function(){var t=this.data.name;this.isRoot()||(t=t+"\t\t"+function(t){for(var e=(Math.round(1e3*t)/1e3).toFixed(3);e.length<6;)e=" "+e;return e}(this.data._timeSpent())+" ms",this.parent.isRoot()||(t=t+"\t"+this._percentageOfParentSpent()+"%"));var e=this.noOfChildren()>0;for(var n in e?(t=t+"\t Children: "+this.noOfChildren(),console.groupCollapsed(t)):console.log(t),this.children)this.children[n].print();e&&console.groupEnd()}},{key:"noOfChildren",value:function(){return this.children.length}},{key:"_percentageOfParentSpent",value:function(){return Math.round(this.data._timeSpent()/this.parent.data._timeSpent()*100)}}]),t}(),vs=function(){function t(e){hs(this,t),this.name=e,this.startTime=performance.now(),this.endTime=null}return ds(t,[{key:"close",value:function(){this.endTime=performance.now()}},{key:"_timeSpent",value:function(){if(null===this.startTime||null===this.endTime)throw new Error("You have an error in your performance measurements that makes the whole tree unreliable. You probably forgot to call performanceTestEnd on "+this.name);return this.endTime-this.startTime}}]),t}(),gs=function(){function t(){hs(this,t),this.root=new ps(new vs("Performance Tree"),null),this.current=this.root}return ds(t,[{key:"clear",value:function(){this.root.children=[],this.current=this.root}},{key:"add",value:function(t){if(this.current){var e=new ps(t,this.current);this.current.addChild(e),this.current=e}else{if(this.root)throw new Error("Performance tree is screwed up");this.root=new ps(t,null),this.current=this.root}}},{key:"close",value:function(){if(this.current.isRoot())throw new Error("Tried to close performance tree root. You probably have one too many Performance.endTest() in your code.");this.current.data.close(),this.current=this.current.parent}},{key:"getCurrentData",value:function(){return this.current.data}},{key:"print",value:function(){this.root.noOfChildren()>0&&this.root.print()}}]),t}(),ys=function(){function t(){hs(this,t),window.performance?(this.disabled=!1,this.tree=new gs):(this.disabled=!0,this.tree=null)}return ds(t,[{key:"startTest",value:function(t){if(!this.disabled){var e;t||(1,t="at"===(e=(new Error).stack.split("\n")[3].trim()).split(" ")[0]?e.split(" ")[1]:e.split("@")[0]);var n=new vs(t);this.tree.add(n)}}},{key:"endTest",value:function(){this.disabled||this.tree.close()}},{key:"reset",value:function(){this.disabled||this.tree.clear()}},{key:"print",value:function(){this.disabled||this.tree.print()}}]),t}();const ms=t=>Boolean(t)&&"string"==typeof t.id&&t.id.length>0;class _s{externalCallbackHandler;performance;visState;nvlController;options;constructor(t,n=[],r=[],i={},o={}){this.setupLogging(i),this.externalCallbackHandler=new e(o),this.performance=new ys,this.options=i,this.options.frame=t,this.checkWebGLCompatibility(),this.initialise(n,r,i)}restart(t={},e=!1){const n=this.getNodePositions(),{zoom:r,layout:i,layoutOptions:o,nodes:a,rels:s}=this.visState;this.nvlController.destroy(),Object.assign(this.options,t),this.initialise(a.items,s.items,this.options),this.setZoom(r),this.setLayout(i),this.setLayoutOptions(o),this.addAndUpdateElementsInGraph(a.items,s.items),e&&this.setNodePositions(n)}addAndUpdateElementsInGraph(t=[],e=[]){this.validateNodes(t),this.validateRelationships(e,t);const n={added:!1,updated:!1};this.visState.nodes.update(t,{...n}),this.visState.rels.update(e,{...n}),this.visState.nodes.add(t,{...n}),this.visState.rels.add(e,{...n}),this.visState.setGraphUpdated(),this.nvlController.updateHtmlOverlay()}getSelectedNodes(){return this.visState.nodes.items.filter((t=>t.selected)).map((t=>({...t,...this.visState.nodes.idToPosition[t.id]})))}getSelectedRelationships(){return this.visState.rels.items.filter((t=>t.selected))}updateElementsInGraph(t,e){const n={added:!1,updated:!1};this.validateNodes(t),this.validateRelationships(e,t),this.visState.nodes.update(t,{...n}),this.visState.rels.update(e,{...n}),this.nvlController.updateHtmlOverlay()}addElementsToGraph(t,e){this.validateNodes(t),this.validateRelationships(e,t);const n={added:!1,updated:!1};this.visState.nodes.add(t,{...n}),this.visState.rels.add(e,{...n}),this.nvlController.updateHtmlOverlay()}removeNodesWithIds(e){if(!Array.isArray(e)||(0,t.isEmpty)(e))return;const n={};for(const t of e)n[t]=!0;const r=[];for(const t of this.visState.rels.items)(n[t.from]||n[t.to])&&r.push(t.id);r.length>0&&this.edgeRemoval(r),this.nodeRemoval(e),this.visState.setGraphUpdated(),this.nvlController.updateHtmlOverlay()}removeRelationshipsWithIds(e){Array.isArray(e)&&!(0,t.isEmpty)(e)&&(this.edgeRemoval(e),this.visState.setGraphUpdated(),this.nvlController.updateHtmlOverlay())}get nodes(){return this.nvlController.dumpNodes()}get relationships(){return this.nvlController.dumpRelationships()}getNodes(){return this.nvlController.dumpNodes()}getRelationships(){return this.nvlController.dumpRelationships()}getNodeById(t){return this.visState.nodes.idToItem[t]}getRelationshipById(t){return this.visState.rels.idToItem[t]}getPositionById(t){return this.visState.nodes.idToPosition[t]}currentOptions(){return this.options}getCurrentOptions(){return this.options}destroy(){this.nvlController.destroy()}deselectAll(){this.updateElementsInGraph(this.visState.nodes.items.map((t=>({...t,selected:!1}))),this.visState.rels.items.map((t=>({...t,selected:!1}))))}fit(t,e){this.nvlController.fit(t,e)}resetZoom(){this.nvlController.resetZoom()}setUseWebGLRenderer(t){this.nvlController.setUseWebGLRenderer(t)}setDisableWebGL(t=!1){this.options.disableWebGL!==t&&(this.options.disableWebGL=t,this.restart())}pinNode(t){this.visState.nodes.update([{id:t,pinned:!0}],{})}unPinNode(t){this.visState.nodes.update(t.map((t=>({id:t,pinned:!1}))),{})}setLayout(t){this.visState.setLayout(t)}setLayoutOptions(t){this.visState.setLayoutOptions(t)}getNodesOnScreen(){return this.nvlController.getNodesOnScreen()}getNodePositions(){return this.nvlController.getNodePositions()}setNodePositions(t,e=!1){this.nvlController.setNodePositions(t,e)}isLayoutMoving(){return this.nvlController.isLayoutMoving()}saveToFile(t){this.nvlController.saveToFile(t)}saveFullGraphToLargeFile(t){this.nvlController.saveFullGraphToLargeFile(t)}setZoom(t){this.nvlController.setZoomLevel(t)}setPan(t,e){this.nvlController.setPanCoordinates(t,e)}setZoomAndPan(t,e,n){this.nvlController.setZoomAndPan(t,e,n)}getScale(){return this.nvlController.getScale()}getPan(){return this.nvlController.getPan()}getHits(t,e=["node","relationship"],n){const{options:r,visState:i,nvlController:o}=this,{zoom:a,panX:s,panY:u,webGLVisible:l}=i,{x:c,y:h}=Ta(t,r.frame,a,s,u),f=l?((t,e,n,r=["node","relationship"],i={})=>{const o=[],a=[],{nodes:s,rels:u}=n;return r.includes("node")&&o.push(...((t,e,n=[],r={},i=0)=>{const o=[];for(const a of n){const n=r[a.id];if(void 0===n?.x||void 0===n.y)continue;const s=(a.size||fr)*vr(),u={x:n.x-t,y:n.y-e},l=Math.pow(s,2),c=Math.pow(s+i,2),h=Math.pow(u.x,2)+Math.pow(u.y,2),f=Math.sqrt(h);if(h<c){const r=o.findIndex((t=>t.distance>f));o.splice(-1!==r?r:o.length,0,{data:a,targetCoordinates:{x:n.x,y:n.y},pointerCoordinates:{x:t,y:e},distanceVector:u,distance:f,insideNode:h<l})}}return o})(t,e,s.items,s.idToPosition,i.hitNodeMarginWidth)),r.includes("relationship")&&a.push(...((t,e,n=[],r={})=>{const i=[],o={};for(const a of n){const{from:n,to:s}=a;if(void 0===o[`${n}.${s}`]){const u=r[n],l=r[s];if(void 0===u?.x||void 0===u.y)continue;if(void 0===l?.x||void 0===l.y)continue;const c=ko({x:u.x,y:u.y},{x:l.x,y:l.y},{x:t,y:e});if(c<=za){const n=i.findIndex((t=>t.distance>c));i.splice(-1!==n?n:i.length,0,{data:a,fromTargetCoordinates:{x:u.x,y:u.y},toTargetCoordinates:{x:l.x,y:l.y},pointerCoordinates:{x:t,y:e},distance:c})}o[`${n}.${s}`]=1,o[`${s}.${n}`]=1}}return i})(t,e,u.items,s.idToPosition)),{nodes:o,relationships:a}})(c,h,i,e,n):((t,e,n,r=["node","relationship"],i={})=>{const o=[],a=[];return r.includes("node")&&o.push(...n.getCanvasNodesAt({x:t,y:e},i.hitNodeMarginWidth)),r.includes("relationship")&&a.push(...n.getCanvasRelsAt({x:t,y:e})),{nodes:o,relationships:a}})(c,h,o,e,n);return{...t,nvlTargets:f}}getContainer(){return this.options.frame}initialise(t=[],e=[],n={}){this.visState=po(n),this.nvlController=new ls(this.visState,n),this.addAndUpdateElementsInGraph(t,e),this.nvlController.on("restart",this.restart.bind(this));for(const[t,e]of Object.entries(this.externalCallbackHandler.callbacks))void 0!==e&&this.nvlController.on(t,this.externalCallbackHandler[t].bind(this.externalCallbackHandler))}setupLogging(t){const e=t.logging||{};var n;e.level&&(n=e.level)&&jr.setLevel(n),function(t,e){var n=t.methodFactory;t.methodFactory=function(t,r,i){var o=n(t,r,i);return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e&&"function"==typeof e.logger?e.logger.apply(e,[t].concat(r)):o.apply(void 0,r)}},t.setLevel(t.getLevel())}(jr,e)}nodeRemoval(t){const e=Array.isArray(t)?t:[t],{nodes:n,fitNodeIds:r,zoomOptions:i}=this.visState;n.remove(e,{removed:!1}),r.length&&e.find((t=>r.includes(t)))&&this.visState.fitNodes(r.filter((t=>!e.includes(t))),i)}edgeRemoval(t){const e=Array.isArray(t)?t:[t];this.visState.rels.remove(e,{removed:!1})}update(t,e){this.visState[e].update(t,{added:!1,updated:!1})}validateNodes(t){const e=t.find((t=>!(t=>Boolean(t)&&"string"==typeof t.id&&t.id.length>0)(t)));if(e){let t="";throw/^\d+$/.test(e.id)||(t=" Node ids need to be numeric strings. Strings that contain anything other than numbers are not yet supported."),new TypeError(`Invalid node provided: ${JSON.stringify(e)}.${t}`)}}validateRelationships(t,e=[]){let n="",r=null;const{nodes:i,rels:o}=this.visState,a={};for(let t=0;t<e.length;t++){const n=e[t];a[n.id]=n}const s={...i.idToItem,...a},u=o.idToItem;for(let e=0;e<t.length;e++){const i=t[e];if(!ms(i)){r=i,/^\d+$/.test(i.id)&&(n=" Node ids need to be numeric strings. Strings that contain anything other than numbers are not yet supported.");break}if(void 0===u[i.id]){const t=s[i.from],e=s[i.to];if(void 0===t){n=` Node with id "${i.from}" does not exist.`,r=i;break}if(void 0===e){n=` Node with id "${i.to}" does not exist.`,r=i;break}}}if(null!==r)throw new TypeError(`Invalid relationship provided: ${JSON.stringify(r)}.${n}`)}checkWebGLCompatibility(){const t=(()=>{try{const t=document.createElement("canvas");return Boolean(void 0!==window.WebGLRenderingContext&&(void 0!==t.getContext("webgl")||void 0!==t.getContext("experimental-webgl")))}catch(t){return!1}})();if(void 0===this.options.disableWebGL)this.options.disableWebGL=!t,t||(this.options.useWebGL=!1,console.warn("GPU acceleration is not available on your browser. Falling back to CPU layout and rendering. You can disable this warning by setting the disableWebGL option to true."));else if(!this.options.disableWebGL&&!t)throw new Jr("Could not initialize WebGL")}}const bs={textColorForBackground:ma},xs=_s})(),i})()));